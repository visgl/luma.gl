import {
  DeviceTabs,
  Info,
  Feature as F,
  Limit as L,
  WebGLLimit as WL,
  WebGLExtensions
} from '@luma.gl/react-website';

# Device Properties

> Live Page: the tables on this page are read
> from your current browser using luma.gl Device APIs.
> Compare browsers (both desktop and mobile)
> by opening this page on different devices.

The luma.gl `Device` provides a range of fields and functions to help an application
determine the capabilities of the underlying platform and API.

## Fields

### Device.info

A `DeviceInfo` object with fields that describe the devices.

<DeviceTabs />

| Field      | This Browser          | Description                           |
| ---------- | --------------------- | ------------------------------------- |
| `type`     | <Info f="type" />     | `webgpu`, `webgl2` or `webgl`         |
| `gpu`      | <Info f="gpu" />      | `intel`, `nvidia`, `amd` or `unknown` |
| `renderer` | <Info f="renderer" /> | GPU Driver                            |
| `vendor`   | <Info f="vendor" />   | GPU vendor                            |
| `version`  | <Info f="version" />  | Driver version                        |

### Device.features

luma.gl provides a unified feature detection system across WebGPU, WebGL and GLSL.
Each device has a `device.features` field that holds a set of strings (`Set<DeviceFeature>`).

A substantial set of features are devoted to texture capabilites, however these can also
be queried on a per-texture basis

```typescript
if (device.features.has('instanced-rendering-webgl1')) {
   // Will work both on WebGL 1 (via extension) and WebGL 2 via the standard API
   program.draw({instanceCount: ..., ....});
}
```

<DeviceTabs />

| `luma.gl Feature`                      | This<br /> Browser                             | Description                    |
| -------------------------------------- | ---------------------------------------------- | ------------------------------ |
| **Features**                             |
| `depth-clip-control`                   | <F f="depth-clip-control"/>                    | Depth clamps instead of clips. |
| `indirect-first-instance`              | <F f="indirect-first-instance"/>               | Specify via GPU buffer         |
| `timestamp-query`                      | <F f="timestamp-query"/>                       |                                |
| `timer-query-webgl`                    | <F f="timer-query-webgl"/>                     | GPU timer support              |
| `instanced-rendering-webgl1`           | <F f="instanced-rendering-webgl1"/>            | Instanced rendering available  |
| `multiple-render-targets-webgl1`       | <F f="multiple-render-targets-webgl1"/>        | Multiple render targets        |
| `index-uint32-webgl1`                  | <F f="index-uint32-webgl1"/>                   | 32 bit indexing supported      |
| `blend-minmax-webgl1`                  | <F f="blend-minmax-webgl1"/>                   | `min` and `max` blending       |
| **Textures**                           |
| `depth24unorm-stencil8`                | <F f="depth24unorm-stencil8"/>                 | `UNSIGNED_INT_24_8_WEBGL`      |
| `depth32float-stencil8`                | <F f="depth32float-stencil8"/>                 | WebGPU only                    |
| `texture-filter-anisotropic-webgl`     | <F f="texture-filter-anisotropic-webgl"/>      | anisotropic filtering          |
| `texture-filter-linear-float32-webgl`  | <F f="texture-filter-linear-float32-webgl"/>   | float32 `linear` filtering     |
| `texture-filter-linear-float16-webgl`  | <F f="texture-filter-linear-float16-webgl`" /> | float16 `linear` filtering     |
| `texture-renderable-float32-webgl`     | <F f="texture-renderable-float32-webgl"/>      | float32 textures renderable    |
| `texture-renderable-float16-webgl`     | <F f="texture-renderable-float16-webgl"/>      | float16 textures renderable    |
| `texture-renderable-rgba32float-webgl` | <F f="texture-renderable-rgba32float-webgl"/>  | float32 textures renderable    |
| `texture-float32-webgl1`               | <F f="texture-float32-webgl1"/>                | float32 texture support        |
| `texture-float16-webgl1`               | <F f="texture-float16-webgl1"/>                | float16 texture support        |
| `float-blend-webgl1`                   | <F f="float-blend-webgl1"/>                    | float texture blending         |
| `texture-srgb-webgl1`                  | <F f="texture-srgb-webgl1"/>                   | SRGB format support            |
| `texture-depth-webgl1`                 | <F f="texture-depth-webgl1"/>                  | depth texture supports         |
| **Compressed Textures**                |
| `texture-compression-bc5-webgl`        | <F f="texture-compression-bc5-webgl"/>         | DXT (BC1-BC5). Desktops.       |
| `texture-compression-bc`               | <F f="texture-compression-bc"/>                | DXT (BC1-BC7). Desktops.       |
| `texture-compression-etc2`             | <F f="texture-compression-etc2"/>              | Performance caveats.           |
| `texture-compression-astc`             | <F f="texture-compression-astc"/>              | ASTC.                          |
| `texture-compression-etc1-webgl`       | <F f="texture-compression-etc1-webgl"/>        | Qualcomm Snapdragon. Android.  |
| `texture-compression-pvrtc-webgl`      | <F f="texture-compression-pvrtc-webgl"/>       | PowerVR GPUs, iOS devices.     |
| `texture-compression-atc-webgl`        | <F f="texture-compression-atc-webgl"/>         | Qualcomm Adreno GPUs. Android. |
| **GLSL**                               |
| `glsl-frag-data`                       | <F f="glsl-frag-data"/>                        |                                |
| `glsl-frag-depth`                      | <F f="glsl-frag-depth"/>                       |                                |
| `glsl-derivatives`                     | <F f="glsl-derivatives"/>                      |                                |
| `glsl-texture-lod`                     | <F f="glsl-texture-lod"/>                      |                                |

### Device.limits

The `limits` object contains a "WebGPU style" limits object.

```typescript
import {Device} from '@luma.gl/api';
console.log(device.info);
if (device.limits.maxTextureDimension2D > 2048) {
   ...
}
```

<DeviceTabs />

| Limit                                       | Value                                               | Comments                               |
| ------------------------------------------- | --------------------------------------------------- | -------------------------------------- |
| `maxTextureDimension1D`                     | <L f="maxTextureDimension1D" />                     | WebGL does not support 1D textures     |
| `maxTextureDimension2D`                     | <L f="maxTextureDimension2D" />                     | `GL.MAX_TEXTURE_SIZE`                  |
| `maxTextureDimension3D`                     | <L f="maxTextureDimension3D" />                     | `GL.MAX_3D_TEXTURE_SIZE`               |
| `maxTextureArrayLayers`                     | <L f="maxTextureArrayLayers" />                     | `GL.MAX_ARRAY_TEXTURE_LAYERS`          |
| `maxBindGroups`                             | <L f="maxBindGroups" />                             | WebGPU only                            |
| `maxDynamicUniformBuffersPerPipelineLayout` | <L f="maxDynamicUniformBuffersPerPipelineLayout" /> | WebGPU only                            |
| `maxDynamicStorageBuffersPerPipelineLayout` | <L f="maxDynamicStorageBuffersPerPipelineLayout" /> | WebGPU only                            |
| `maxSampledTexturesPerShaderStage`          | <L f="maxSampledTexturesPerShaderStage" />          | `GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS`    |
| `maxSamplersPerShaderStage`                 | <L f="maxSamplersPerShaderStage" />                 | `GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS`  |
| `maxStorageBuffersPerShaderStage`           | <L f="maxStorageBuffersPerShaderStage" />           | WebGPU only                            |
| `maxStorageTexturesPerShaderStage`          | <L f="maxStorageTexturesPerShaderStage" />          | WebGPU only                            |
| `maxUniformBuffersPerShaderStage`           | <L f="maxUniformBuffersPerShaderStage" />           | `GL.MAX_UNIFORM_BUFFER_BINDINGS`       |
| `maxUniformBufferBindingSize`               | <L f="maxUniformBufferBindingSize" />               | `GL.MAX_UNIFORM_BLOCK_SIZE`            |
| `maxStorageBufferBindingSize`               | <L f="maxStorageBufferBindingSize" />               | WebGPU only                            |
| `minUniformBufferOffsetAlignment`           | <L f="minUniformBufferOffsetAlignment" />           | `GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT`   |
| `minStorageBufferOffsetAlignment`           | <L f="minStorageBufferOffsetAlignment" />           | WebGPU only                            |
| `maxVertexBuffers`                          | <L f="maxVertexBuffers" />                          |                                        |
| `maxVertexAttributes`                       | <L f="maxVertexAttributes" />                       | `GL.MAX_VERTEX_ATTRIBS`                |
| `maxVertexBufferArrayStride`                | <L f="maxVertexBufferArrayStride" />                | Cant be reliably determined on WebGL   |
| `maxInterStageShaderComponents`             | <L f="maxInterStageShaderComponents" />             | `GL.MAX_VARYING_COMPONENTS`            |
| `maxComputeWorkgroupStorageSize`            | <L f="maxComputeWorkgroupStorageSize" />            | WebGL does not support compute shaders |
| `maxComputeInvocationsPerWorkgroup`         | <L f="maxComputeInvocationsPerWorkgroup" />         | WebGL does not support compute shaders |
| `maxComputeWorkgroupSizeX`                  | <L f="maxComputeWorkgroupSizeX" />                  | WebGL does not support compute shaders |
| `maxComputeWorkgroupSizeY`                  | <L f="maxComputeWorkgroupSizeY" />                  | WebGL does not support compute shaders |
| `maxComputeWorkgroupSizeZ`                  | <L f="maxComputeWorkgroupSizeZ" />                  | WebGL does not support compute shaders |
| `maxComputeWorkgroupsPerDimension`          | <L f="maxComputeWorkgroupsPerDimension" />          | WebGL does not support compute shaders |

## WebGL

If you know that you are running on WebGL, you don't need to go through
the luma.gl Device APIs. You can access "raw" WebGL extensions and limits directly.

### WebGL extensions

It is easy to get the list of actual WebGL extensions from `WebGLDevice`:

```typescript
const webglDevice = device instanceof WebGLDevice ? (device as WebGLDevice) : null;
const extensions = webglDevice ? webglDevice.gl.getSupportedExtensions() : [];
console.log(extensions);
```

On your current browser, this would yield:

<DeviceTabs />

<WebGLExtensions />

> Caveat: WebGL extensions can be onerous to work with directly. They are very granular,
> and WebGL1 extensions are not listed as supported on WebGL2 contexts even though the
> corresponding features are supported.

### Device.webglLimits

A luma.gl `WebGLDevice` extracts an object that contains all "raw" WebGL limits.

```typescript
import GL from '@luma.gl/constants';
import {WebGLDevice} from '@luma.gl/webgl';

const webglDevice = device instanceof WebGLDevice ? device as WebGLDevice: null;
console.log(webglDevice ? webglDevice.webglLimits[GL.MAX_VERTEX_ATTRIBS]);
```

<DeviceTabs />

| Limits                                             | This <br/> Browser                                       | Description                          |
| -------------------------------------------------- | -------------------------------------------------------- | ------------------------------------ |
| **WebGL 1**                                        |                                                          |                                      |
| `GL.ALIASED_LINE_WIDTH_RANGE`                      | <WL f="ALIASED_LINE_WIDTH_RANGE" />                      | Width !== 1 are no longer supported. |
| `GL.ALIASED_POINT_SIZE_RANGE`                      | <WL f="ALIASED_POINT_SIZE_RANGE" />                      | `topology`: `'point'`                |
| `GL.MAX_TEXTURE_SIZE`                              | <WL f="MAX_TEXTURE_SIZE" />                              | Max width/height of texture          |
| `GL.MAX_CUBE_MAP_TEXTURE_SIZE`                     | <WL f="MAX_CUBE_MAP_TEXTURE_SIZE" />                     | Max width/height of cube texture     |
| `GL.MAX_TEXTURE_IMAGE_UNITS`                       | <WL f="MAX_TEXTURE_IMAGE_UNITS" />                       |                                      |
| `GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS`              | <WL f="MAX_COMBINED_TEXTURE_IMAGE_UNITS" />              |                                      |
| `GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS`                | <WL f="MAX_VERTEX_TEXTURE_IMAGE_UNITS" />                |                                      |
| `GL.MAX_RENDERBUFFER_SIZE`                         | <WL f="MAX_RENDERBUFFER_SIZE" />                         |                                      |
| `GL.MAX_VARYING_VECTORS`                           | <WL f="MAX_VARYING_VECTORS" />                           |                                      |
| `GL.MAX_VERTEX_ATTRIBS`                            | <WL f="MAX_VERTEX_ATTRIBS" />                            |                                      |
| `GL.MAX_VERTEX_UNIFORM_VECTORS`                    | <WL f="MAX_VERTEX_UNIFORM_VECTORS" />                    |                                      |
| `GL.MAX_FRAGMENT_UNIFORM_VECTORS`                  | <WL f="MAX_FRAGMENT_UNIFORM_VECTORS" />                  |                                      |
| `GL.MAX_VIEWPORT_DIMS`                             | <WL f="MAX_VIEWPORT_DIMS" />                             |                                      |
| `GL.MAX_TEXTURE_MAX_ANISOTROPY_EXT`                | <WL f="MAX_TEXTURE_MAX_ANISOTROPY_EXT" />                |                                      |
| **WebGL 2**                                        |                                                          |                                      |
| `GL.MAX_3D_TEXTURE_SIZE`                           | <WL f="MAX_3D_TEXTURE_SIZE" />                           |                                      |
| `GL.MAX_ARRAY_TEXTURE_LAYERS`                      | <WL f="MAX_ARRAY_TEXTURE_LAYERS" />                      |                                      |
| `GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL`                 | <WL f="MAX_CLIENT_WAIT_TIMEOUT_WEBGL" />                 |                                      |
| `GL.MAX_COLOR_ATTACHMENTS`                         | <WL f="MAX_COLOR_ATTACHMENTS" />                         |                                      |
| `GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS`      | <WL f="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS" />      |                                      |
| `GL.MAX_COMBINED_UNIFORM_BLOCKS`                   | <WL f="MAX_COMBINED_UNIFORM_BLOCKS" />                   |                                      |
| `GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS`        | <WL f="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS" />        |                                      |
| `GL.MAX_DRAW_BUFFERS`                              | <WL f="MAX_DRAW_BUFFERS" />                              |                                      |
| `GL.MAX_ELEMENT_INDEX`                             | <WL f="MAX_ELEMENT_INDEX" />                             |                                      |
| `GL.MAX_ELEMENTS_INDICES`                          | <WL f="MAX_ELEMENTS_INDICES" />                          |                                      |
| `GL.MAX_ELEMENTS_VERTICES`                         | <WL f="MAX_ELEMENTS_VERTICES" />                         |                                      |
| `GL.MAX_FRAGMENT_INPUT_COMPONENTS`                 | <WL f="MAX_FRAGMENT_INPUT_COMPONENTS" />                 |                                      |
| `GL.MAX_FRAGMENT_UNIFORM_BLOCKS`                   | <WL f="MAX_FRAGMENT_UNIFORM_BLOCKS" />                   |                                      |
| `GL.MAX_FRAGMENT_UNIFORM_COMPONENTS`               | <WL f="MAX_FRAGMENT_UNIFORM_COMPONENTS" />               |                                      |
| `GL.MAX_PROGRAM_TEXEL_OFFSET`                      | <WL f="MAX_PROGRAM_TEXEL_OFFSET" />                      |                                      |
| `GL.MAX_SAMPLES`                                   | <WL f="MAX_SAMPLES" />                                   |                                      |
| `GL.MAX_SERVER_WAIT_TIMEOUT`                       | <WL f="MAX_SERVER_WAIT_TIMEOUT" />                       |                                      |
| `GL.MAX_TEXTURE_LOD_BIAS`                          | <WL f="MAX_TEXTURE_LOD_BIAS" />                          |                                      |
| `GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS` | <WL f="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS" /> |                                      |
| `GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS`       | <WL f="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS" />       |                                      |
| `GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS`    | <WL f="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS" />    |                                      |
| `GL.MAX_UNIFORM_BLOCK_SIZE`                        | <WL f="MAX_UNIFORM_BLOCK_SIZE" />                        |                                      |
| `GL.MAX_UNIFORM_BUFFER_BINDINGS`                   | <WL f="MAX_UNIFORM_BUFFER_BINDINGS" />                   |                                      |
| `GL.MAX_VARYING_COMPONENTS`                        | <WL f="MAX_VARYING_COMPONENTS" />                        |                                      |
| `GL.MAX_VERTEX_OUTPUT_COMPONENTS`                  | <WL f="MAX_VERTEX_OUTPUT_COMPONENTS" />                  |                                      |
| `GL.MAX_VERTEX_UNIFORM_BLOCKS`                     | <WL f="MAX_VERTEX_UNIFORM_BLOCKS" />                     |                                      |
| `GL.MAX_VERTEX_UNIFORM_COMPONENTS`                 | <WL f="MAX_VERTEX_UNIFORM_COMPONENTS" />                 |                                      |
| `GL.MIN_PROGRAM_TEXEL_OFFSET`                      | <WL f="MIN_PROGRAM_TEXEL_OFFSET" />                      |                                      |
| `GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT`               | <WL f="UNIFORM_BUFFER_OFFSET_ALIGNMENT" />               |                                      |

## Remarks

- WebGL 1 only supports one color buffer format (RBG32F is deprecated)
- WebGL 2 supports multiple color buffer formats
- Some extensions will not be enabled until they have been queries. luma always queries on startup to enable, app only needs to query again it wants to test platform.
- The capability detection system works regardless of whether the app is running in a browser or in headless mode under Node.js.
- Naturally, given that queries to driver and GPU are typically expensive in WebGL, the capabilities system will cache any queries.

['ext_texture_filter_anisotropic']: https://developer.mozilla.org/en-US/docs/Web/API/EXT_texture_filter_anisotropic
