<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-api-reference/shadertools/shader-modules/gpu-picking" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">gpuPicking | luma.gl</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luma.gl/docs/api-reference/shadertools/shader-modules/gpu-picking"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="gpuPicking | luma.gl"><meta data-rh="true" name="description" content="Provides support for GPU-based picking."><meta data-rh="true" property="og:description" content="Provides support for GPU-based picking."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://luma.gl/docs/api-reference/shadertools/shader-modules/gpu-picking"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/api-reference/shadertools/shader-modules/gpu-picking" hreflang="en"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/api-reference/shadertools/shader-modules/gpu-picking" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.73cc160a.css">
<script src="/assets/js/runtime~main.dd0be534.js" defer="defer"></script>
<script src="/assets/js/main.87c01eeb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luma.gl</b></a><a class="navbar__item navbar__link" href="/examples">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials">Tutorials</a><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-examples-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>gpuPicking</h1>
<p class="badges"><img src="https://img.shields.io/badge/From-v9.1-blue.svg?style=flat-square" alt="From v9.1"></p>
<p>Provides support for GPU-based picking.</p>
<p>Picking is a key capability for most interactive applications. Consult the API guide learn more about <a href="/docs/api-guide/engine/interactivity">picking</a>.</p>
<p>GPU picking is based on the conclusion that each pixel on the screen was generated while rendering some &quot;object&quot;, which in luma.gl can often be thought of as one row in an a data table being rendered.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="under-the-hood">Under the Hood<a class="hash-link" aria-label="Direct link to Under the Hood" title="Direct link to Under the Hood" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#under-the-hood">​</a></h2>
<p>Depending on the structure of the shader, each object can either correspond to an <code>instance</code> or a group of vertexes.</p>
<p>An additional consideration</p>
<p>li</p>
<p>The <code>gpuPicking</code> modules supports:</p>
<ul>
<li>picking of object indexes</li>
<li>highlighting of objects</li>
<li>pick a specific <em>instance</em> in an instanced draw call</li>
<li>highlight all fragments of an <em>instance</em> based on its picking color</li>
<li>pick &quot;group of primitives&quot; with the same picking color in non-instanced draw-calls</li>
<li>highlight &quot;group of primitives&quot; with the same picking color in non-instanced draw-calls</li>
</ul>
<p>Highlighting allows applications to specify a picking color corresponding to an object that need to be highlighted and the highlight color to be used.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-gpu-based-picking">About GPU based picking<a class="hash-link" aria-label="Direct link to About GPU based picking" title="Direct link to About GPU based picking" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#about-gpu-based-picking">​</a></h2>
<p>GPU based picking has a couple of significant advantage over CPU-based picking:</p>
<ul>
<li>
<p>GPU-based picking is a picking technique that can be performed entirely on the GPU, meaning that it is very performant, especially when picking is done every frame.</p>
</li>
<li>
<p>can be added to any existing shaders</p>
</li>
<li>
<p>and is independent of the structure of the input geometry or rendering without requiring any additional picking logic to that shader, beyond calling one function in the vertex shader and one function in the fragment shader.</p>
</li>
</ul>
<p>Note that GPU-based picking does comes with some limitations:</p>
<ul>
<li>Picking occluding objects require re-rendering and discarding the already picked objects.</li>
<li>On WebGL-specific: the read back of the picking data from the picking texture can only be done synchronously, causing a GPU pipeline stall, which can defeat some of the performance advantages.</li>
</ul>
<p>Traditional 3d frameworks often support CPU-based picking. While luma.gl does not include an CPU-based picking algorithms, CPU based picking techniques do have advantages:</p>
<ul>
<li>They can often provide precise intersection points on objects and they are better at handling picking of multiple objects, especially for objects that are occluded.</li>
<li>However CPU based picking techniques are slower and can require more data on the CPU or they may need to be customized to the structure of the input data.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#usage">​</a></h2>
<p>In your vertex shader, your inform the picking module what object we are currently rendering by supplying a picking color, perhaps from an attribute.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">attribute vec3 aPickingColor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">picking_setPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aPickingColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In your fragment shader, you simply apply (call) the <code>picking_filterColor</code> filter function at the very end of the shader. This will return the normal color, or the highlight color, or the picking color, as appropriate.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">picking_filterPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl_FragColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In your fragment shader, you simply apply (call) the <code>picking_filterPickingColor</code> filter function at the very end of the shader. This will return the normal color, or the highlight color, or the picking color, as appropriate.</p>
<div class="language-glsl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-glsl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor = ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor = picking_filterPickingColor(gl_FragColor);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If highlighting is not needed, you simply apply (call) the <code>picking_filterPickingColor</code> filter function at the very end of the shader. This will return the normal color or the picking color, as appropriate.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">picking_filterPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl_FragColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you would like to apply the highlight color to the currently selected element call <code>picking_filterHighlightColor</code> before calling <code>picking_filterPickingColor</code>. You can also apply other filters on the non-picking color (vertex or highlight color) by placing those instruction between these two function calls.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">picking_filterHighlightColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl_FragColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"> apply </span><span class="token builtin">any</span><span class="token plain"> filters on gl_FragColor </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gl_FragColor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">picking_filterPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl_FragColor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="javascript-functions">JavaScript Functions<a class="hash-link" aria-label="Direct link to JavaScript Functions" title="Direct link to JavaScript Functions" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#javascript-functions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getuniforms">getUniforms()<a class="hash-link" aria-label="Direct link to getUniforms()" title="Direct link to getUniforms()" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#getuniforms">​</a></h3>
<p><code>getUniforms()</code> takes an object with key/value pairs, returns an object with key/value pairs representing the uniforms that the <code>gpuPicking</code> module shaders need.</p>
<p>Uniforms for the picking module, which renders picking colors and highlighted item.
When active, renders picking colors, assumed to be rendered to off-screen &quot;picking&quot; buffer.
When inactive, renders normal colors, with the exception of selected object which is rendered with highlight</p>
<table><thead><tr><th>Setting</th><th>Description</th></tr></thead><tbody><tr><td><code>isActive</code>?: boolean</td><td>Whether in picking or normal rendering (+highlighting) mode</td></tr><tr><td><code>isAttribute</code>: boolean</td><td>Set to true when picking an attribute value instead of object index</td></tr><tr><td><code>useFloatColors</code>?: boolean</td><td>Color range 0-1 or 0-255</td></tr><tr><td><code>isHighlightActive</code>?: boolean</td><td>Do we have a highlighted item?</td></tr><tr><td><code>highlightedObjectColor</code>?: NumberArray</td><td>Set to a picking color to visually highlight that item</td></tr><tr><td><code>highlightColor</code>?: NumberArray</td><td>Color of visual highlight of &quot;selected&quot; item</td></tr></tbody></table>
<ul>
<li><code>isActive</code> - When true, renders picking colors. Set when rendering to off-screen &quot;picking&quot; buffer. When false, renders normal colors, with the exception of selected object which is rendered with highlight</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vertex-shader-functions">Vertex Shader Functions<a class="hash-link" aria-label="Direct link to Vertex Shader Functions" title="Direct link to Vertex Shader Functions" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#vertex-shader-functions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="picking_setpickingcolor">picking_setPickingColor()<a class="hash-link" aria-label="Direct link to picking_setPickingColor()" title="Direct link to picking_setPickingColor()" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_setpickingcolor">​</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">picking_setPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vec3 pickingColor</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Sets the color that will be returned by the fragment shader if color based picking is enabled. Typically set from a <code>pickingColor</code> uniform or a <code>pickingColors</code> attribute (e.g. when using instanced rendering, to identify the actual instance that was picked).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="picking_setpickingattribute">picking_setPickingAttribute<a class="hash-link" aria-label="Direct link to picking_setPickingAttribute" title="Direct link to picking_setPickingAttribute" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_setpickingattribute">​</a></h3>
<p>Sets the attribute value that needs to be picked.</p>
<p><code>void picking_setPickingAttribute(float value)</code>
<code>void picking_setPickingAttribute(vec2 value)</code>
<code>void picking_setPickingAttribute(vec3 value)</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fragment-shader-functions">Fragment Shader Functions<a class="hash-link" aria-label="Direct link to Fragment Shader Functions" title="Direct link to Fragment Shader Functions" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#fragment-shader-functions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="picking_filtercolor">picking_filterColor<a class="hash-link" aria-label="Direct link to picking_filterColor" title="Direct link to picking_filterColor" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filtercolor">​</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fn </span><span class="token function" style="color:#d73a49">picking_filterColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vec4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">f32</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> vec4</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">f32</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vec4 </span><span class="token function" style="color:#d73a49">picking_filterColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vec4 color</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Picking Enabled</th><th>Item Highlighted</th><th>Returned color</th></tr></thead><tbody><tr><td>✅</td><td>–</td><td>Returns picking color (representing index of this color)</td></tr><tr><td>❌</td><td>✅</td><td>Returns the current highlight color (to show this item as &quot;selected&quot;)</td></tr><tr><td>❌</td><td>❌</td><td>returns the original color (unmodified <code>color</code> argument)</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="picking_filterpickingcolor">picking_filterPickingColor()<a class="hash-link" aria-label="Direct link to picking_filterPickingColor()" title="Direct link to picking_filterPickingColor()" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filterpickingcolor">​</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vec4 </span><span class="token function" style="color:#d73a49">picking_filterPickingColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vec4 color</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If picking active, returns the current vertex&#x27;s picking color set by <code>picking_setPickingColor</code>, otherwise returns its argument unmodified.</p>
<p>Returns picking highlight color if the pixel belongs to currently selected model, otherwise returns its argument unmodified.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="picking_filterpickingcolor-1">picking_filterPickingColor()<a class="hash-link" aria-label="Direct link to picking_filterPickingColor()" title="Direct link to picking_filterPickingColor()" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filterpickingcolor-1">​</a></h3>
<p><code>vec4 picking_filterPickingColor(vec4 color)</code></p>
<p>If picking active, returns the current vertex&#x27;s picking color set by <code>picking_setPickingColor</code>, otherwise returns its argument unmodified.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remarks">Remarks<a class="hash-link" aria-label="Direct link to Remarks" title="Direct link to Remarks" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#remarks">​</a></h2>
<ul>
<li>It is recommended that <code>picking_filterPickingColor()</code> is called last in a fragment shader, as the picking color (returned when picking is enabled) must not be modified in any way (and alpha must remain 1) or picking results will not be correct.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/visgl/luma.gl/tree/main/docs/../docs/api-reference/shadertools/shader-modules/gpu-picking.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#under-the-hood">Under the Hood</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#about-gpu-based-picking">About GPU based picking</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#usage">Usage</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#javascript-functions">JavaScript Functions</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#getuniforms">getUniforms()</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#vertex-shader-functions">Vertex Shader Functions</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_setpickingcolor">picking_setPickingColor()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_setpickingattribute">picking_setPickingAttribute</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#fragment-shader-functions">Fragment Shader Functions</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filtercolor">picking_filterColor</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filterpickingcolor">picking_filterPickingColor()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#picking_filterpickingcolor-1">picking_filterPickingColor()</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/shadertools/shader-modules/gpu-picking#remarks">Remarks</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/../docs">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/deckgl/shared_invite/zt-7oeoqie8-NQqzSp5SLTFMDeNSPxi7eg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack workspace<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">vis.gl blog (Medium)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OpenJS Foundation</div></div></div></footer></div>
</body>
</html>