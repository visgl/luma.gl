<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-api-reference/engine/animation-loop" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">AnimationLoop | luma.gl</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luma.gl/docs/api-reference/engine/animation-loop"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="AnimationLoop | luma.gl"><meta data-rh="true" name="description" content="Manages an animation loop and optionally a WebGL context and a WebGL canvas. It provides a number of features related to initialization and animation of a WebGL context."><meta data-rh="true" property="og:description" content="Manages an animation loop and optionally a WebGL context and a WebGL canvas. It provides a number of features related to initialization and animation of a WebGL context."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://luma.gl/docs/api-reference/engine/animation-loop"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/api-reference/engine/animation-loop" hreflang="en"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/api-reference/engine/animation-loop" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.73cc160a.css">
<script src="/assets/js/runtime~main.3922ae53.js" defer="defer"></script>
<script src="/assets/js/main.9667d192.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luma.gl</b></a><a class="navbar__item navbar__link" href="/examples">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials">Tutorials</a><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-examples-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/whats-new">What&#x27;s New</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/upgrade-guide">Upgrade Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tutorials/">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/api-guide/">API Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/api-reference/">API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/core/">@luma.gl/core</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/api-reference/engine/model">@luma.gl/engine</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/model">Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/shader-inputs">ShaderInputs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/api-reference/engine/animation-loop">AnimationLoop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/animation-loop-template">AnimationLoopTemplate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/async-texture">AsyncTexture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/load-image-bitmap">loadImageBitmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/geometry/geometries">Built-in Geometries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/geometry/">Geometry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/animation/key-frames">KeyFrames</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/animation/timeline">Timeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/scenegraph/group-node">GroupNode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/scenegraph/model-node">ModelNode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/scenegraph/scenegraph-node">ScenegraphNode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/pipeline-factory">PipelineFactory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/shader-factory">ShaderFactory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/passes/shader-pass-renderer">ShaderPassRenderer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/compute/swap">Swap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/compute/computation">Computation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/compute/buffer-transform">BufferTransform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/compute/texture-transform">TextureTransform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/gpgpu/gpu-point-in-polygon">GPUPointInPolygon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api-reference/engine/gpgpu/histopyramid">Histopyramid</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/gltf/">@luma.gl/gltf</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/shadertools/shader-modules/fp32">@luma.gl/shadertools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/test-utils/">@luma.gl/test-utils</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/webgl/">@luma.gl/webgl</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/api-reference/webgpu/">@luma.gl/webgpu</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/developer-guide/">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/legacy/porting-guide">Legacy Guides</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API Reference</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">@luma.gl/engine</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">AnimationLoop</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>AnimationLoop</h1>
<p>Manages an animation loop and optionally a WebGL context and a WebGL canvas. It provides a number of features related to initialization and animation of a WebGL context.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage" href="/docs/api-reference/engine/animation-loop#usage">​</a></h2>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AnimationLoop</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ClipSpace</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@luma.gl/engine&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> animationLoop </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AnimationLoop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  device</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> luma</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createDevice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override </span><span class="token function" style="color:#d73a49">onInitialize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Keys in the object returned here will be available in onRender</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clipSpaceQuad </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ClipSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">FRAGMENT_SHADER</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override </span><span class="token function" style="color:#d73a49">onRender</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">tick</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Tick is autoupdated by AnimationLoop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clipSpaceQuad</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setUniforms</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">uTime</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> tick </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">animationLoop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Use a canvas in the existing DOM through its HTML id</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">animationLoop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">canvas</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my-canvas&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="types">Types<a class="hash-link" aria-label="Direct link to Types" title="Direct link to Types" href="/docs/api-reference/engine/animation-loop#types">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="animationloopprops">AnimationLoopProps<a class="hash-link" aria-label="Direct link to AnimationLoopProps" title="Direct link to AnimationLoopProps" href="/docs/api-reference/engine/animation-loop#animationloopprops">​</a></h3>
<table><thead><tr><th>Property</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>device?</code></td><td><code>Device</code> | <code>Promise&lt;Device&gt;</code></td><td></td><td>A <code>Device</code> to render into.</td></tr><tr><td><code>onInitialize?</code></td><td>(callback)</td><td></td><td>Called once after the first call to <code>animationLoop.start()</code>. Use to create GPU resources</td></tr><tr><td><code>onRender?</code></td><td>(callback)</td><td></td><td>- Called on every animation frame. Use to render .</td></tr><tr><td><code>onFinalize?</code></td><td>(callback)</td><td></td><td>- Called once when animation is stopped. Used to delete objects or free any resources created during <code>onInitialize?</code></td></tr><tr><td><code>onError</code></td><td>(callback)</td><td></td><td>- Called when an error is about to be thrown.</td></tr><tr><td><code>autoResizeViewport?</code></td><td><code>boolean</code></td><td><code>true</code></td><td>If true, auto resizes GPU viewport each frame before <code>onRender</code> is called.</td></tr><tr><td><code>autoResizeDrawingBuffer?</code></td><td><code>boolean</code></td><td><code>true</code></td><td>If true, resizes the drawing buffer  each frame before <code>onRender</code> is called.</td></tr><tr><td><code>useDevicePixels?</code></td><td><code>boolean | number</code></td><td></td><td>Multiplier. <code>true</code> uses <code>window.devicePixelRatio</code> as a multiplier in <code>autoResizeDrawingBuffer</code> etc.</td></tr><tr><td><code>stats?</code></td><td><code>Stats</code></td><td></td><td>A probe.gl <code>Stats</code> instance, Auto-created if not supplied.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="animationprops">AnimationProps<a class="hash-link" aria-label="Direct link to AnimationProps" title="Direct link to AnimationProps" href="/docs/api-reference/engine/animation-loop#animationprops">​</a></h3>
<p>The <code>onInitialize</code>, <code>onRender</code> and <code>onFinalize</code>callbacks will be called with an object containing the following fields:</p>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>animationLoop</code></td><td><code>AnimationLoopTemplate</code></td><td>The calling <code>AnimationLoopTemplate</code> instance</td></tr><tr><td><code>device</code></td><td><code>Device</code></td><td>This <code>AnimationLoopTemplate</code>&#x27;s gl context.</td></tr><tr><td><code>canvas</code></td><td><code>HTMLCanvasElement</code> or <code>OffscreenCanvas</code></td><td>The canvas associated with this context.</td></tr><tr><td><code>aspect</code></td><td><code>number</code></td><td>The canvas aspect ratio (width/height) to update projection matrices</td></tr><tr><td><code>width</code></td><td></td><td>The drawing buffer width, in &quot;device&quot; pixels (can be different from canvas.width).</td></tr><tr><td><code>height</code></td><td></td><td>The drawing buffer height, in &quot;device&quot; pixels (can be different from canvas.width).</td></tr><tr><td><code>useDevicePixels</code></td><td><code>boolean</code></td><td>Boolean indicating if canvas is utilizes full resolution of Retina/</td></tr><tr><td><code>needsRedraw</code></td><td><code>String</code></td><td>Redraw flag (will be automatically set if drawingBuffer resizes)</td></tr><tr><td><code>time</code></td><td><code>Number</code></td><td>Milliseconds since <code>AnimationLoopTemplate</code> was created (monotonic).</td></tr><tr><td><code>tick</code></td><td><code>Number</code></td><td>Counter that updates for every frame rendered (monotonic).</td></tr><tr><td><code>renderPass</code></td><td><code>RenderPass</code></td><td>Availabel if <code>createFrameBuffer: true</code> was passed to the constructor.</td></tr><tr><td><code>_mousePosition</code></td><td><code>[x, y]</code> or <code>null</code></td><td>(<strong>experimental</strong>) Current mouse position over the canvas.</td></tr><tr><td><code>_timeline</code></td><td><code>Timeline</code></td><td>(<strong>experimental</strong>) <code>Timeline</code> object tracking the animation timeline and channels.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="methods">Methods<a class="hash-link" aria-label="Direct link to Methods" title="Direct link to Methods" href="/docs/api-reference/engine/animation-loop#methods">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="constructor">constructor<a class="hash-link" aria-label="Direct link to constructor" title="Direct link to constructor" href="/docs/api-reference/engine/animation-loop#constructor">​</a></h3>
<p>Creates a new <code>AnimationLoop</code>.</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AnimationLoop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AnimationLoopProps</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>props</code> - See documentation of <code>AnimationLoopProps</code> above.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setpropsprops--object">setProps(props : Object)<a class="hash-link" aria-label="Direct link to setProps(props : Object)" title="Direct link to setProps(props : Object)" href="/docs/api-reference/engine/animation-loop#setpropsprops--object">​</a></h3>
<p><code>animationLoop.setProps({...props})</code></p>
<ul>
<li><code>props.autoResizeViewport</code> - Call <code>gl.viewport</code> before each call to <code>onRender()</code></li>
<li><code>props.autoResizeDrawingBuffer</code> - Update the drawing buffer size to match the canvas size before each call to <code>onRender()</code></li>
<li><code>props.useDevicePixels</code> - Whether to use <code>window.devicePixelRatio</code> as a multiplier, e.g. in <code>autoResizeDrawingBuffer</code> etc.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="start">start()<a class="hash-link" aria-label="Direct link to start()" title="Direct link to start()" href="/docs/api-reference/engine/animation-loop#start">​</a></h3>
<p>Restarts the animation</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">animationLoop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>options</code>=<code>{}</code> (object) - Options to create the WebGLContext with.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stop">stop()<a class="hash-link" aria-label="Direct link to stop()" title="Direct link to stop()" href="/docs/api-reference/engine/animation-loop#stop">​</a></h3>
<p>Stops the animation</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">animationLoop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="waitforrender--promise">waitForRender() : Promise<a class="hash-link" aria-label="Direct link to waitForRender() : Promise" title="Direct link to waitForRender() : Promise" href="/docs/api-reference/engine/animation-loop#waitforrender--promise">​</a></h3>
<p>Returns a promise which resolves in the next frame after rendering and the <code>onRender</code> callback have completed.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> loop </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> animationLoop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">waitForRender</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// can now e.g. read pixels from webgl context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redraw">redraw()<a class="hash-link" aria-label="Direct link to redraw()" title="Direct link to redraw()" href="/docs/api-reference/engine/animation-loop#redraw">​</a></h3>
<p>Immediately invokes a redraw (call <code>onRender</code> with updated animation props). Only use if the canvas must be updated synchronously.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setneedsredraw">setNeedsRedraw()<a class="hash-link" aria-label="Direct link to setNeedsRedraw()" title="Direct link to setNeedsRedraw()" href="/docs/api-reference/engine/animation-loop#setneedsredraw">​</a></h3>
<p><code>animationLoop.setNeedsRedraw(reason: string)</code></p>
<ul>
<li><code>reason</code> (<code>String</code>) - A human readable string giving a hint as to why redraw was needed (e.g. &quot;geometry changed&quot;).</li>
</ul>
<p>If set, the value will be provided as the <code>needsRedraw</code> field to the <code>onRender</code> callback.</p>
<p>Notes:</p>
<ul>
<li><code>onRender</code> will be called for each animation frame regardless of whether this flag is set, and the redraw reason is automatically cleared.</li>
<li>If called multiple times, the <code>reason</code> provided in the first call will be remembered.</li>
<li><code>AnimationLoop</code> automatically sets this flag if the WebGL context&#x27;s drawing buffer size changes.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="attachtimeline">attachTimeline()<a class="hash-link" aria-label="Direct link to attachTimeline()" title="Direct link to attachTimeline()" href="/docs/api-reference/engine/animation-loop#attachtimeline">​</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">attachTimeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timeline</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Timeline</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Attach an <code>Timeline</code> object to the animation loop. Allows time produced for animations to be paused, played, etc. See <code>Timeline</code> documentation for more info.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detachtimeline">detachTimeline()<a class="hash-link" aria-label="Direct link to detachTimeline()" title="Direct link to detachTimeline()" href="/docs/api-reference/engine/animation-loop#detachtimeline">​</a></h3>
<p>Detach the currently attached timeline from the animation loop.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="todataurl">toDataURL()<a class="hash-link" aria-label="Direct link to toDataURL()" title="Direct link to toDataURL()" href="/docs/api-reference/engine/animation-loop#todataurl">​</a></h3>
<p>Returns returns a <code>Promise</code> that resolves to the data URL of the canvas once drawing operations are complete for the current frame. The data URL can be used as the <code>src</code> for an HTML image element.</p>
<p><code>animationLoop.toDataURL()</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="callback-parameters">Callback Parameters<a class="hash-link" aria-label="Direct link to Callback Parameters" title="Direct link to Callback Parameters" href="/docs/api-reference/engine/animation-loop#callback-parameters">​</a></h2>
<p>The callbacks <code>onInitialize</code>, <code>onRender</code> and <code>onFinalize</code> that the app supplies to the <code>AnimationLoop</code>, will be called with an object containing named parameters:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="frame-timers">Frame timers<a class="hash-link" aria-label="Direct link to Frame timers" title="Direct link to Frame timers" href="/docs/api-reference/engine/animation-loop#frame-timers">​</a></h3>
<ul>
<li>The animation loop tracks GPU and CPU render time of each frame the in member properties <code>cpuTime</code> and <code>gpuTime</code>. If <code>gpuTime</code> is set to <code>-1</code>, then the timing for the last frame was invalid and should not be used (this rare and might occur, for example, if the GPU was throttled mid-frame).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remarks">Remarks<a class="hash-link" aria-label="Direct link to Remarks" title="Direct link to Remarks" href="/docs/api-reference/engine/animation-loop#remarks">​</a></h2>
<ul>
<li>You can instantiate multiple <code>AnimationLoop</code> classes in parallel, rendering into the same or different <code>devices</code>.</li>
<li>Works both in browser and under Node.js.</li>
<li>All <code>AnimationLoop</code> methods can be chained.</li>
<li>Postpones context creation until the page (i.e. all HTML) has been loaded. At this time it is safe to specify canvas ids.</li>
<li>The supplied callback function must return a WebGLRenderingContext or an error will be thrown.</li>
<li>This callback registration function should not be called if a <code>WebGLRenderingContext</code> was supplied to the AnimationLoop constructor.</li>
<li><code>useDevicePixels</code> can accept a custom ratio (Number), instead of <code>true</code> or <code>false</code>. This allows rendering to a much smaller or higher resolutions. When using high value (usually more than device pixel ratio), it is possible it can get clamped down, this happens due to system memory limitation, in such cases a warning will be logged to the browser console.</li>
<li>`onInitialize`` is called after page load completes and the passed in device promise has been resolved (the device has been created).</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/visgl/luma.gl/tree/main/docs/../docs/api-reference/engine/animation-loop.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/api-reference/engine/shader-inputs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ShaderInputs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/api-reference/engine/animation-loop-template"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AnimationLoopTemplate</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#usage">Usage</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#types">Types</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#animationloopprops">AnimationLoopProps</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#animationprops">AnimationProps</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#methods">Methods</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#constructor">constructor</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#setpropsprops--object">setProps(props : Object)</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#start">start()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#stop">stop()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#waitforrender--promise">waitForRender() : Promise</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#redraw">redraw()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#setneedsredraw">setNeedsRedraw()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#attachtimeline">attachTimeline()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#detachtimeline">detachTimeline()</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#todataurl">toDataURL()</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#callback-parameters">Callback Parameters</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#frame-timers">Frame timers</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/api-reference/engine/animation-loop#remarks">Remarks</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/../docs">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/deckgl/shared_invite/zt-7oeoqie8-NQqzSp5SLTFMDeNSPxi7eg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack workspace<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">vis.gl blog (Medium)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OpenJS Foundation</div></div></div></footer></div>
</body>
</html>