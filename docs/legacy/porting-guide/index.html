<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-legacy/porting-guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Porting Guide | luma.gl</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luma.gl/docs/legacy/porting-guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Porting Guide | luma.gl"><meta data-rh="true" name="description" content="Given that the changes in the v9 API are quite extensive, this separate porting guide is provided to hopefully help plan the upgrade process."><meta data-rh="true" property="og:description" content="Given that the changes in the v9 API are quite extensive, this separate porting guide is provided to hopefully help plan the upgrade process."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://luma.gl/docs/legacy/porting-guide"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/legacy/porting-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://luma.gl/docs/legacy/porting-guide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2d8d466f.css">
<script src="/assets/js/runtime~main.389668e5.js" defer="defer"></script>
<script src="/assets/js/main.6acf28e7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.png" alt="vis.gl Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">luma.gl</b></a><a class="navbar__item navbar__link" href="/examples">Examples</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/docs/tutorials">Tutorials</a><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-examples-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/whats-new">What&#x27;s New</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/upgrade-guide">Upgrade Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/api-guide/">API Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/api-reference/">API Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/developer-guide/">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/legacy/porting-guide">Legacy Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/legacy/porting-guide">Porting Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/legacy/legacy-upgrade-guide">Legacy Upgrade Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/legacy/legacy-whats-new">Legacy What&#x27;s New</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Legacy Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Porting Guide</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Porting Guide</h1>
<p>Given that the changes in the v9 API are quite extensive, this separate porting guide is provided to hopefully help plan the upgrade process.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="v9-api-design-background">v9 API Design background<a href="#v9-api-design-background" class="hash-link" aria-label="Direct link to v9 API Design background" title="Direct link to v9 API Design background">​</a></h2>
<p>We&#x27;ll start with motivating the changes in v9.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-is-the-v9-api-a-major-breaking-change">Why is the v9 API a major breaking change?<a href="#why-is-the-v9-api-a-major-breaking-change" class="hash-link" aria-label="Direct link to Why is the v9 API a major breaking change?" title="Direct link to Why is the v9 API a major breaking change?">​</a></h3>
<p>The v8 API design was focused on providing a set of classes optimized for working with the WebGL2 API, and a significant part of the code was untyped, predating TypeScript introduction.</p>
<p>The v9 API design makes a number breaking changes in order to take full advantage of WebGPU and TypeScript.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="goal-a-webgpu-first-api">Goal: A &quot;WebGPU-first&quot; API<a href="#goal-a-webgpu-first-api" class="hash-link" aria-label="Direct link to Goal: A &quot;WebGPU-first&quot; API" title="Direct link to Goal: A &quot;WebGPU-first&quot; API">​</a></h4>
<p>Adding WebGPU support was the top priority for luma.gl v9. Some consideration was given towards keeping the existing WebGL2-centric API and providing a WebGPU implementation for that API, to avoid breaking applications. But ultimately that did not make sense. The WebGPU API is quite different from WebGL. WebGPU was designed to avoid the performance overhead that is unavoidable in WebGL APIs (e.g. avoid repeated validation of GPU objects, avoid repeated issuing of same commands, avoid constructs that prevent deep shader optimizations etc). WebGPU is clearly the future of GPU APIs in the browser (WebGL is no longer evolving). It seems doubtful that luma.gl would be able to remain relevant if it stuck to a WebGL-focused API.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="goal-a-typescript-first-api">Goal: A &quot;TypeScript-first&quot; API<a href="#goal-a-typescript-first-api" class="hash-link" aria-label="Direct link to Goal: A &quot;TypeScript-first&quot; API" title="Direct link to Goal: A &quot;TypeScript-first&quot; API">​</a></h4>
<p>As luma.gl continued to adopt TypeScript it become clear that modern TypeScript enables a number of simpler, more intuitive API constructions. One example is that in TypeScript we can now safely specify that an &quot;enum type&quot; argument must be one of a few specific strings. By using string values in types, we don&#x27;t need to introduce enumerations or key-value object constants. As an example the <code>Sampler</code> <code>minFilter</code> property is now specified as either <code>&#x27;linear&#x27;</code> or <code>&#x27;nearest&#x27;</code>, rather than <code>GL.LINEAR</code> or <code>GL.NEAREST</code>. This move to string constant values enabled luma.gl to align string constants with the WebGPU standard, avoiding the need to define additional mappings and abstractions on top of the WebGPU API.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="goal-improved-maintainability">Goal: Improved Maintainability<a href="#goal-improved-maintainability" class="hash-link" aria-label="Direct link to Goal: Improved Maintainability" title="Direct link to Goal: Improved Maintainability">​</a></h4>
<p>Another reason for the breaking changes in v9 is simply the removal and restructuring of legacy code. Over 8 releases, the luma.gl API had grown quite large. It exposed all the functionality offered by WebGL2, however many WebGL 2 functions were rarely used. luma.gl contained a lot of code for mutating WebGL resources, which would not work for an applications that also attempts to run on WebGPU, since WebGPU classes are (mostly) immutable. In addition, some core maintainers of luma.gl have moved on, so we took the opportunity to cut out some legacy code to make sure the code base remains accessible and easy to understand for the community. The new WebGPU compatible API provided the just the lens we needed to decide which particular pieces of functionality should be cut.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="effort-estimation">Effort Estimation<a href="#effort-estimation" class="hash-link" aria-label="Direct link to Effort Estimation" title="Direct link to Effort Estimation">​</a></h2>
<p>Suddenly having to upgrade an existing application to a new breaking API version is never fun. A first step for a developer is often to assess how much effort an upgrade is likely to require.</p>
<p>While it is impossible for us to assess here how much work will be required for your specific application, and the list of luma.gl v9 changes listed below is long, it probably looks worse than it is:</p>
<ul>
<li>While the entire API has been modernized, the overall structure and concepts of the classic luma.gl API have been preserved.</li>
<li>The API abstraction level has not changed, and while constants and names etc will need to be updated, programmers should find themselves comfortably working with the same classes in luma.gl v9 as they did in v8, without having to re-learn the API.</li>
<li>They key building block classes like <code>AnimationLoop</code>, <code>Model</code>, <code>Buffer</code>, <code>Texture</code> etc are still available.</li>
<li>Many changes affect parts of the API that are not frequently used in most applications.</li>
<li>In addition, the strong TypeScript typings in luma.gl v9 should create a strong safety net when porting. This means that the typescript compiler should be able to pinpoint most breakages in your application before you even run your code.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-v9-api-overview">Quick v9 API overview<a href="#quick-v9-api-overview" class="hash-link" aria-label="Direct link to Quick v9 API overview" title="Direct link to Quick v9 API overview">​</a></h2>
<p>The luma.gl v9 API is designed to provide portable WebGPU / WebGL 2 API, ground-up TypeScript support, and strong support for working with both WGSL and GLSL shaders.</p>
<p>The new v9 GPU API is now an abstract Device API, meaning that the API itself is specified in terms of TypeScript interfaces and abstract classes that cannot be directly instantiates. Types such as <code>Buffer</code>, <code>Texture</code> etc can not be used on their own, but a subclass that implements the functionality of that class a specific GPU API must be requested from a Device (<code>WebGLBuffer</code>, <code>WebGPUTexture</code>).</p>
<p>The new <code>Device</code> class provides the access point to the new GPU interface. It creates and instruments the WebGL context or the WebGPU adapter, and provides methods to create all the implementation classes (<code>WebGLDevice.createBuffer(... =&gt;  WebGLBuffer</code>, <code>WebGPUDevice.createTexture(... =&gt;  WebGLGPUTexture</code>)</p>
<p>The new <code>CanvasContext</code> class handles context sizing, resolution etc.</p>
<p>The v9 API no longer accepts/returns <code>GL</code> constants, but instead uses the corresponding string values from the WebGPU standard (mapping those transparently under WebGL).</p>
<ul>
<li>The parameter API has been updated to more closely match the WebGPU API. Also parameters are specified on pipelines and render pass creation and are and not as easy to change per draw call as they were in luma.gl v8.</li>
</ul>
<p>In progress</p>
<ul>
<li>
<p>Reading and writing buffers is now an async operation. While WebGL does not support async reads and writes on MacOS, the API is still async to ensure portability to WebGPU.</p>
</li>
<li>
<p>Uniform buffers are now the standard way for the application to specify uniforms. Uniform buffers are &quot;emulated&quot; under WebGL.</p>
</li>
</ul>
<p>A subset of the new interfaces in the luma.gl v9 API:</p>
<table><thead><tr><th>Interface</th><th>Description</th></tr></thead><tbody><tr><td><code>Adapter</code></td><td>luma.gl exposes GPU capabilities on the device in the form of one or more as <code>Adapter</code>s.</td></tr><tr><td><code>Device</code></td><td>Manages resources, and the device’s GPUQueues, which execute commands.</td></tr><tr><td><code>Buffer</code></td><td>The physical resources backed by GPU memory. A <code>Device</code> may have its own memory with high-speed access to the processing units.</td></tr><tr><td><code>Texture</code></td><td>Like buffer, but supports random access</td></tr><tr><td>GPUCommandBuffer and GPURenderBundle are containers for user-recorded commands.</td><td></td></tr><tr><td><code>Shader</code></td><td>Compiled shader code.</td></tr><tr><td><code>Sampler</code></td><td>or GPUBindGroup, configure the way physical resources are used by the GPU.</td></tr></tbody></table>
<p>GPUs execute commands encoded in GPUCommandBuffers by feeding data through a pipeline, which is a mix of fixed-function and programmable stages. Programmable stages execute shaders, which are special programs designed to run on GPU hardware. Most of the state of a pipeline is defined by a GPURenderPipeline or a GPUComputePipeline object. The state not included in these pipeline objects is set during encoding with commands, such as beginRenderPass() or setBlendColor().</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="porting-strategy">Porting Strategy<a href="#porting-strategy" class="hash-link" aria-label="Direct link to Porting Strategy" title="Direct link to Porting Strategy">​</a></h2>
<p>This is based on the porting strategy used to port <a href="https://deck.gl" target="_blank" rel="noopener noreferrer">deck.gl</a>, which is the biggest luma.gl-dependent code base.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-update-imports">Step 1: Update Imports<a href="#step-1-update-imports" class="hash-link" aria-label="Direct link to Step 1: Update Imports" title="Direct link to Step 1: Update Imports">​</a></h3>
<ul>
<li>Change imports from <code>@luma.gl/gltools</code> to <code>@luma.gl/webgl</code>.</li>
<li>Change imports from <code>@luma.gl/core</code> to <code>@luma.gl/webgl</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-replace-webglrenderingcontext-with-device">Step 2: Replace WebGLRenderingContext with Device<a href="#step-2-replace-webglrenderingcontext-with-device" class="hash-link" aria-label="Direct link to Step 2: Replace WebGLRenderingContext with Device" title="Direct link to Step 2: Replace WebGLRenderingContext with Device">​</a></h3>
<p>The quickest way to start porting would be to start updating your application to consistently use the new <code>Device</code> class instead of directly working with .</p>
<ul>
<li><strong>Feature Detection</strong> - At the end of this stage it is also possible to replace feature detection constants with the new <code>device.features</code> functionality.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-replace-canvas-manipulation-with-canvascontext">Step 3: Replace canvas manipulation with CanvasContext<a href="#step-3-replace-canvas-manipulation-with-canvascontext" class="hash-link" aria-label="Direct link to Step 3: Replace canvas manipulation with CanvasContext" title="Direct link to Step 3: Replace canvas manipulation with CanvasContext">​</a></h3>
<p>The handling of canvas related functionality (size, resolution etc) can
be a messy part of WebGL applications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-replace-parameter-names">Step 3: Replace parameter names<a href="#step-3-replace-parameter-names" class="hash-link" aria-label="Direct link to Step 3: Replace parameter names" title="Direct link to Step 3: Replace parameter names">​</a></h3>
<p>Recommended changes:</p>
<ul>
<li>Gradually reduce the number of imports <code>@luma.gl/constants</code> and start adopting string constants.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-gpu-parameters">Upgrading GPU Parameters<a href="#upgrading-gpu-parameters" class="hash-link" aria-label="Direct link to Upgrading GPU Parameters" title="Direct link to Upgrading GPU Parameters">​</a></h2>
<ul>
<li>Parameters are set on <code>Pipeline</code> creation. They can not be modified, or passed as parameters to draw calls.</li>
<li>Parameters can now only be set, not queried. luma.gl no longer provides a way to query parameters.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="depth-testing">Depth testing<a href="#depth-testing" class="hash-link" aria-label="Direct link to Depth testing" title="Direct link to Depth testing">​</a></h2>
<p>To set up depth testing</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setParameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depthWriteEnabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depthCompare</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;less-equal&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrading-to-v90">Upgrading to v9.0<a href="#upgrading-to-v90" class="hash-link" aria-label="Direct link to Upgrading to v9.0" title="Direct link to Upgrading to v9.0">​</a></h2>
<p>luma.gl v9 is a major modernization of the luma.gl API, so the upgrade notes for this release are unusually long.
This page primarily contains a reference list of API changes. To facilitate porting to the v9 release we have also provided a
<a href="/docs/legacy/porting-guide">Porting Guide</a> that provides more background information and recommended porting strategies.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removed-functionality">Removed Functionality<a href="#removed-functionality" class="hash-link" aria-label="Direct link to Removed Functionality" title="Direct link to Removed Functionality">​</a></h3>
<p>Going forward, luma.gl will focus on leveraging the capabilities WebGPU, while maintaining a high-quality, compatible WebGL2 backend. To accelerate this roadmap, luma.gl v9 is dropping WebGL 1 support.</p>
<ul>
<li><strong>WebGL1</strong> is no longer supported. The <code>@luma.gl/webgl</code> backend now always creates a <strong>WebGL2 context</strong>.</li>
<li><strong>GLSL 1.00</strong> is no longer supported. GLSL shaders need to be ported to <strong>GLSL 3.00</strong>.</li>
<li><strong>headless-gl</strong> integration for Node.js is no longer supported (as it only supported WebGL 1).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="non-api-changes">Non-API changes<a href="#non-api-changes" class="hash-link" aria-label="Direct link to Non-API changes" title="Direct link to Non-API changes">​</a></h3>
<p>luma.gl v9 upgrades tooling and packaging to latest JavaScript ecosystem standards:</p>
<ul>
<li><strong>ES modules</strong> - luma.gl is now published as ES modules. This is the modern way of packaging JavaScript applications that fully embraces the static <code>import</code>/<code>export</code> syntax. While most bundlers and Node.js environments have added support for ES modules, they can introduce incompatibilities with code that uses legacy imports. Getting your build tooling and code base ready for ES modules may be a good first step before you start upgrading luma.gl.</li>
<li><strong>Dependencies</strong> - luma.gl v9 introduces major version bumps of its key vis.gl dependencies: <code>math.gl v4</code>, <code>loaders.gl v4</code> and <code>probe.gl v4</code>. These upgrades ensures that all dependencies also use the same ES module packaging and follow latest typescript standards. Since the new libraries are more strongly typed, some new warnings or errors may result from this upgrade, however we expect that developers will welcome the increased type safety.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="module-level-changes">Module-level changes<a href="#module-level-changes" class="hash-link" aria-label="Direct link to Module-level changes" title="Direct link to Module-level changes">​</a></h3>
<table><thead><tr><th><strong>Module</strong></th><th>v8 Description</th><th>v9 Replacement</th></tr></thead><tbody><tr><td><code>@luma.gl/core</code></td><td>The core module was re-exporting other modules.</td><td>Replace direct use of WebGL classes with <code>@luma.gl/core</code> device API. import directly from <code>@luma.gl/shadertools</code>.</td></tr><tr><td><code>@luma.gl/webgl</code></td><td>Exported WebGL classes meant for direct usage.</td><td>Now exports the WebGL backend for the <code>@luma.gl/core</code> module. <code>@luma.gl/webgl-legacy</code> now offers the legacy luma.gl v8 WebGL API.</td></tr><tr><td><code>@luma.gl/constants</code></td><td>Exported numeric OpenGL constants.</td><td>Do not use. The luma.gl v9 API uses strictly typed WebGPU-style strings instead of numeric constants.</td></tr><tr><td><code>@luma.gl/gltools</code></td><td>Contained WebGL context functionality.</td><td>Removed. WebGL context is now handled by the  <code>@luma.gl/webgl</code> <code>WebGLDevice</code> and  <code>@luma.gl/core</code> <code>CanvasContext</code> classes.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-modules">Core Modules<a href="#core-modules" class="hash-link" aria-label="Direct link to Core Modules" title="Direct link to Core Modules">​</a></h2>
<p><strong><code>@luma.gl/core</code></strong></p>
<ul>
<li>The core module is no longer an umbrella module that simply re-exports exports from other modules.</li>
<li>It now provides the abstract luma.gl <code>Device</code> API (for which <code>@luma.gl/webgpu</code> and <code>@luma.gl/webgl</code> provide backends).</li>
</ul>
<p><strong><code>@luma.gl/engine</code></strong></p>
<ul>
<li>The engine module is largely unchanged in that it provides the same classes as before.</li>
</ul>
<p><strong><code>@luma.gl/webgl</code></strong></p>
<ul>
<li>While the webgl module still contains the WebGL 2 classes, these classes can no longer be imported directly. Instead the application should use <code>Device</code> create methods (<code>device.createBuffer()</code>, <code>device.createTexture()</code> etc to create these ojects in a portable way).</li>
</ul>
<p><strong><code>@luma.gl/constants</code></strong> (INTERNAL)</p>
<ul>
<li>The constant module remains but is now considered an internal luma.gl module, and is no longer intended to be imported by applications.</li>
<li>In the external API, all WebGL-style numeric constants (<code>GL.</code> constants) have been replaced with strictly typed WebGPU style string constants.</li>
</ul>
<p><strong><code>@luma.gl/debug</code></strong> (REMOVED)</p>
<p>The debug module has been removed. Debug functionality is now built-in (and dynamically loaded when needed) so there is no longer a need to import a separate debug module.</p>
<p><strong><code>@luma.gl/experimental</code></strong></p>
<ul>
<li>Scene graph exports (<code>ModelNode</code>, <code>GroupNode</code>, <code>ScenegraphNode</code>) has been moved into <code>@luma.gl/engine</code>.</li>
<li>glTF exports have been moved to <code>@luma.gl/gltf</code>.</li>
</ul>
<p><strong><code>@luma.gl/gltools</code></strong> (removed, no longer needed, see <a href="/docs/upgrade-guide">Upgrade Guide</a>)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-upgrade-guide">Detailed Upgrade Guide<a href="#detailed-upgrade-guide" class="hash-link" aria-label="Direct link to Detailed Upgrade Guide" title="Direct link to Detailed Upgrade Guide">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumaglengine"><code>@luma.gl/engine</code><a href="#lumaglengine" class="hash-link" aria-label="Direct link to lumaglengine" title="Direct link to lumaglengine">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="animationloop"><code>AnimationLoop</code><a href="#animationloop" class="hash-link" aria-label="Direct link to animationloop" title="Direct link to animationloop">​</a></h4>
<table><thead><tr><th>v8 Prop or Method</th><th>v9 Replacement</th><th>Comment</th></tr></thead><tbody><tr><td>Properties</td><td></td><td></td></tr><tr><td><code>props.gl</code></td><td><code>props.device</code></td><td>Now accepts a <code>Promise&lt;Device&gt;</code>.</td></tr><tr><td><code>props.glOptions</code></td><td><code>luma.createDevice(&lt;options&gt;)</code></td><td></td></tr><tr><td><code>props.createFramebuffer</code></td><td>N/A</td><td>You will need to create framebuffers explicitly.</td></tr><tr><td><code>props.debug</code></td><td><code>luma.createDevice({debug: true})</code></td><td>Device debug functionality is improved.</td></tr><tr><td>Methods</td><td></td><td></td></tr><tr><td><code>animationLoop.isContextLost()</code></td><td><code>device.lost</code>, <code>device.isLost()</code></td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumaglcore--lumaglwebgl"><code>luma.gl/core</code> / <code>@luma.gl/webgl</code><a href="#lumaglcore--lumaglwebgl" class="hash-link" aria-label="Direct link to lumaglcore--lumaglwebgl" title="Direct link to lumaglcore--lumaglwebgl">​</a></h3>
<p>The core module was re-exporting the webgl classes.</p>
<p>A long list of changes, some required to make the API portable between WebGPU and WebGL, and many to accommodate the limitations of the more locked-down WebGPU API.</p>
<table><thead><tr><th>v8</th><th>v9</th><th>Comment</th></tr></thead><tbody><tr><td><code>new Buffer(gl, props)</code></td><td><code>device.createBuffer(props)</code></td><td>WebGL classes such as <code>Buffer</code>, <code>Texture2D</code> etc can no longer be imported and instantiated with . Instead they must be created via a device methods.</td></tr><tr><td><code>Program</code></td><td><code>RenderPipeline</code></td><td>WebGPU alignment</td></tr></tbody></table>
<p><strong><code>@luma.gl/gltools</code></strong> (removed)</p>
<p>The WebGL context functions from <code>@luma.gl/gltools</code>(<code>createGLContext</code> etc), have been replaced by methods on to the new <code>Device</code> and <code>CanvasContext</code> classes.</p>
<p>The v8 luma.gl API was designed to allow apps to work directly with the <code>WebGLRenderingContext</code> object. v9 enables applications to work portably with both WebGPU and WebGL, and accordingly it wraps the WebGL context in a <code>Device</code> instance.</p>
<table><thead><tr><th>v8 Prop or Method</th><th>v9 Replacement</th><th>Comment</th></tr></thead><tbody><tr><td><code>WebGLRenderingContext</code></td><td><code>Device.gl</code></td><td>Contexts are created (or wrapped) by the <code>Device</code> class.</td></tr><tr><td><code>WebGL2RenderingContext</code></td><td><code>Device.gl</code></td><td>Contexts are created (or wrapped) by the <code>Device</code> class.</td></tr><tr><td><code>getWebGL2Context(gl)</code></td><td><code>device.gl2</code></td><td></td></tr><tr><td><code>assertWebGLContext(gl)</code></td><td>N/A</td><td>A device will always hold a valid WebGL context</td></tr><tr><td><code>assertWebGL2Context(gl)</code></td><td>N/A</td><td>Not needed. WebGL devices now always use WebGL2.</td></tr><tr><td></td><td></td><td></td></tr><tr><td><code>createGLContext()</code></td><td><code>luma.createDevice()</code></td><td>Will create a WebGL context if <code>WebGLDevice</code> is registered.</td></tr><tr><td><code>createGLContext({onContextLost})</code></td><td><code>device.lost</code></td><td><code>Promise</code> that lets the application <code>await</code> context loss.</td></tr><tr><td><code>instrumentGLContext()</code></td><td><code>WebGLDevice.attach(gl)</code></td><td>Contexts are now automatically instrumented.</td></tr><tr><td><code>polyfillGLContext()</code></td><td>N/A</td><td></td></tr><tr><td><code>hasFeature(feature)</code></td><td><code>device.features.has(feature)</code></td><td>Note: Feature names now defined by WebGPU style strings.</td></tr><tr><td><code>getFeatures()</code></td><td><code>Array.from(device.features)</code></td><td></td></tr><tr><td><code>getGLContextInfo(gl)</code></td><td><code>device.info</code></td><td>Returned object is keyed with strings instead of GL constants.</td></tr><tr><td><code>getContextLimits(gl)</code></td><td><code>device.limits</code></td><td>Returns &quot;WebGPU style&quot; limits instead of WebGL style enums</td></tr><tr><td></td><td></td><td></td></tr><tr><td><code>canvas</code></td><td><code>device.canvasContext.canvas</code></td><td></td></tr><tr><td><code>resizeGLContext(gl, options)</code></td><td><code>canvasContext.resize(options)</code></td><td>Same options: <code>{width, height, useDevicePixels}</code></td></tr><tr><td><code>getDevicePixelRatio()</code></td><td><code>canvasContext.getDevicePixelRatio()</code></td><td>Uses <code>useDevicePixels</code> prop on the <code>CanvasContext</code></td></tr><tr><td><code>setDevicePixelRatio()</code></td><td><code>canvasContext.setDevicePixelRatio()</code></td><td></td></tr><tr><td></td><td><code>canvasContext.getPixelSize()</code></td><td></td></tr><tr><td></td><td><code>canvasContext.getAspect()</code></td><td></td></tr><tr><td><code>cssToDeviceRatio()</code></td><td><code>canvasContext.cssToDeviceRatio()</code></td><td></td></tr><tr><td><code>cssToDevicePixels()</code></td><td><code>canvasContext.cssToDevicePixels()</code></td><td></td></tr><tr><td><code>hasFeature(gl, ...)</code></td><td><code>device.features.has(...)</code></td><td>See feature constant mapping below</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumaglconstants"><code>@luma.gl/constants</code><a href="#lumaglconstants" class="hash-link" aria-label="Direct link to lumaglconstants" title="Direct link to lumaglconstants">​</a></h3>
<table><thead><tr><th>v8 Prop or Method</th><th>v9 Replacement</th><th>Comment</th></tr></thead><tbody><tr><td><code>import GL from @luma.gl/constants</code></td><td><code>import {GL} from @luma.gl/constants</code></td><td>Changed to use a <em>named export</em> ( =&gt; ) for ES module compatibility.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lumagldebug"><code>@luma.gl/debug</code>**<a href="#lumagldebug" class="hash-link" aria-label="Direct link to lumagldebug" title="Direct link to lumagldebug">​</a></h3>
<table><thead><tr><th>v8 Prop or Method</th><th>v9 Replacement</th><th>Comment</th></tr></thead><tbody><tr><td><code>makeDebugContext()</code></td><td><code>luma.createDevice({debug: true, type: &#x27;webgl&#x27;})</code></td><td><a href="https://github.com/KhronosGroup/WebGLDeveloperTools" target="_blank" rel="noopener noreferrer">Khronos WebGL developer tools</a> are dynamically loaded when needed.</td></tr><tr><td>Spector.js</td><td><code>luma.createDevice({spector: true, type: &#x27;webgl&#x27;})</code></td><td><a href="https://spector.babylonjs.com/" target="_blank" rel="noopener noreferrer">Spector.js</a> is pre-integrated. Te Spector.js library will be dynamically loaded when needed and the canvas is &quot;captured&quot;.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="constant-upgrade-guide">Constant Upgrade Guide<a href="#constant-upgrade-guide" class="hash-link" aria-label="Direct link to Constant Upgrade Guide" title="Direct link to Constant Upgrade Guide">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="features">Features<a href="#features" class="hash-link" aria-label="Direct link to Features" title="Direct link to Features">​</a></h3>
<p>Feature constants have been changed to match the WebGPU API and will need to be updated. The strong typing in the luma.gl v9 API means that TypeScript will detect unsupported feature names which should make the conversion process less painful.</p>
<table><thead><tr><th>luma.gl v8 <code>FEATURE</code></th><th>v9 <code>DeviceFeature</code></th><th>Comments</th></tr></thead><tbody><tr><td><strong>General WebGL Features</strong></td><td></td><td></td></tr><tr><td><code>FEATURES.WEBGL2</code></td><td><code>webgl</code></td><td>True for WebGL Contexts</td></tr><tr><td><code>FEATURES.TIMER_QUERY</code></td><td><code>timer-query-webgl</code></td><td>[<code>Query</code>][/]ocs/api-reference/webgl/query) for asynchronous GPU timings</td></tr><tr><td><code>FEATURES.INSTANCED_RENDERING</code></td><td>N/A (always true)</td><td>Instanced rendering (via instanced vertex attributes)</td></tr><tr><td><code>FEATURES.VERTEX_ARRAY_OBJECT</code></td><td>N/A (always true)</td><td><code>VertexArrayObjects</code> can be created</td></tr><tr><td><code>FEATURES.ELEMENT_INDEX_UINT32</code></td><td>N/A (always true)</td><td>32 bit indices available for <code>GL.ELEMENT_ARRAY_BUFFER</code>s</td></tr><tr><td><code>FEATURES.BLEND_MINMAX</code></td><td>N/A (always true)</td><td><code>GL.MIN</code>, <code>GL.MAX</code> blending modes are available</td></tr><tr><td><code>FEATURES.FRAGMENT_SHADER_DRAW_BUFFERS</code></td><td>N/A (always true)</td><td>Fragment shader can draw to multiple render targets</td></tr><tr><td><code>FEATURES.FRAGMENT_SHADER_DEPTH</code></td><td>N/A (always true)</td><td>Fragment shader can control fragment depth value</td></tr><tr><td><code>FEATURES.SHADER_TEXTURE_LOD</code></td><td>N/A (always true)</td><td>Enables shader control of LOD</td></tr><tr><td><code>FEATURES.FRAGMENT_SHADER_DERIVATIVES</code></td><td>N/A (always true)</td><td>Derivative functions are available in GLSL</td></tr><tr><td><strong><code>Texture</code>s and <code>Framebuffer</code>s</strong></td><td></td><td></td></tr><tr><td><code>FEATURES.TEXTURE_FLOAT</code></td><td><code>texture-renerable-float32-webgl</code></td><td>Floating point textures can be created / set as samplers</td></tr><tr><td><code>FEATURES.TEXTURE_HALF_FLOAT</code></td><td><code>float16-renderable-webgl</code></td><td>Half float textures can be created and set as samplers</td></tr><tr><td><code>FEATURES.MULTIPLE_RENDER_TARGETS</code></td><td><code>multiple-renderable--webgl1</code></td><td><code>Framebuffer</code> multiple color attachments that fragment shaders can access</td></tr><tr><td><code>FEATURES.COLOR_ATTACHMENT_RGBA32F</code></td><td><code>rgba32float-renderable-webgl1</code></td><td>Floating point <code>Texture</code> in the <code>GL.RGBA32F</code> format are renderable &amp; readable</td></tr><tr><td><code>FEATURES.COLOR_ATTACHMENT_FLOAT</code></td><td><code>webgl1</code></td><td>Floating point <code>Texture</code>s renderable + readable.</td></tr><tr><td><code>FEATURES.COLOR_ATTACHMENT_HALF_FLOAT</code></td><td><code>webgl1</code></td><td>Half float format <code>Texture</code>s are renderable and readable</td></tr><tr><td><code>FEATURES.FLOAT_BLEND</code></td><td><code>texture-blend-float-webgl</code></td><td>Blending with 32-bit floating point color buffers</td></tr><tr><td><code>TEXTURE_FILTER_LINEAR_FLOAT</code></td><td><code>float32-filterable-linear-webgl1</code></td><td>Linear texture filtering for floating point textures</td></tr><tr><td><code>FEATURES.TEXTURE_FILTER_LINEAR_HALF_FLOAT</code></td><td><code>float16-filterable-linear-webgl1</code></td><td>Linear texture filtering for half float textures</td></tr><tr><td><code>FEATURES.TEXTURE_FILTER_ANISOTROPIC</code></td><td><code>texture-filterable-anisotropic-webgl</code></td><td>Anisotropic texture filtering</td></tr><tr><td><code>FEATURES.SRGB</code></td><td><code>texture-formats-srgb-webgl1</code></td><td>sRGB encoded rendering is available</td></tr><tr><td><code>FEATURES.TEXTURE_DEPTH_BUFFERS</code></td><td><code>texture-formats-depth-webgl1</code></td><td>Depth buffers can be stored in <code>Texture</code>s, e.g. for shadow map calculations</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gpu-parameters">GPU Parameters<a href="#gpu-parameters" class="hash-link" aria-label="Direct link to GPU Parameters" title="Direct link to GPU Parameters">​</a></h2>
<p>| setParameters | |  Parameters can no longer be set on the WebGL context. They must be set on a <code>RenderPipeline</code>. |
| setParameters ||  - <code>RenderPipeline</code> parameters cannot be changed after creation (though the <code>Model</code> class will create new <code>RenderPipeline</code> instances if parameters change).</p>
<ul>
<li>Some parameters are set on <code>RenderPass</code>.</li>
<li>Constant attributes are no longer supported.</li>
<li><code>clear</code> can no longer be called directly. Instead attachments are cleared when a <code>RenderPass</code> is created and clear colors must be specified in <code>beginRenderPass</code>.</li>
<li>Uniform buffers are required to run under WebGPU.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parameter-mapping">Parameter Mapping<a href="#parameter-mapping" class="hash-link" aria-label="Direct link to Parameter Mapping" title="Direct link to Parameter Mapping">​</a></h2>
<p>The following table shows mappings from luma v8 WebGL parameters to luma v9 WebGPU style parameters.</p>
<table><thead><tr><th>luma v8 / WebGL Parameter</th><th>v9 Parameter</th><th>Values</th><th>v9 Values</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/polygonOffset" target="_blank" rel="noopener noreferrer">polygonOffset</a></td><td><code>depthBias</code>, <code>depthBiasSlopeScale</code></td><td></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/depthRange" target="_blank" rel="noopener noreferrer">depthRange</a></td><td>N/A</td><td></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/clearDepth" target="_blank" rel="noopener noreferrer">clearDepth</a></td><td></td><td></td><td></td></tr><tr><td><strong>Rasterization Parameters</strong></td><td></td><td></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/cullFace" target="_blank" rel="noopener noreferrer"><code>cullFace</code></a></td><td><code>cullMode</code></td><td>Which face to cull</td><td><strong><code>&#x27;none&#x27;</code></strong>, <code>&#x27;front&#x27;</code>, <code>&#x27;back&#x27;</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/frontFace" target="_blank" rel="noopener noreferrer"><code>frontFace</code></a></td><td><code>frontFace</code></td><td>Which triangle winding order is front</td><td><strong><code>ccw</code></strong>, <code>cw</code></td></tr><tr><td><code>polygonOffset</code></td><td><code>depthBias</code></td><td>Small depth offset for polygons</td><td><code>float</code></td></tr><tr><td><code>polygonOffset</code></td><td><code>depthBiasSlopeScale</code></td><td>Small depth factor for polygons</td><td><code>float</code></td></tr><tr><td><code>polygonOffset</code></td><td><code>depthBiasClamp</code></td><td>Max depth offset for polygons</td><td><code>float</code></td></tr><tr><td><strong>Stencil Parameters</strong></td><td></td><td></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilMask" target="_blank" rel="noopener noreferrer"><code>stencilMask</code></a> / <code>GL.STENCIL_WRITEMASK</code></td><td><code>stencilReadMask</code></td><td>Binary mask for reading stencil values</td><td><code>number</code> (<strong><code>0xffffffff</code></strong>)</td></tr><tr><td><code>stencilFunc</code> / <code>GL.STENCIL_VALUE_MASK</code></td><td><code>stencilWriteMask</code></td><td>Binary mask for writing stencil values</td><td><code>number</code> (<strong><code>0xffffffff</code></strong>)</td></tr><tr><td><code>stencilFunc</code> / <code>GL.STENCIL_FUNC</code></td><td><code>stencilCompare</code></td><td>How the mask is compared</td><td><strong><code>always</code></strong>, <code>not-equal</code>, ...</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOp" target="_blank" rel="noopener noreferrer"><code>stencilOp</code></a> /  <code>GL.STENCIL_PASS_DEPTH_PASS</code></td><td><code>stencilPassOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOp" target="_blank" rel="noopener noreferrer"><code>stencilOp</code></a> / <code>GL.STENCIL_PASS_DEPTH_FAIL</code></td><td><code>stencilDepthFailOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOp" target="_blank" rel="noopener noreferrer"><code>stencilOp</code></a> / <code>GL.STENCIL_FAIL</code></td><td><code>stencilFailOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOpSeparate" target="_blank" rel="noopener noreferrer"><code>stencilOpSeparate</code></a></td><td>]</td><td>N/</td><td></td></tr></tbody></table>
<hr>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>TODO - this section needs updating</p></div></div>
<table><thead><tr><th>WebGL Function</th><th>WebGL Parameters</th><th>luma.gl v9 counterpart</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/clearStencil" target="_blank" rel="noopener noreferrer"><code>clearStencil</code></a></td><td><code>GL.STENCIL_CLEAR_VALUE</code></td><td></td></tr><tr><td></td><td>[]</td><td><code>stencilWriteMask</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilFunc" target="_blank" rel="noopener noreferrer"><code>stencilFunc</code></a></td><td>[<code>GL.STENCIL_FUNC</code>, <code>GL.STENCIL_REF</code>, <code>GL.STENCIL_VALUE_MASK</code>]</td><td><code>stencilCompare</code>, <code>stencilReadMask</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOp" target="_blank" rel="noopener noreferrer"><code>stencilOp</code></a></td><td><code>GL.STENCIL_FAIL</code>, `,</td><td><code>stencilPassOperation</code>, `stencilFailDepth</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOpSeparate" target="_blank" rel="noopener noreferrer"><code>stencilOpSeparate</code></a></td><td>[<code>GL.STENCIL_FAIL</code>, <code>GL.STENCIL_FAIL_DEPTH_FAIL</code>, <code>GL.STENCIL_FAIL_DEPTH_PASS</code>, <code>GL.STENCIL_BACK_FAIL</code>, <code>GL.STENCIL_BACK_FAIL_DEPTH_FAIL</code>, <code>GL.STENCIL_BACK_FAIL_DEPTH_PASS</code>]</td><td>N/A</td></tr><tr><td><code>GL.STENCIL_TEST</code></td><td><code>false</code></td><td>Enables stencil testing</td></tr><tr><td><code>GL.STENCIL_CLEAR_VALUE</code></td><td><code>0</code></td><td>Sets index used when stencil buffer is cleared.</td></tr><tr><td><code>GL.STENCIL_WRITEMASK</code></td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_BACK_WRITEMASK</code></td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_FUNC</code></td><td><code>GL.ALWAYS</code></td><td></td></tr><tr><td><code>GL.STENCIL_REF</code></td><td><code>0</code></td><td></td></tr><tr><td><code>GL.STENCIL_VALUE_MASK</code></td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask</td></tr><tr><td><code>GL.STENCIL_BACK_FUNC</code></td><td><code>GL.ALWAYS</code></td><td></td></tr><tr><td><code>GL.STENCIL_BACK_REF</code></td><td><code>0</code></td><td></td></tr><tr><td><code>GL.STENCIL_BACK_VALUE_MASK</code></td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_FAIL</code></td><td><code>GL.KEEP</code></td><td>stencil test fail action</td></tr><tr><td><code>GL.STENCIL_PASS_DEPTH_FAIL</code></td><td><code>GL.KEEP</code></td><td>depth test fail action</td></tr><tr><td><code>GL.STENCIL_PASS_DEPTH_PASS</code></td><td><code>GL.KEEP</code></td><td>depth test pass action</td></tr><tr><td><code>GL.STENCIL_BACK_FAIL</code></td><td><code>GL.KEEP</code></td><td>stencil test fail action, back</td></tr><tr><td><code>GL.STENCIL_BACK_PASS_DEPTH_FAIL</code></td><td><code>GL.KEEP</code></td><td>depth test fail action, back</td></tr><tr><td><code>GL.STENCIL_BACK_PASS_DEPTH_PASS</code></td><td><code>GL.KEEP</code></td><td>depth test pass action, back</td></tr><tr><td><strong>Blending</strong></td><td></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendColor" target="_blank" rel="noopener noreferrer">blendColor</a></td><td><code>GL.BLEND_COLOR</code></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendEquation" target="_blank" rel="noopener noreferrer">blendEquation</a></td><td>[<code>GL.BLEND_EQUATION_RGB</code>, <code>GL.BLEND_EQUATION_ALPHA</code>]</td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFunc" target="_blank" rel="noopener noreferrer">blendFunc</a></td><td>[<code>GL.BLEND_SRC_RGB</code>, <code>GL.BLEND_SRC_ALPHA</code>]</td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFuncSeparate" target="_blank" rel="noopener noreferrer">blendFuncSeparate</a></td><td>[<code>GL.BLEND_SRC_RGB</code>, <code>GL.BLEND_SRC_ALPHA</code>, <code>GL.BLEND_DST_RGB</code>, <code>GL.BLEND_DST_ALPHA</code>]</td><td></td></tr><tr><td><code>GL.BLEND</code></td><td>GLboolean</td><td><code>false</code></td></tr><tr><td><code>GL.BLEND_COLOR</code></td><td>Float32Array(4)</td><td><code>[0, 0, 0, 0]</code></td></tr><tr><td><code>GL.BLEND_EQUATION_RGB</code></td><td>GLenum</td><td><code>GL.FUNC_ADD</code></td></tr><tr><td><code>GL.BLEND_EQUATION_ALPHA</code></td><td>GLenum</td><td><code>GL.FUNC_ADD</code></td></tr><tr><td><code>GL.BLEND_SRC_RGB</code></td><td>GLenum</td><td><code>GL.ONE</code></td></tr><tr><td><code>GL.BLEND_SRC_ALPHA</code></td><td>GLenum</td><td><code>GL.ZERO</code></td></tr><tr><td><code>GL.BLEND_DST_RGB</code></td><td>GLenum</td><td><code>GL.ONE</code></td></tr><tr><td><code>GL.BLEND_DST_ALPHA</code></td><td>GLenum</td><td><code>GL.ZERO</code></td></tr></tbody></table>
<ul>
<li><strong>Depth Bias</strong> - Sometimes referred to as &quot;polygon offset&quot;. Adds small offset to fragment depth values (by factor × DZ + r × units). Usually used as a heuristic to avoid z-fighting, but can also be used for effects like applying decals to surfaces, and for rendering solids with highlighted edges. The semantics of polygon offsets are loosely specified by the WebGL standard and results can thus be driver dependent.</li>
</ul>
<p>After the fragment shader runs, optional stencil tests are performed, with resulting operations on the the stencil buffer.</p>
<table><thead><tr><th>V8/WebGL Function</th><th>Description</th><th>Values</th><th></th></tr></thead><tbody><tr><td><strong>Stencil Parameters</strong></td><td></td><td></td><td></td></tr><tr><td><code>stencilReadMask</code></td><td>Binary mask for reading stencil values</td><td><code>number</code> (<strong><code>0xffffffff</code></strong>)</td><td></td></tr><tr><td><code>stencilWriteMask</code></td><td>Binary mask for writing stencil values</td><td><code>number</code> (<strong><code>0xffffffff</code></strong>)</td><td><code>gl.frontFace</code></td></tr><tr><td><code>stencilCompare</code></td><td>How the mask is compared</td><td><strong><code>always</code></strong>, <code>not-equal</code>, ...</td><td><code>gl.stencilFunc</code></td></tr><tr><td><code>stencilPassOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td><td><code>gl.stencilOp</code></td></tr><tr><td><code>stencilDepthFailOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td><td><code>gl.stencilOp</code></td></tr><tr><td><code>stencilFailOperation</code></td><td></td><td><strong><code>&#x27;keep&#x27;</code></strong></td><td><code>gl.stencilOp</code></td></tr></tbody></table>
<p>Action when the stencil test fails</p>
<ul>
<li>stencil test fail action,</li>
<li>depth test fail action,</li>
<li>pass action</li>
</ul>
<p>Remarks:</p>
<ul>
<li>By using binary masks, an 8 bit stencil buffer can effectively contain 8 separate masks or stencils</li>
<li>The luma.gl API currently does not support setting stencil operations separately for front and back faces.</li>
</ul>
<table><thead><tr><th>WebGL Function</th><th>WebGL Parameters</th><th>luma.gl v9 counterpart</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/clearStencil" target="_blank" rel="noopener noreferrer"><code>clearStencil</code></a></td><td><code>GL.STENCIL_CLEAR_VALUE</code></td><td></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilMask" target="_blank" rel="noopener noreferrer"><code>stencilMask</code></a></td><td>[<code>GL.STENCIL_WRITEMASK</code>]</td><td><code>stencilWriteMask</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilFunc" target="_blank" rel="noopener noreferrer"><code>stencilFunc</code></a></td><td>[<code>GL.STENCIL_FUNC</code>, <code>GL.STENCIL_REF</code>, <code>GL.STENCIL_VALUE_MASK</code>]</td><td><code>stencilCompare</code>, <code>stencilReadMask</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOp" target="_blank" rel="noopener noreferrer"><code>stencilOp</code></a></td><td><code>GL.STENCIL_FAIL</code>, <code>GL.STENCIL_PASS_DEPTH_FAIL</code>, <code>GL.STENCIL_PASS_DEPTH_PASS</code></td><td><code>stencilPassOperation</code>, `stencilFailDepth</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOpSeparate" target="_blank" rel="noopener noreferrer"><code>stencilOpSeparate</code></a></td><td>[<code>GL.STENCIL_FAIL</code>, <code>GL.STENCIL_FAIL_DEPTH_FAIL</code>, <code>GL.STENCIL_FAIL_DEPTH_PASS</code>] *</td><td>N/A</td></tr></tbody></table>
<p>* <code>GL.STENCIL_BACK_FAIL</code>, <code>GL.STENCIL_BACK_FAIL_DEPTH_FAIL</code>, <code>GL.STENCIL_BACK_FAIL_DEPTH_PASS</code></p>
<ul>
<li>
<p>In WebGL, setting any value will enable stencil testing (i.e. enable <code>GL.STENCIL_TEST</code>).</p>
</li>
<li>
<p>In WebGL, setting any value will enable stencil testing (i.e. enable <code>GL.STENCIL_TEST</code>).</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="clear-color">Clear Color<a href="#clear-color" class="hash-link" aria-label="Direct link to Clear Color" title="Direct link to Clear Color">​</a></h3>
<table><thead><tr><th>Function</th><th>Sets parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/clearColor" target="_blank" rel="noopener noreferrer">clearColor</a></td><td>GL.COLOR_CLEAR_VALUE</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.COLOR_CLEAR_VALUE</code></td><td>new Float32Array(4)</td><td>[0, 0, 0, 0]</td><td>.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="color-mask">Color Mask<a href="#color-mask" class="hash-link" aria-label="Direct link to Color Mask" title="Direct link to Color Mask">​</a></h3>
<table><thead><tr><th>Function</th><th>Sets parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/colorMask" target="_blank" rel="noopener noreferrer">colorMask</a></td><td>GL.COLOR_WRITEMASK</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.COLOR_WRITEMASK</code></td><td>[GLboolean, GLboolean, GLboolean, GLboolean]</td><td>[true, true, true, true]</td><td>.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dithering">Dithering<a href="#dithering" class="hash-link" aria-label="Direct link to Dithering" title="Direct link to Dithering">​</a></h3>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.DITHER</code></td><td>GLboolean</td><td><code>true</code></td><td>Enable dithering of color components before they get written to the color buffer</td></tr></tbody></table>
<ul>
<li>Note: Dithering is driver dependent and typically has a stronger effect when the color components have a lower number of bits.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="polygonoffset">PolygonOffset<a href="#polygonoffset" class="hash-link" aria-label="Direct link to PolygonOffset" title="Direct link to PolygonOffset">​</a></h3>
<p>Add small offset to fragment depth values (by factor × DZ + r × units)
Useful for rendering hidden-line images, for applying decals to surfaces,
and for rendering solids with highlighted edges.</p>
<table><thead><tr><th>Function</th><th>Sets parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/polygonOffset" target="_blank" rel="noopener noreferrer">polygonOffset</a></td><td>[GL.POLYGON_OFFSET_FACTOR, GL.POLYGON_OFFSET_UNITS]</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.POLYGON_OFFSET_FILL</code></td><td>GLboolean</td><td><code>false</code></td><td>.</td></tr><tr><td><code>GL.POLYGON_OFFSET_FACTOR</code></td><td>GLfloat</td><td><code>0</code></td><td>.</td></tr><tr><td><code>GL.POLYGON_OFFSET_UNITS</code></td><td>GLfloat</td><td><code>0</code></td><td>.</td></tr></tbody></table>
<ul>
<li>Note: The semantics of polygon offsets are loosely specified by the WebGL standard and results can thus be driver dependent.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rasterization-webgl-2">Rasterization (WebGL 2)<a href="#rasterization-webgl-2" class="hash-link" aria-label="Direct link to Rasterization (WebGL 2)" title="Direct link to Rasterization (WebGL 2)">​</a></h3>
<p>Primitives are discarded immediately before the rasterization stage, but after the optional transform feedback stage. <code>gl.clear()</code> commands are ignored.</p>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.RASTERIZER_DISCARD</code></td><td>GLboolean</td><td><code>false</code></td><td>Disable rasterization</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sampling">Sampling<a href="#sampling" class="hash-link" aria-label="Direct link to Sampling" title="Direct link to Sampling">​</a></h3>
<p>Specify multisample coverage parameters</p>
<table><thead><tr><th>Function</th><th>Sets parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/sampleCoverage" target="_blank" rel="noopener noreferrer">sampleCoverage</a></td><td>[<code>GL.SAMPLE_COVERAGE_VALUE</code>, <code>GL.SAMPLE_COVERAGE_INVERT</code>]</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL_SAMPLE_COVERAGE</code></td><td>GLboolean</td><td><code>false</code></td><td>Activates the computation of a temporary coverage value determined by the alpha value.</td></tr><tr><td><code>GL_SAMPLE_ALPHA_TO_COVERAGE</code></td><td>GLboolean</td><td><code>false</code></td><td>Activates ANDing the fragment&#x27;s coverage with the temporary coverage value</td></tr><tr><td><code>GL.SAMPLE_COVERAGE_VALUE</code></td><td>GLfloat</td><td>1.0</td><td></td></tr><tr><td><code>GL.SAMPLE_COVERAGE_INVERT</code></td><td>GLboolean</td><td><code>false</code></td><td></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scissor-test">Scissor Test<a href="#scissor-test" class="hash-link" aria-label="Direct link to Scissor Test" title="Direct link to Scissor Test">​</a></h3>
<p>Settings for scissor test and scissor box.</p>
<table><thead><tr><th>Function</th><th>Sets parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/scissor" target="_blank" rel="noopener noreferrer">scissor</a></td><td><code>GL.SCISSOR_BOX</code></td></tr><tr><td>scissorTest</td><td>GL.SCISSOR_TEST</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.SCISSOR_TEST</code></td><td>GLboolean</td><td><code>false</code></td><td></td></tr><tr><td><code>GL.SCISSOR_BOX</code></td><td>Int32Array(4)</td><td>[null, null, null, null]), // TBD</td><td></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="viewport">Viewport<a href="#viewport" class="hash-link" aria-label="Direct link to Viewport" title="Direct link to Viewport">​</a></h2>
<p>Specifies the transformation from normalized device coordinates to
window/framebuffer coordinates. The maximum supported value, is defined by the
<code>GL.MAX_VIEWPORT_DIMS</code> limit.</p>
<table><thead><tr><th>Function</th><th>Parameters</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/viewport" target="_blank" rel="noopener noreferrer">viewport</a></td><td><code>GL.VIEWPORT</code></td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.VIEWPORT</code></td><td>Int32Array(4)</td><td>[...] TBD</td><td>Viewport</td></tr></tbody></table>
<p>Example:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Set viewport to maximum supported size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maxViewport </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getLimits</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token constant" style="color:#36acaa">GL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">MAX_VIEWPORT_DIMS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  viewport</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> maxViewport</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> maxViewport</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remarks">Remarks<a href="#remarks" class="hash-link" aria-label="Direct link to Remarks" title="Direct link to Remarks">​</a></h2>
<p>GPU State Management can be quite complicated.</p>
<ul>
<li>A large part of the WebGL API is devoted to parameters. When reading, querying individual values using GL constants is the norm, and when writing, special purpose functions are provided for most parameters. luma.gl supports both forms for both reading and writing parameters.</li>
<li>Reading values from WebGL can be very slow if it requires a GPU roundtrip. To get around this, luma.gl reads values once, caches them and tracks them as they are changed through luma functions. The cached values can get out of sync if the context is shared outside of luma.gl.</li>
<li>luma.gl&#x27;s state management enables &quot;conflict-free&quot; programming, so that even when setting global state, one part of the code does not need to worry about whether other parts are changing the global state.</li>
<li>Note that to fully support the conflict-free model and detect changes done e.g. in other WebGL libraries, luma.gl needs to hook into the WebGL context to track state changes.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="depth-testing-1">Depth testing<a href="#depth-testing-1" class="hash-link" aria-label="Direct link to Depth testing" title="Direct link to Depth testing">​</a></h2>
<p>To set up depth testing</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setParameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depthWriteEnabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depthCompare</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;less-equal&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.STENCIL_TEST</code></td><td>GLboolean</td><td><code>false</code></td><td>Enables stencil testing</td></tr><tr><td><code>GL.STENCIL_CLEAR_VALUE</code></td><td>GLint</td><td><code>0</code></td><td>Sets index used when stencil buffer is cleared.</td></tr><tr><td><code>GL.STENCIL_WRITEMASK</code></td><td>GLuint</td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_BACK_WRITEMASK</code></td><td>GLuint</td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_FUNC</code></td><td>GLenum</td><td><code>GL.ALWAYS</code></td><td></td></tr><tr><td><code>GL.STENCIL_REF</code></td><td>GLint</td><td><code>0</code></td><td></td></tr><tr><td><code>GL.STENCIL_VALUE_MASK</code></td><td>GLuint</td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask</td></tr><tr><td><code>GL.STENCIL_BACK_FUNC</code></td><td>GLenum</td><td><code>GL.ALWAYS</code></td><td></td></tr><tr><td><code>GL.STENCIL_BACK_REF</code></td><td>GLint</td><td><code>0</code></td><td></td></tr><tr><td><code>GL.STENCIL_BACK_VALUE_MASK</code></td><td>GLuint</td><td><code>0xFFFFFFFF</code></td><td>Sets bit mask enabling writing of individual bits in the stencil planes</td></tr><tr><td><code>GL.STENCIL_FAIL</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>stencil test fail action</td></tr><tr><td><code>GL.STENCIL_PASS_DEPTH_FAIL</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>depth test fail action</td></tr><tr><td><code>GL.STENCIL_PASS_DEPTH_PASS</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>depth test pass action</td></tr><tr><td><code>GL.STENCIL_BACK_FAIL</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>stencil test fail action, back</td></tr><tr><td><code>GL.STENCIL_BACK_PASS_DEPTH_FAIL</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>depth test fail action, back</td></tr><tr><td><code>GL.STENCIL_BACK_PASS_DEPTH_PASS</code></td><td>GLenum</td><td><code>GL.KEEP</code></td><td>depth test pass action, back</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="blending">Blending<a href="#blending" class="hash-link" aria-label="Direct link to Blending" title="Direct link to Blending">​</a></h3>
<table><thead><tr><th>Function style</th><th>Sets parameter(s)</th></tr></thead><tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendColor" target="_blank" rel="noopener noreferrer">blendColor</a></td><td><code>GL.BLEND_COLOR</code></td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendEquation" target="_blank" rel="noopener noreferrer">blendEquation</a></td><td>[<code>GL.BLEND_EQUATION_RGB</code>, <code>GL.BLEND_EQUATION_ALPHA</code>]</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFunc" target="_blank" rel="noopener noreferrer">blendFunc</a></td><td>[<code>GL.BLEND_SRC_RGB</code>, <code>GL.BLEND_SRC_ALPHA</code>]</td></tr><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendFuncSeparate" target="_blank" rel="noopener noreferrer">blendFuncSeparate</a></td><td>[<code>GL.BLEND_SRC_RGB</code>, <code>GL.BLEND_SRC_ALPHA</code>, <code>GL.BLEND_DST_RGB</code>, <code>GL.BLEND_DST_ALPHA</code>]</td></tr></tbody></table>
<table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>GL.BLEND</code></td><td>GLboolean</td><td><code>false</code></td><td>Blending enabled</td></tr><tr><td><code>GL.BLEND_COLOR</code></td><td>Float32Array(4)</td><td><code>[0, 0, 0, 0]</code></td><td></td></tr><tr><td><code>GL.BLEND_EQUATION_RGB</code></td><td>GLenum</td><td><code>GL.FUNC_ADD</code></td><td></td></tr><tr><td><code>GL.BLEND_EQUATION_ALPHA</code></td><td>GLenum</td><td><code>GL.FUNC_ADD</code></td><td></td></tr><tr><td><code>GL.BLEND_SRC_RGB</code></td><td>GLenum</td><td><code>GL.ONE</code></td><td>srcRgb</td></tr><tr><td><code>GL.BLEND_SRC_ALPHA</code></td><td>GLenum</td><td><code>GL.ZERO</code></td><td>srcAlpha</td></tr><tr><td><code>GL.BLEND_DST_RGB</code></td><td>GLenum</td><td><code>GL.ONE</code></td><td>dstRgb</td></tr><tr><td><code>GL.BLEND_DST_ALPHA</code></td><td>GLenum</td><td><code>GL.ZERO</code></td><td>dstAlpha</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/visgl/luma.gl/tree/main/docs/../docs/legacy/porting-guide.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developer-guide/contributing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Contributing</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/legacy/legacy-upgrade-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Legacy Upgrade Guide</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#v9-api-design-background" class="table-of-contents__link toc-highlight">v9 API Design background</a><ul><li><a href="#why-is-the-v9-api-a-major-breaking-change" class="table-of-contents__link toc-highlight">Why is the v9 API a major breaking change?</a></li></ul></li><li><a href="#effort-estimation" class="table-of-contents__link toc-highlight">Effort Estimation</a></li><li><a href="#quick-v9-api-overview" class="table-of-contents__link toc-highlight">Quick v9 API overview</a></li><li><a href="#porting-strategy" class="table-of-contents__link toc-highlight">Porting Strategy</a><ul><li><a href="#step-1-update-imports" class="table-of-contents__link toc-highlight">Step 1: Update Imports</a></li><li><a href="#step-2-replace-webglrenderingcontext-with-device" class="table-of-contents__link toc-highlight">Step 2: Replace WebGLRenderingContext with Device</a></li><li><a href="#step-3-replace-canvas-manipulation-with-canvascontext" class="table-of-contents__link toc-highlight">Step 3: Replace canvas manipulation with CanvasContext</a></li><li><a href="#step-3-replace-parameter-names" class="table-of-contents__link toc-highlight">Step 3: Replace parameter names</a></li></ul></li><li><a href="#upgrading-gpu-parameters" class="table-of-contents__link toc-highlight">Upgrading GPU Parameters</a></li><li><a href="#depth-testing" class="table-of-contents__link toc-highlight">Depth testing</a></li><li><a href="#upgrading-to-v90" class="table-of-contents__link toc-highlight">Upgrading to v9.0</a><ul><li><a href="#removed-functionality" class="table-of-contents__link toc-highlight">Removed Functionality</a></li><li><a href="#non-api-changes" class="table-of-contents__link toc-highlight">Non-API changes</a></li><li><a href="#module-level-changes" class="table-of-contents__link toc-highlight">Module-level changes</a></li></ul></li><li><a href="#core-modules" class="table-of-contents__link toc-highlight">Core Modules</a></li><li><a href="#detailed-upgrade-guide" class="table-of-contents__link toc-highlight">Detailed Upgrade Guide</a><ul><li><a href="#lumaglengine" class="table-of-contents__link toc-highlight"><code>@luma.gl/engine</code></a></li><li><a href="#lumaglcore--lumaglwebgl" class="table-of-contents__link toc-highlight"><code>luma.gl/core</code> / <code>@luma.gl/webgl</code></a></li><li><a href="#lumaglconstants" class="table-of-contents__link toc-highlight"><code>@luma.gl/constants</code></a></li><li><a href="#lumagldebug" class="table-of-contents__link toc-highlight"><code>@luma.gl/debug</code>**</a></li></ul></li><li><a href="#constant-upgrade-guide" class="table-of-contents__link toc-highlight">Constant Upgrade Guide</a><ul><li><a href="#features" class="table-of-contents__link toc-highlight">Features</a></li></ul></li><li><a href="#gpu-parameters" class="table-of-contents__link toc-highlight">GPU Parameters</a></li><li><a href="#parameter-mapping" class="table-of-contents__link toc-highlight">Parameter Mapping</a><ul><li><a href="#clear-color" class="table-of-contents__link toc-highlight">Clear Color</a></li><li><a href="#color-mask" class="table-of-contents__link toc-highlight">Color Mask</a></li><li><a href="#dithering" class="table-of-contents__link toc-highlight">Dithering</a></li><li><a href="#polygonoffset" class="table-of-contents__link toc-highlight">PolygonOffset</a></li><li><a href="#rasterization-webgl-2" class="table-of-contents__link toc-highlight">Rasterization (WebGL 2)</a></li><li><a href="#sampling" class="table-of-contents__link toc-highlight">Sampling</a></li><li><a href="#scissor-test" class="table-of-contents__link toc-highlight">Scissor Test</a></li></ul></li><li><a href="#viewport" class="table-of-contents__link toc-highlight">Viewport</a></li><li><a href="#remarks" class="table-of-contents__link toc-highlight">Remarks</a></li><li><a href="#depth-testing-1" class="table-of-contents__link toc-highlight">Depth testing</a><ul><li><a href="#blending" class="table-of-contents__link toc-highlight">Blending</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/../docs">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/deckgl/shared_invite/zt-7oeoqie8-NQqzSp5SLTFMDeNSPxi7eg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack workspace<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/vis-gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">vis.gl blog (Medium)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/visgl/luma.gl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OpenJS Foundation</div></div></div></footer></div>
</body>
</html>