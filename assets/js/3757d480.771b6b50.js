/*! For license information please see 3757d480.771b6b50.js.LICENSE.txt */
"use strict";(self.webpackChunkwebsite_docusaurus=self.webpackChunkwebsite_docusaurus||[]).push([[5441],{9647:(e,t,r)=>{r.d(t,{M:()=>_,P:()=>o});var n=r(8862);const s={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},i={f32:4,f16:2,i32:4,u32:4};var a=r(8337);function o(e,t){const r={};for(const n of e.attributes){const s=l(e,t,n.name);s&&(r[n.name]=s)}return r}function _(e,t,r){void 0===r&&(r=16);const n=o(e,t),s=new Array(r).fill(null);for(const i of Object.values(n))s[i.location]=i;return s}function l(e,t,r){const o=function(e,t){const r=e.attributes.find((e=>e.name===t));r||n.R.warn(`shader layout attribute "${t}" not present in shader`);return r||null}(e,r),_=function(e,t){E(e);let r=function(e,t){for(const r of e)if(r.format&&r.name===t)return{attributeName:r.name,bufferName:t,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}(e,t);if(r)return r;if(r=function(e,t){for(const r of e){let e=r.byteStride;if("number"!=typeof r.byteStride)for(const t of r.attributes||[]){e+=(0,a.w)(t.format).byteLength}const n=r.attributes?.find((e=>e.attribute===t));if(n)return{attributeName:n.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:n.format,byteOffset:n.byteOffset,byteStride:e}}return null}(e,t),r)return r;return n.R.warn(`layout for attribute "${t}" not present in buffer layout`),null}(t,r);if(!o)return null;const l=function(e){const[t,r]=s[e],n="i32"===t||"u32"===t,a="u32"!==t,o=i[t]*r,_=function(e,t){let r;switch(e){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?r:`${r}x${t}`}(t,r);return{dataType:t,components:r,defaultVertexFormat:_,byteLength:o,integer:n,signed:a}}(o.type),c=_?.vertexFormat||l.defaultVertexFormat,d=(0,a.w)(c);return{attributeName:_?.attributeName||o.name,bufferName:_?.bufferName||o.name,location:o.location,shaderType:o.type,shaderDataType:l.dataType,shaderComponents:l.components,vertexFormat:c,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:l.integer,stepMode:_?.stepMode||o.stepMode||"vertex",byteOffset:_?.byteOffset||0,byteStride:_?.byteStride||0}}function E(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&n.R.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}},8564:(e,t,r)=>{r.d(t,{h:()=>s});var n=r(8314);class s extends n.F{static defaultProps={...n.F.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}constructor(e,t){const r={...t};(t.usage||0)&s.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?r.indexType="uint32":t.data instanceof Uint16Array&&(r.indexType="uint16")),delete r.data,super(e,r,s.defaultProps),this.usage=r.usage||0,this.indexType=r.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,t){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=(()=>new ArrayBuffer(0))();_setDebugData(e,t,r){const n=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:r,s.DEBUG_DATA_MAX_LENGTH);null===n?this.debugData=new ArrayBuffer(i):0===t&&r===n.byteLength?this.debugData=n.slice(0,i):this.debugData=n.slice(t,t+i)}}},5128:(e,t,r)=>{r.d(t,{C:()=>s});var n=r(8314);class s extends n.F{static defaultProps=(()=>({...n.F.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}))();get[Symbol.toStringTag](){return"ComputePipeline"}hash="";constructor(e,t){super(e,t,s.defaultProps),this.shaderLayout=t.shaderLayout}}},9853:(e,t,r)=>{r.d(t,{r:()=>s});var n=r(8314);class s extends n.F{static defaultProps={...n.F.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}linkStatus="pending";hash="";constructor(e,t){super(e,t,s.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}},8314:(e,t,r)=>{r.d(t,{F:()=>s});var n=r(1010);class s{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}userData={};destroyed=!1;allocatedBytes=0;_attachedResources=(()=>new Set)();constructor(e,t,r){if(!e)throw new Error("no device");this._device=e,this.props=function(e,t){const r={...t};for(const n in e)void 0!==e[n]&&(r[n]=e[n]);return r}(t,r);const s="undefined"!==this.props.id?this.props.id:(0,n.L)(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t){void 0===t&&(t=this[Symbol.toStringTag]);const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e){void 0===e&&(e=this[Symbol.toStringTag]);const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}}},9532:(e,t,r)=>{r.d(t,{L:()=>s});var n=r(8314);class s extends n.F{static defaultProps={...n.F.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=s.normalizeProps(e,t),s.defaultProps)}static normalizeProps(e,t){return{...t,...e?.props?._resourceDefaults?.sampler||{}}}}},349:(e,t,r)=>{r.d(t,{M:()=>o});var n=r(8314),s=r(1010);function i(e,t,r,n){if(n?.inlineSource){const n=function(e,t,r){let n="";for(let s=t-2;s<=t;s++){const i=e[s-1];void 0!==i&&(n+=a(i,t,r))}return n}(t,r);return`\n${n}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const s="error"===e.type?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${s};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function a(e,t,r){const n=r?.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return`${function(e,t){let r="";for(let n=e.length;n<t;++n)r+=" ";return r+e}(String(t),4)}: ${n}${r?.html?"<br/>":"\n"}`}class o extends n.F{static defaultProps=(()=>({...n.F.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}))();get[Symbol.toStringTag](){return"Shader"}compilationStatus="pending";constructor(e,t){super(e,{id:_(t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),...t},o.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===t?.length||this._displayShaderLog(t)}_displayShaderLog(e){if("undefined"==typeof document||!document?.createElement)return;const t=l(this.source),r=`${this.stage} ${t}`;let n=function(e,t,r){let n="";const s=t.split(/\r?\n/),o=e.slice().sort(((e,t)=>e.lineNum-t.lineNum));switch(r?.showSourceCode||"no"){case"all":let t=0;for(let e=1;e<=s.length;e++)for(n+=a(s[e-1],e,r);o.length>t&&o[t].lineNum===e;){const e=o[t++];n+=i(e,s,e.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const a of e)n+=i(a,s,a.lineNum,{inlineSource:"no"!==r?.showSourceCode});return n}}(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(n+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const o=document.createElement("Button");o.innerHTML=`\n<h1>Shader Compilation Error in ${r}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${n}\n</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o);const _=document.getElementsByClassName("luma-compiler-log-error");_[0]?.scrollIntoView(),o.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}}function _(e){return l(e.source)||e.id||(0,s.L)(`unnamed ${e.stage}-shader`)}function l(e,t){void 0===t&&(t="unnamed");const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return r?r[1]:t}},1213:(e,t,r)=>{r.d(t,{X:()=>s});var n=r(8314);class s extends n.F{static defaultProps=(()=>({...n.F.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}))();get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,s.defaultProps)}}},5839:(e,t,r)=>{r.d(t,{g:()=>s});var n=r(8314);class s extends n.F{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps=(()=>({...n.F.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0}))();get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,t){if(super(e,t=s.normalizeProps(e,t),s.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,void 0===this.props.width||void 0===this.props.height){const e=s.getTextureDataSize(this.props.data);this.width=e?.width||1,this.height=e?.height||1}this.props.mipmaps&&void 0===this.props.mipLevels&&(this.props.mipLevels="pyramid"),this.mipLevels="pyramid"===this.props.mipLevels?s.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if("undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!=typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}static getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return s.getTextureDataSize(e[0]);if(s.isExternalImage(e))return s.getExternalImageSize(e);if(e&&"object"==typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,t){let r;return r=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],r}static getMipLevelCount(e,t){return Math.floor(Math.log2(Math.max(e,t)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,t){const r={...t},n=e?.props?._resourceDefaults?.texture||{};Object.assign(r,n);const{width:s,height:i}=r;return"number"==typeof s&&(r.width=Math.max(1,Math.ceil(s))),"number"==typeof i&&(r.height=Math.max(1,Math.ceil(i))),r}}},6700:(e,t,r)=>{function n(e){const t=function(e){const t=i[e];return t}(s[e]),r=e.includes("norm"),n=!r&&!e.startsWith("float"),a=e.startsWith("s");return{dataType:s[e],byteLength:t,integer:n,signed:a,normalized:r}}r.d(t,{l:()=>n});const s={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},i={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4}},8337:(e,t,r)=>{r.d(t,{w:()=>s});var n=r(6700);function s(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[r,s]=e.split("x"),i=r,a=s?parseInt(s):1,o=(0,n.l)(i),_={type:i,components:a,byteLength:o.byteLength*a,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(_.webglOnly=!0),_}},8397:(e,t,r)=>{let n;function s(e){return(!n||n.byteLength<e)&&(n=new ArrayBuffer(e)),n}function i(e,t){return new e(s(e.BYTES_PER_ELEMENT*t),0,t)}r.d(t,{X:()=>i,o:()=>s})},8862:(e,t,r)=>{r.d(t,{R:()=>n});const n=new(r(5593).t)({id:"luma.gl"})},1010:(e,t,r)=>{r.d(t,{L:()=>s});const n={};function s(e){void 0===e&&(e="id"),n[e]=n[e]||1;return`${e}-${n[e]++}`}},147:(e,t,r)=>{r.d(t,{Dt:()=>i,Qj:()=>s});let n="";function s(e){n=e}async function i(e,t){const r=new Image;return r.crossOrigin=t?.crossOrigin||"anonymous",r.src=e.startsWith("http")?e:n+e,await r.decode(),t?await createImageBitmap(r,t):await createImageBitmap(r)}},8226:(e,t,r)=>{r.d(t,{xN:()=>rn,Xj:()=>an,dJ:()=>_n,yL:()=>on,R2:()=>nn,I$:()=>sn,fo:()=>hn,dw:()=>ln});var n=r(6540),s=r(5556),i=r.n(s);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}class o extends n.Component{static displayName="Base Icon";static propTypes=(()=>({height:i().string,width:i().string,viewBox:i().string,children:i().node,predefinedClassName:i().string,className:i().string}))();static defaultProps={height:null,width:null,viewBox:"0 0 64 64",predefinedClassName:"",className:""};render(){const{height:e,width:t,viewBox:r,style:s={},children:i,predefinedClassName:o,className:_,colors:l,totalColor:E,...c}=this.props,d=e,u=t||d;s.fill="currentColor";const h=Array.isArray(l)&&E&&((e,t)=>new Array(e).fill(1).reduce(((e,r,n)=>`${e}.cr${n+1} {fill:${t[n%t.length]};}`),""))(E,l);return n.createElement("svg",a({viewBox:r,width:u,height:d,style:s,className:`${o} ${_}`},c),h?n.createElement("style",{type:"text/css"},h):null,i)}}const _=e=>n.createElement(o,e,n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.02167 13.7625C4.69623 13.4459 4.69623 12.9325 5.02167 12.6159L9.76574 8.00002L5.02167 3.38416C4.69623 3.06752 4.69623 2.55415 5.02167 2.2375C5.3471 1.92086 5.87474 1.92086 6.20018 2.2375L11.5335 7.42669C11.6898 7.57875 11.7776 7.78498 11.7776 8.00002C11.7776 8.21506 11.6898 8.4213 11.5335 8.57335L6.20018 13.7625C5.87474 14.0792 5.3471 14.0792 5.02167 13.7625Z"}));_.propTypes={height:i().string},_.defaultProps={height:"16px",viewBox:"0 0 17 16",predefinedClassName:"unfolded-icons-arrowbigright"};var l=r(4745),E=r(6769),c=r(6237);const d=new class{stats=(()=>new Map)();getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new c.A({id:e})),this.stats.get(e)}};var u=r(8862),h=r(1010),R=r(8564),T=r(6700);const A="texture-compression-bc",p="texture-compression-astc",S="texture-compression-etc2",f="texture-compression-pvrtc-webgl",g="texture-compression-atc-webgl",m="float32-renderable-webgl",C="float16-renderable-webgl",N="snorm8-renderable-webgl",I="norm16-renderable-webgl",b="snorm16-renderable-webgl",L="float32-filterable",F="float16-filterable-webgl";function P(e){const t=O[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const O={r8unorm:{},r8snorm:{render:N},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:N},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:C,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:I},"r16snorm-webgl":{f:b},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:N},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:C,filter:F},"rg16unorm-webgl":{render:I},"rg16snorm-webgl":{render:b},r32uint:{},r32sint:{},r32float:{render:m,filter:L},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:m},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:I},"rgb16snorm-webgl":{f:I},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:L},rgba16uint:{},rgba16sint:{},rgba16float:{render:C,filter:F},"rgba16unorm-webgl":{render:I},"rgba16snorm-webgl":{render:b},"rgb32float-webgl":{render:m,filter:L},rgba32uint:{},rgba32sint:{},rgba32float:{render:m,filter:L},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:A},"bc1-rgb-unorm-srgb-webgl":{f:A},"bc1-rgba-unorm":{f:A},"bc1-rgba-unorm-srgb":{f:A},"bc2-rgba-unorm":{f:A},"bc2-rgba-unorm-srgb":{f:A},"bc3-rgba-unorm":{f:A},"bc3-rgba-unorm-srgb":{f:A},"bc4-r-unorm":{f:A},"bc4-r-snorm":{f:A},"bc5-rg-unorm":{f:A},"bc5-rg-snorm":{f:A},"bc6h-rgb-ufloat":{f:A},"bc6h-rgb-float":{f:A},"bc7-rgba-unorm":{f:A},"bc7-rgba-unorm-srgb":{f:A},"etc2-rgb8unorm":{f:S},"etc2-rgb8unorm-srgb":{f:S},"etc2-rgb8a1unorm":{f:S},"etc2-rgb8a1unorm-srgb":{f:S},"etc2-rgba8unorm":{f:S},"etc2-rgba8unorm-srgb":{f:S},"eac-r11unorm":{f:S},"eac-r11snorm":{f:S},"eac-rg11unorm":{f:S},"eac-rg11snorm":{f:S},"astc-4x4-unorm":{f:p},"astc-4x4-unorm-srgb":{f:p},"astc-5x4-unorm":{f:p},"astc-5x4-unorm-srgb":{f:p},"astc-5x5-unorm":{f:p},"astc-5x5-unorm-srgb":{f:p},"astc-6x5-unorm":{f:p},"astc-6x5-unorm-srgb":{f:p},"astc-6x6-unorm":{f:p},"astc-6x6-unorm-srgb":{f:p},"astc-8x5-unorm":{f:p},"astc-8x5-unorm-srgb":{f:p},"astc-8x6-unorm":{f:p},"astc-8x6-unorm-srgb":{f:p},"astc-8x8-unorm":{f:p},"astc-8x8-unorm-srgb":{f:p},"astc-10x5-unorm":{f:p},"astc-10x5-unorm-srgb":{f:p},"astc-10x6-unorm":{f:p},"astc-10x6-unorm-srgb":{f:p},"astc-10x8-unorm":{f:p},"astc-10x8-unorm-srgb":{f:p},"astc-10x10-unorm":{f:p},"astc-10x10-unorm-srgb":{f:p},"astc-12x10-unorm":{f:p},"astc-12x10-unorm-srgb":{f:p},"astc-12x12-unorm":{f:p},"astc-12x12-unorm-srgb":{f:p},"pvrtc-rgb4unorm-webgl":{f:f},"pvrtc-rgba4unorm-webgl":{f:f},"pvrtc-rbg2unorm-webgl":{f:f},"pvrtc-rgba2unorm-webgl":{f:f},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:g},"atc-rgba-unorm-webgl":{f:g},"atc-rgbai-unorm-webgl":{f:g}},D=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],B=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function M(e){return D.some((t=>e.startsWith(t)))}function x(e){let t=function(e){const t=P(e),r=t.bytesPerPixel||1,n=t.bitsPerChannel||[8,8,8,8];delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store;const s={...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1};return s}(e);if(M(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const r=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,r]=t;return{blockWidth:Number(e),blockHeight:Number(r)}}return null}(e);r&&(t.blockWidth=r.blockWidth,t.blockHeight=r.blockHeight)}const r=B.exec(e);if(r){const[,n,s,i,a,o]=r,_=`${i}${s}`,l=(0,T.l)(_),E=8*l.byteLength,c=n.length,d=[E,c>=2?E:0,c>=3?E:0,c>=4?E:0];t={format:e,attachment:t.attachment,dataType:l.dataType,components:c,channels:n,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:d,bytesPerPixel:l.byteLength*n.length,packed:t.packed,srgb:t.srgb},"-webgl"===o&&(t.webgl=!0),"-srgb"===a&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}class U{}class G{constructor(e,t){void 0===e&&(e=[]),this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class v{static defaultProps=(()=>({id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>u.R.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:u.R.get("debug")||void 0,debugShaders:u.R.get("debug-shaders")||void 0,debugFramebuffers:Boolean(u.R.get("debug-framebuffers")),debugWebGL:Boolean(u.R.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0}))();get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...v.defaultProps,...e},this.id=this.props.id||(0,h.L)(this[Symbol.toStringTag].toLowerCase())}userData={};statsManager=(()=>d)();timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const t=function(e){const t=P(e),r={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},n=x(e),s=e.startsWith("depth")||e.startsWith("stencil"),i=n?.signed,a=n?.integer,o=n?.webgl;return r.render&&=!i,r.filter&&=!(s||i||a||o),r}(e),r=e=>("string"==typeof e?this.features.has(e):e)??!0,n=r(t.create),s={format:e,create:n,render:n&&r(t.render),filter:n&&r(t.filter),blend:n&&r(t.blend),store:n&&r(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(s)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return M(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e){throw void 0===e&&(e={}),new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&R.h.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":u.R.warn("indices buffer content must be of integer type")()),t}}const y=(0,E.B)()&&"undefined"!=typeof document,w="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class H{static defaultProps=(()=>({...v.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0}))();static pageLoaded=(()=>function(){if(y&&"complete"===document.readyState||"undefined"==typeof window)return Promise.resolve();return new Promise((e=>{window.addEventListener("load",(()=>e()))}))}().then((()=>{u.R.probe(2,"DOM is loaded")()})))();stats=(()=>d)();log=(()=>u.R)();VERSION=(()=>"undefined"!=typeof __VERSION__?__VERSION__:"running from source")();preregisteredAdapters=(()=>new Map)();constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw u.R.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),u.R.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");u.R.error("This version of luma.gl has already been initialized")()}u.R.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e){void 0===e&&(e=[]);const t=this.getAdapterMap(e);return Array.from(t).map((e=>{let[,t]=e;return t})).filter((e=>e.isSupported?.())).map((e=>e.type))}getBestAvailableAdapter(e){void 0===e&&(e=[]);const t=this.getAdapterMap(e);return t.get("webgpu")?.isSupported?.()?"webgpu":t.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(H.defaultProps,e)}async createDevice(e){void 0===e&&(e={}),(e={...H.defaultProps,...e}).waitForPageLoad&&await H.pageLoaded;const t=this.getAdapterMap(e.adapters);let r=e.type||"";"best-available"===r&&(r=this.getBestAvailableAdapter(e.adapters)||r);const n=(this.getAdapterMap(e.adapters)||t).get(r),s=await(n?.create?.(e));if(s)return s;throw new Error(w)}async attachDevice(e){const t=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await H.pageLoaded,null===e.handle&&(r="unknown");const n=t.get(r),s=await(n?.attach?.(null));if(s)return s;throw new Error(w)}enforceWebGL2(e,t){void 0===e&&(e=!0),void 0===t&&(t=[]);const r=this.getAdapterMap(t).get("webgl");r||u.R.warn("enforceWebGL2: webgl adapter not found")(),r?.enforceWebGL2?.(e)}getAdapterMap(e){void 0===e&&(e=[]);const t=new Map(this.preregisteredAdapters);for(const r of e)t.set(r.type,r);return t}registerDevices(e){u.R.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const e=t.adapter;e&&this.preregisteredAdapters.set(e.type,e)}}}const X=new H;class W{}var V=function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT",e}(V||{});const K={[V.BLEND]:!1,[V.BLEND_COLOR]:new Float32Array([0,0,0,0]),[V.BLEND_EQUATION_RGB]:V.FUNC_ADD,[V.BLEND_EQUATION_ALPHA]:V.FUNC_ADD,[V.BLEND_SRC_RGB]:V.ONE,[V.BLEND_DST_RGB]:V.ZERO,[V.BLEND_SRC_ALPHA]:V.ONE,[V.BLEND_DST_ALPHA]:V.ZERO,[V.COLOR_CLEAR_VALUE]:new Float32Array([0,0,0,0]),[V.COLOR_WRITEMASK]:[!0,!0,!0,!0],[V.CULL_FACE]:!1,[V.CULL_FACE_MODE]:V.BACK,[V.DEPTH_TEST]:!1,[V.DEPTH_CLEAR_VALUE]:1,[V.DEPTH_FUNC]:V.LESS,[V.DEPTH_RANGE]:new Float32Array([0,1]),[V.DEPTH_WRITEMASK]:!0,[V.DITHER]:!0,[V.CURRENT_PROGRAM]:null,[V.FRAMEBUFFER_BINDING]:null,[V.RENDERBUFFER_BINDING]:null,[V.VERTEX_ARRAY_BINDING]:null,[V.ARRAY_BUFFER_BINDING]:null,[V.FRONT_FACE]:V.CCW,[V.GENERATE_MIPMAP_HINT]:V.DONT_CARE,[V.LINE_WIDTH]:1,[V.POLYGON_OFFSET_FILL]:!1,[V.POLYGON_OFFSET_FACTOR]:0,[V.POLYGON_OFFSET_UNITS]:0,[V.SAMPLE_ALPHA_TO_COVERAGE]:!1,[V.SAMPLE_COVERAGE]:!1,[V.SAMPLE_COVERAGE_VALUE]:1,[V.SAMPLE_COVERAGE_INVERT]:!1,[V.SCISSOR_TEST]:!1,[V.SCISSOR_BOX]:new Int32Array([0,0,1024,1024]),[V.STENCIL_TEST]:!1,[V.STENCIL_CLEAR_VALUE]:0,[V.STENCIL_WRITEMASK]:4294967295,[V.STENCIL_BACK_WRITEMASK]:4294967295,[V.STENCIL_FUNC]:V.ALWAYS,[V.STENCIL_REF]:0,[V.STENCIL_VALUE_MASK]:4294967295,[V.STENCIL_BACK_FUNC]:V.ALWAYS,[V.STENCIL_BACK_REF]:0,[V.STENCIL_BACK_VALUE_MASK]:4294967295,[V.STENCIL_FAIL]:V.KEEP,[V.STENCIL_PASS_DEPTH_FAIL]:V.KEEP,[V.STENCIL_PASS_DEPTH_PASS]:V.KEEP,[V.STENCIL_BACK_FAIL]:V.KEEP,[V.STENCIL_BACK_PASS_DEPTH_FAIL]:V.KEEP,[V.STENCIL_BACK_PASS_DEPTH_PASS]:V.KEEP,[V.VIEWPORT]:[0,0,1024,1024],[V.TRANSFORM_FEEDBACK_BINDING]:null,[V.COPY_READ_BUFFER_BINDING]:null,[V.COPY_WRITE_BUFFER_BINDING]:null,[V.PIXEL_PACK_BUFFER_BINDING]:null,[V.PIXEL_UNPACK_BUFFER_BINDING]:null,[V.FRAGMENT_SHADER_DERIVATIVE_HINT]:V.DONT_CARE,[V.READ_FRAMEBUFFER_BINDING]:null,[V.RASTERIZER_DISCARD]:!1,[V.PACK_ALIGNMENT]:4,[V.UNPACK_ALIGNMENT]:4,[V.UNPACK_FLIP_Y_WEBGL]:!1,[V.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:!1,[V.UNPACK_COLORSPACE_CONVERSION_WEBGL]:V.BROWSER_DEFAULT_WEBGL,[V.PACK_ROW_LENGTH]:0,[V.PACK_SKIP_PIXELS]:0,[V.PACK_SKIP_ROWS]:0,[V.UNPACK_ROW_LENGTH]:0,[V.UNPACK_IMAGE_HEIGHT]:0,[V.UNPACK_SKIP_PIXELS]:0,[V.UNPACK_SKIP_ROWS]:0,[V.UNPACK_SKIP_IMAGES]:0},j=(e,t,r)=>t?e.enable(r):e.disable(r),Y=(e,t,r)=>e.hint(r,t),k=(e,t,r)=>e.pixelStorei(r,t),$=(e,t,r)=>{const n=r===V.FRAMEBUFFER_BINDING?V.DRAW_FRAMEBUFFER:V.READ_FRAMEBUFFER;return e.bindFramebuffer(n,t)},z=(e,t,r)=>{const n={[V.ARRAY_BUFFER_BINDING]:V.ARRAY_BUFFER,[V.COPY_READ_BUFFER_BINDING]:V.COPY_READ_BUFFER,[V.COPY_WRITE_BUFFER_BINDING]:V.COPY_WRITE_BUFFER,[V.PIXEL_PACK_BUFFER_BINDING]:V.PIXEL_PACK_BUFFER,[V.PIXEL_UNPACK_BUFFER_BINDING]:V.PIXEL_UNPACK_BUFFER}[r];e.bindBuffer(n,t)};function Q(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const Z={[V.BLEND]:j,[V.BLEND_COLOR]:(e,t)=>e.blendColor(...t),[V.BLEND_EQUATION_RGB]:"blendEquation",[V.BLEND_EQUATION_ALPHA]:"blendEquation",[V.BLEND_SRC_RGB]:"blendFunc",[V.BLEND_DST_RGB]:"blendFunc",[V.BLEND_SRC_ALPHA]:"blendFunc",[V.BLEND_DST_ALPHA]:"blendFunc",[V.COLOR_CLEAR_VALUE]:(e,t)=>e.clearColor(...t),[V.COLOR_WRITEMASK]:(e,t)=>e.colorMask(...t),[V.CULL_FACE]:j,[V.CULL_FACE_MODE]:(e,t)=>e.cullFace(t),[V.DEPTH_TEST]:j,[V.DEPTH_CLEAR_VALUE]:(e,t)=>e.clearDepth(t),[V.DEPTH_FUNC]:(e,t)=>e.depthFunc(t),[V.DEPTH_RANGE]:(e,t)=>e.depthRange(...t),[V.DEPTH_WRITEMASK]:(e,t)=>e.depthMask(t),[V.DITHER]:j,[V.FRAGMENT_SHADER_DERIVATIVE_HINT]:Y,[V.CURRENT_PROGRAM]:(e,t)=>e.useProgram(t),[V.RENDERBUFFER_BINDING]:(e,t)=>e.bindRenderbuffer(V.RENDERBUFFER,t),[V.TRANSFORM_FEEDBACK_BINDING]:(e,t)=>e.bindTransformFeedback?.(V.TRANSFORM_FEEDBACK,t),[V.VERTEX_ARRAY_BINDING]:(e,t)=>e.bindVertexArray(t),[V.FRAMEBUFFER_BINDING]:$,[V.READ_FRAMEBUFFER_BINDING]:$,[V.ARRAY_BUFFER_BINDING]:z,[V.COPY_READ_BUFFER_BINDING]:z,[V.COPY_WRITE_BUFFER_BINDING]:z,[V.PIXEL_PACK_BUFFER_BINDING]:z,[V.PIXEL_UNPACK_BUFFER_BINDING]:z,[V.FRONT_FACE]:(e,t)=>e.frontFace(t),[V.GENERATE_MIPMAP_HINT]:Y,[V.LINE_WIDTH]:(e,t)=>e.lineWidth(t),[V.POLYGON_OFFSET_FILL]:j,[V.POLYGON_OFFSET_FACTOR]:"polygonOffset",[V.POLYGON_OFFSET_UNITS]:"polygonOffset",[V.RASTERIZER_DISCARD]:j,[V.SAMPLE_ALPHA_TO_COVERAGE]:j,[V.SAMPLE_COVERAGE]:j,[V.SAMPLE_COVERAGE_VALUE]:"sampleCoverage",[V.SAMPLE_COVERAGE_INVERT]:"sampleCoverage",[V.SCISSOR_TEST]:j,[V.SCISSOR_BOX]:(e,t)=>e.scissor(...t),[V.STENCIL_TEST]:j,[V.STENCIL_CLEAR_VALUE]:(e,t)=>e.clearStencil(t),[V.STENCIL_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(V.FRONT,t),[V.STENCIL_BACK_WRITEMASK]:(e,t)=>e.stencilMaskSeparate(V.BACK,t),[V.STENCIL_FUNC]:"stencilFuncFront",[V.STENCIL_REF]:"stencilFuncFront",[V.STENCIL_VALUE_MASK]:"stencilFuncFront",[V.STENCIL_BACK_FUNC]:"stencilFuncBack",[V.STENCIL_BACK_REF]:"stencilFuncBack",[V.STENCIL_BACK_VALUE_MASK]:"stencilFuncBack",[V.STENCIL_FAIL]:"stencilOpFront",[V.STENCIL_PASS_DEPTH_FAIL]:"stencilOpFront",[V.STENCIL_PASS_DEPTH_PASS]:"stencilOpFront",[V.STENCIL_BACK_FAIL]:"stencilOpBack",[V.STENCIL_BACK_PASS_DEPTH_FAIL]:"stencilOpBack",[V.STENCIL_BACK_PASS_DEPTH_PASS]:"stencilOpBack",[V.VIEWPORT]:(e,t)=>e.viewport(...t),[V.DEPTH_CLAMP_EXT]:j,[V.POLYGON_OFFSET_LINE_WEBGL]:j,[V.CLIP_DISTANCE0_WEBGL]:j,[V.CLIP_DISTANCE1_WEBGL]:j,[V.CLIP_DISTANCE2_WEBGL]:j,[V.CLIP_DISTANCE3_WEBGL]:j,[V.CLIP_DISTANCE4_WEBGL]:j,[V.CLIP_DISTANCE5_WEBGL]:j,[V.CLIP_DISTANCE6_WEBGL]:j,[V.CLIP_DISTANCE7_WEBGL]:j,[V.PACK_ALIGNMENT]:k,[V.UNPACK_ALIGNMENT]:k,[V.UNPACK_FLIP_Y_WEBGL]:k,[V.UNPACK_PREMULTIPLY_ALPHA_WEBGL]:k,[V.UNPACK_COLORSPACE_CONVERSION_WEBGL]:k,[V.PACK_ROW_LENGTH]:k,[V.PACK_SKIP_PIXELS]:k,[V.PACK_SKIP_ROWS]:k,[V.UNPACK_ROW_LENGTH]:k,[V.UNPACK_IMAGE_HEIGHT]:k,[V.UNPACK_SKIP_PIXELS]:k,[V.UNPACK_SKIP_ROWS]:k,[V.UNPACK_SKIP_IMAGES]:k,framebuffer:(e,t)=>{const r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(V.FRAMEBUFFER,r)},blend:(e,t)=>t?e.enable(V.BLEND):e.disable(V.BLEND),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const r="number"==typeof t?[t,t]:t;e.blendEquationSeparate(...r)},blendFunc:(e,t)=>{const r=2===t?.length?[...t,...t]:t;e.blendFuncSeparate(...r)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(V.CULL_FACE):e.disable(V.CULL_FACE),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(V.DEPTH_TEST):e.disable(V.DEPTH_TEST),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(V.DITHER):e.disable(V.DITHER),derivativeHint:(e,t)=>{e.hint(V.FRAGMENT_SHADER_DERIVATIVE_HINT,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(V.GENERATE_MIPMAP_HINT,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(V.POLYGON_OFFSET_FILL):e.disable(V.POLYGON_OFFSET_FILL),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(V.SCISSOR_TEST):e.disable(V.SCISSOR_TEST),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(V.STENCIL_TEST):e.disable(V.STENCIL_TEST),stencilMask:(e,t)=>{t=Q(t)?t:[t,t];const[r,n]=t;e.stencilMaskSeparate(V.FRONT,r),e.stencilMaskSeparate(V.BACK,n)},stencilFunc:(e,t)=>{t=Q(t)&&3===t.length?[...t,...t]:t;const[r,n,s,i,a,o]=t;e.stencilFuncSeparate(V.FRONT,r,n,s),e.stencilFuncSeparate(V.BACK,i,a,o)},stencilOp:(e,t)=>{t=Q(t)&&3===t.length?[...t,...t]:t;const[r,n,s,i,a,o]=t;e.stencilOpSeparate(V.FRONT,r,n,s),e.stencilOpSeparate(V.BACK,i,a,o)},viewport:(e,t)=>e.viewport(...t)};function q(e,t,r){return void 0!==t[e]?t[e]:r[e]}const J={blendEquation:(e,t,r)=>e.blendEquationSeparate(q(V.BLEND_EQUATION_RGB,t,r),q(V.BLEND_EQUATION_ALPHA,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(q(V.BLEND_SRC_RGB,t,r),q(V.BLEND_DST_RGB,t,r),q(V.BLEND_SRC_ALPHA,t,r),q(V.BLEND_DST_ALPHA,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(q(V.POLYGON_OFFSET_FACTOR,t,r),q(V.POLYGON_OFFSET_UNITS,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(q(V.SAMPLE_COVERAGE_VALUE,t,r),q(V.SAMPLE_COVERAGE_INVERT,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(V.FRONT,q(V.STENCIL_FUNC,t,r),q(V.STENCIL_REF,t,r),q(V.STENCIL_VALUE_MASK,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(V.BACK,q(V.STENCIL_BACK_FUNC,t,r),q(V.STENCIL_BACK_REF,t,r),q(V.STENCIL_BACK_VALUE_MASK,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(V.FRONT,q(V.STENCIL_FAIL,t,r),q(V.STENCIL_PASS_DEPTH_FAIL,t,r),q(V.STENCIL_PASS_DEPTH_PASS,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(V.BACK,q(V.STENCIL_BACK_FAIL,t,r),q(V.STENCIL_BACK_PASS_DEPTH_FAIL,t,r),q(V.STENCIL_BACK_PASS_DEPTH_PASS,t,r))},ee={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),useProgram:(e,t)=>e({[V.CURRENT_PROGRAM]:t}),bindRenderbuffer:(e,t,r)=>e({[V.RENDERBUFFER_BINDING]:r}),bindTransformFeedback:(e,t,r)=>e({[V.TRANSFORM_FEEDBACK_BINDING]:r}),bindVertexArray:(e,t)=>e({[V.VERTEX_ARRAY_BINDING]:t}),bindFramebuffer:(e,t,r)=>{switch(t){case V.FRAMEBUFFER:return e({[V.DRAW_FRAMEBUFFER_BINDING]:r,[V.READ_FRAMEBUFFER_BINDING]:r});case V.DRAW_FRAMEBUFFER:return e({[V.DRAW_FRAMEBUFFER_BINDING]:r});case V.READ_FRAMEBUFFER:return e({[V.READ_FRAMEBUFFER_BINDING]:r});default:return null}},bindBuffer:(e,t,r)=>{const n={[V.ARRAY_BUFFER]:[V.ARRAY_BUFFER_BINDING],[V.COPY_READ_BUFFER]:[V.COPY_READ_BUFFER_BINDING],[V.COPY_WRITE_BUFFER]:[V.COPY_WRITE_BUFFER_BINDING],[V.PIXEL_PACK_BUFFER]:[V.PIXEL_PACK_BUFFER_BINDING],[V.PIXEL_UNPACK_BUFFER]:[V.PIXEL_UNPACK_BUFFER_BINDING]}[t];return n?e({[n]:r}):{valueChanged:!0}},blendColor:(e,t,r,n,s)=>e({[V.BLEND_COLOR]:new Float32Array([t,r,n,s])}),blendEquation:(e,t)=>e({[V.BLEND_EQUATION_RGB]:t,[V.BLEND_EQUATION_ALPHA]:t}),blendEquationSeparate:(e,t,r)=>e({[V.BLEND_EQUATION_RGB]:t,[V.BLEND_EQUATION_ALPHA]:r}),blendFunc:(e,t,r)=>e({[V.BLEND_SRC_RGB]:t,[V.BLEND_DST_RGB]:r,[V.BLEND_SRC_ALPHA]:t,[V.BLEND_DST_ALPHA]:r}),blendFuncSeparate:(e,t,r,n,s)=>e({[V.BLEND_SRC_RGB]:t,[V.BLEND_DST_RGB]:r,[V.BLEND_SRC_ALPHA]:n,[V.BLEND_DST_ALPHA]:s}),clearColor:(e,t,r,n,s)=>e({[V.COLOR_CLEAR_VALUE]:new Float32Array([t,r,n,s])}),clearDepth:(e,t)=>e({[V.DEPTH_CLEAR_VALUE]:t}),clearStencil:(e,t)=>e({[V.STENCIL_CLEAR_VALUE]:t}),colorMask:(e,t,r,n,s)=>e({[V.COLOR_WRITEMASK]:[t,r,n,s]}),cullFace:(e,t)=>e({[V.CULL_FACE_MODE]:t}),depthFunc:(e,t)=>e({[V.DEPTH_FUNC]:t}),depthRange:(e,t,r)=>e({[V.DEPTH_RANGE]:new Float32Array([t,r])}),depthMask:(e,t)=>e({[V.DEPTH_WRITEMASK]:t}),frontFace:(e,t)=>e({[V.FRONT_FACE]:t}),lineWidth:(e,t)=>e({[V.LINE_WIDTH]:t}),polygonOffset:(e,t,r)=>e({[V.POLYGON_OFFSET_FACTOR]:t,[V.POLYGON_OFFSET_UNITS]:r}),sampleCoverage:(e,t,r)=>e({[V.SAMPLE_COVERAGE_VALUE]:t,[V.SAMPLE_COVERAGE_INVERT]:r}),scissor:(e,t,r,n,s)=>e({[V.SCISSOR_BOX]:new Int32Array([t,r,n,s])}),stencilMask:(e,t)=>e({[V.STENCIL_WRITEMASK]:t,[V.STENCIL_BACK_WRITEMASK]:t}),stencilMaskSeparate:(e,t,r)=>e({[t===V.FRONT?V.STENCIL_WRITEMASK:V.STENCIL_BACK_WRITEMASK]:r}),stencilFunc:(e,t,r,n)=>e({[V.STENCIL_FUNC]:t,[V.STENCIL_REF]:r,[V.STENCIL_VALUE_MASK]:n,[V.STENCIL_BACK_FUNC]:t,[V.STENCIL_BACK_REF]:r,[V.STENCIL_BACK_VALUE_MASK]:n}),stencilFuncSeparate:(e,t,r,n,s)=>e({[t===V.FRONT?V.STENCIL_FUNC:V.STENCIL_BACK_FUNC]:r,[t===V.FRONT?V.STENCIL_REF:V.STENCIL_BACK_REF]:n,[t===V.FRONT?V.STENCIL_VALUE_MASK:V.STENCIL_BACK_VALUE_MASK]:s}),stencilOp:(e,t,r,n)=>e({[V.STENCIL_FAIL]:t,[V.STENCIL_PASS_DEPTH_FAIL]:r,[V.STENCIL_PASS_DEPTH_PASS]:n,[V.STENCIL_BACK_FAIL]:t,[V.STENCIL_BACK_PASS_DEPTH_FAIL]:r,[V.STENCIL_BACK_PASS_DEPTH_PASS]:n}),stencilOpSeparate:(e,t,r,n,s)=>e({[t===V.FRONT?V.STENCIL_FAIL:V.STENCIL_BACK_FAIL]:r,[t===V.FRONT?V.STENCIL_PASS_DEPTH_FAIL:V.STENCIL_BACK_PASS_DEPTH_FAIL]:n,[t===V.FRONT?V.STENCIL_PASS_DEPTH_PASS:V.STENCIL_BACK_PASS_DEPTH_PASS]:s}),viewport:(e,t,r,n,s)=>e({[V.VIEWPORT]:[t,r,n,s]})},te=(e,t)=>e.isEnabled(t),re={[V.BLEND]:te,[V.CULL_FACE]:te,[V.DEPTH_TEST]:te,[V.DITHER]:te,[V.POLYGON_OFFSET_FILL]:te,[V.SAMPLE_ALPHA_TO_COVERAGE]:te,[V.SAMPLE_COVERAGE]:te,[V.SCISSOR_TEST]:te,[V.STENCIL_TEST]:te,[V.RASTERIZER_DISCARD]:te},ne=new Set([V.ACTIVE_TEXTURE,V.TRANSFORM_FEEDBACK_ACTIVE,V.TRANSFORM_FEEDBACK_PAUSED,V.TRANSFORM_FEEDBACK_BUFFER_BINDING,V.UNIFORM_BUFFER_BINDING,V.ELEMENT_ARRAY_BUFFER_BINDING,V.IMPLEMENTATION_COLOR_READ_FORMAT,V.IMPLEMENTATION_COLOR_READ_TYPE,V.READ_BUFFER,V.DRAW_BUFFER0,V.DRAW_BUFFER1,V.DRAW_BUFFER2,V.DRAW_BUFFER3,V.DRAW_BUFFER4,V.DRAW_BUFFER5,V.DRAW_BUFFER6,V.DRAW_BUFFER7,V.DRAW_BUFFER8,V.DRAW_BUFFER9,V.DRAW_BUFFER10,V.DRAW_BUFFER11,V.DRAW_BUFFER12,V.DRAW_BUFFER13,V.DRAW_BUFFER14,V.DRAW_BUFFER15,V.SAMPLER_BINDING,V.TEXTURE_BINDING_2D,V.TEXTURE_BINDING_2D_ARRAY,V.TEXTURE_BINDING_3D,V.TEXTURE_BINDING_CUBE_MAP]);function se(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const r={};for(const s in t){const n=Number(s),i=Z[s];i&&("string"==typeof i?r[i]=!0:i(e,t[s],n))}const n=e.state&&e.state.cache;if(n)for(const s in r){(0,J[s])(e,t,n)}}function ie(e,t){if(void 0===t&&(t=K),"number"==typeof t){const r=t,n=re[r];return n?n(e,r):e.getParameter(r)}const r=Array.isArray(t)?t:Object.keys(t),n={};for(const s of r){const t=re[s];n[s]=t?t(e,Number(s)):e.getParameter(Number(s))}return n}function ae(e,t){if(e===t)return!0;const r=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&n&&e.length===t.length){for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}return!1}class oe{static get(e){return e.state}program=null;stateStack=[];enable=!0;cache=null;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e){void 0===e&&(e={}),this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];se(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?ie(e):Object.assign({},K),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(r){const n=oe.get(e);n.program!==r&&(t(r),n.program=r)}}(e);for(const r in ee){le(e,r,ee[r])}_e(e,"getParameter"),_e(e,"isEnabled")}_updateCache(e){let t,r=!1;const n=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const i=e[s],a=this.cache[s];ae(i,a)||(r=!0,t=a,n&&!(s in n)&&(n[s]=a),this.cache[s]=i)}return{valueChanged:r,oldValue:t}}}function _e(e,t){const r=e[t].bind(e);e[t]=function(t){if(void 0===t||ne.has(t))return r(t);const n=oe.get(e);return t in n.cache||(n.cache[t]=r(t)),n.enable?n.cache[t]:r(t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function le(e,t,r){if(!e[t])return;const n=e[t].bind(e);e[t]=function(){const t=oe.get(e);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];const{valueChanged:o,oldValue:_}=r(t._updateCache,...i);return o&&n(...i),_},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function Ee(e,t,r){return void 0===r[t]&&(r[t]=e.getExtension(t)||null),r[t]}function ce(e,t){const r=e.getParameter(V.VENDOR),n=e.getParameter(V.RENDERER);Ee(e,"WEBGL_debug_renderer_info",t);const s=t.WEBGL_debug_renderer_info,i=e.getParameter(s?s.UNMASKED_VENDOR_WEBGL:V.VENDOR)||r,a=e.getParameter(s?s.UNMASKED_RENDERER_WEBGL:V.RENDERER)||n,o=e.getParameter(V.VERSION),_=de(i,a),l=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(i,a),E=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(de(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(i,a);return{type:"webgl",gpu:_,gpuType:E,gpuBackend:l,vendor:i,renderer:a,version:o,shadingLanguage:"glsl",shadingLanguageVersion:300}}function de(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function ue(e){switch(e){case"uint8":case"unorm8":return V.UNSIGNED_BYTE;case"sint8":case"snorm8":return V.BYTE;case"uint16":case"unorm16":return V.UNSIGNED_SHORT;case"sint16":case"snorm16":return V.SHORT;case"uint32":return V.UNSIGNED_INT;case"sint32":return V.INT;case"float16":return V.HALF_FLOAT;case"float32":return V.FLOAT}throw new Error(String(e))}const he="WEBGL_compressed_texture_s3tc",Re="WEBGL_compressed_texture_s3tc_srgb",Te="EXT_texture_compression_rgtc",Ae="EXT_texture_compression_bptc",pe="EXT_texture_norm16",Se="EXT_render_snorm",fe={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Se],"norm16-renderable-webgl":[pe],"snorm16-renderable-webgl":[pe,Se],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[he,Re,Te,Ae],"texture-compression-bc5-webgl":[Te],"texture-compression-bc7-webgl":[Ae],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const ge={r8unorm:{gl:V.R8,rb:!0},r8snorm:{gl:V.R8_SNORM},r8uint:{gl:V.R8UI,rb:!0},r8sint:{gl:V.R8I,rb:!0},rg8unorm:{gl:V.RG8,rb:!0},rg8snorm:{gl:V.RG8_SNORM},rg8uint:{gl:V.RG8UI,rb:!0},rg8sint:{gl:V.RG8I,rb:!0},r16uint:{gl:V.R16UI,rb:!0},r16sint:{gl:V.R16I,rb:!0},r16float:{gl:V.R16F,rb:!0},"r16unorm-webgl":{gl:V.R16_EXT,rb:!0},"r16snorm-webgl":{gl:V.R16_SNORM_EXT},"rgba4unorm-webgl":{gl:V.RGBA4,rb:!0},"rgb565unorm-webgl":{gl:V.RGB565,rb:!0},"rgb5a1unorm-webgl":{gl:V.RGB5_A1,rb:!0},"rgb8unorm-webgl":{gl:V.RGB8},"rgb8snorm-webgl":{gl:V.RGB8_SNORM},rgba8unorm:{gl:V.RGBA8},"rgba8unorm-srgb":{gl:V.SRGB8_ALPHA8},rgba8snorm:{gl:V.RGBA8_SNORM},rgba8uint:{gl:V.RGBA8UI},rgba8sint:{gl:V.RGBA8I},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:V.RG16UI},rg16sint:{gl:V.RG16I},rg16float:{gl:V.RG16F,rb:!0},"rg16unorm-webgl":{gl:V.RG16_EXT},"rg16snorm-webgl":{gl:V.RG16_SNORM_EXT},r32uint:{gl:V.R32UI,rb:!0},r32sint:{gl:V.R32I,rb:!0},r32float:{gl:V.R32F},rgb9e5ufloat:{gl:V.RGB9_E5},rg11b10ufloat:{gl:V.R11F_G11F_B10F,rb:!0},rgb10a2unorm:{gl:V.RGB10_A2,rb:!0},"rgb10a2uint-webgl":{gl:V.RGB10_A2UI,rb:!0},"rgb16unorm-webgl":{gl:V.RGB16_EXT},"rgb16snorm-webgl":{gl:V.RGB16_SNORM_EXT},rg32uint:{gl:V.RG32UI,rb:!0},rg32sint:{gl:V.RG32I,rb:!0},rg32float:{gl:V.RG32F,rb:!0},rgba16uint:{gl:V.RGBA16UI,rb:!0},rgba16sint:{gl:V.RGBA16I,rb:!0},rgba16float:{gl:V.RGBA16F},"rgba16unorm-webgl":{gl:V.RGBA16_EXT,rb:!0},"rgba16snorm-webgl":{gl:V.RGBA16_SNORM_EXT},"rgb32float-webgl":{gl:V.RGB32F,x:"EXT_color_buffer_float",dataFormat:V.RGB,types:[V.FLOAT]},rgba32uint:{gl:V.RGBA32UI,rb:!0},rgba32sint:{gl:V.RGBA32I,rb:!0},rgba32float:{gl:V.RGBA32F,rb:!0},stencil8:{gl:V.STENCIL_INDEX8,rb:!0},depth16unorm:{gl:V.DEPTH_COMPONENT16,dataFormat:V.DEPTH_COMPONENT,types:[V.UNSIGNED_SHORT],rb:!0},depth24plus:{gl:V.DEPTH_COMPONENT24,dataFormat:V.DEPTH_COMPONENT,types:[V.UNSIGNED_INT]},depth32float:{gl:V.DEPTH_COMPONENT32F,dataFormat:V.DEPTH_COMPONENT,types:[V.FLOAT],rb:!0},"depth24plus-stencil8":{gl:V.DEPTH24_STENCIL8,rb:!0,depthTexture:!0,dataFormat:V.DEPTH_STENCIL,types:[V.UNSIGNED_INT_24_8]},"depth32float-stencil8":{gl:V.DEPTH32F_STENCIL8,dataFormat:V.DEPTH_STENCIL,types:[V.FLOAT_32_UNSIGNED_INT_24_8_REV],rb:!0},"bc1-rgb-unorm-webgl":{gl:V.COMPRESSED_RGB_S3TC_DXT1_EXT,x:he},"bc1-rgb-unorm-srgb-webgl":{gl:V.COMPRESSED_SRGB_S3TC_DXT1_EXT,x:Re},"bc1-rgba-unorm":{gl:V.COMPRESSED_RGBA_S3TC_DXT1_EXT,x:he},"bc1-rgba-unorm-srgb":{gl:V.COMPRESSED_SRGB_S3TC_DXT1_EXT,x:Re},"bc2-rgba-unorm":{gl:V.COMPRESSED_RGBA_S3TC_DXT3_EXT,x:he},"bc2-rgba-unorm-srgb":{gl:V.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,x:Re},"bc3-rgba-unorm":{gl:V.COMPRESSED_RGBA_S3TC_DXT5_EXT,x:he},"bc3-rgba-unorm-srgb":{gl:V.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,x:Re},"bc4-r-unorm":{gl:V.COMPRESSED_RED_RGTC1_EXT,x:Te},"bc4-r-snorm":{gl:V.COMPRESSED_SIGNED_RED_RGTC1_EXT,x:Te},"bc5-rg-unorm":{gl:V.COMPRESSED_RED_GREEN_RGTC2_EXT,x:Te},"bc5-rg-snorm":{gl:V.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT,x:Te},"bc6h-rgb-ufloat":{gl:V.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,x:Ae},"bc6h-rgb-float":{gl:V.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,x:Ae},"bc7-rgba-unorm":{gl:V.COMPRESSED_RGBA_BPTC_UNORM_EXT,x:Ae},"bc7-rgba-unorm-srgb":{gl:V.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT,x:Ae},"etc2-rgb8unorm":{gl:V.COMPRESSED_RGB8_ETC2},"etc2-rgb8unorm-srgb":{gl:V.COMPRESSED_SRGB8_ETC2},"etc2-rgb8a1unorm":{gl:V.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2},"etc2-rgb8a1unorm-srgb":{gl:V.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2},"etc2-rgba8unorm":{gl:V.COMPRESSED_RGBA8_ETC2_EAC},"etc2-rgba8unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC},"eac-r11unorm":{gl:V.COMPRESSED_R11_EAC},"eac-r11snorm":{gl:V.COMPRESSED_SIGNED_R11_EAC},"eac-rg11unorm":{gl:V.COMPRESSED_RG11_EAC},"eac-rg11snorm":{gl:V.COMPRESSED_SIGNED_RG11_EAC},"astc-4x4-unorm":{gl:V.COMPRESSED_RGBA_ASTC_4x4_KHR},"astc-4x4-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR},"astc-5x4-unorm":{gl:V.COMPRESSED_RGBA_ASTC_5x4_KHR},"astc-5x4-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR},"astc-5x5-unorm":{gl:V.COMPRESSED_RGBA_ASTC_5x5_KHR},"astc-5x5-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR},"astc-6x5-unorm":{gl:V.COMPRESSED_RGBA_ASTC_6x5_KHR},"astc-6x5-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR},"astc-6x6-unorm":{gl:V.COMPRESSED_RGBA_ASTC_6x6_KHR},"astc-6x6-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR},"astc-8x5-unorm":{gl:V.COMPRESSED_RGBA_ASTC_8x5_KHR},"astc-8x5-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR},"astc-8x6-unorm":{gl:V.COMPRESSED_RGBA_ASTC_8x6_KHR},"astc-8x6-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR},"astc-8x8-unorm":{gl:V.COMPRESSED_RGBA_ASTC_8x8_KHR},"astc-8x8-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR},"astc-10x5-unorm":{gl:V.COMPRESSED_RGBA_ASTC_10x10_KHR},"astc-10x5-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR},"astc-10x6-unorm":{gl:V.COMPRESSED_RGBA_ASTC_10x6_KHR},"astc-10x6-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR},"astc-10x8-unorm":{gl:V.COMPRESSED_RGBA_ASTC_10x8_KHR},"astc-10x8-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR},"astc-10x10-unorm":{gl:V.COMPRESSED_RGBA_ASTC_10x10_KHR},"astc-10x10-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR},"astc-12x10-unorm":{gl:V.COMPRESSED_RGBA_ASTC_12x10_KHR},"astc-12x10-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR},"astc-12x12-unorm":{gl:V.COMPRESSED_RGBA_ASTC_12x12_KHR},"astc-12x12-unorm-srgb":{gl:V.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR},"pvrtc-rgb4unorm-webgl":{gl:V.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc-rgba4unorm-webgl":{gl:V.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"pvrtc-rbg2unorm-webgl":{gl:V.COMPRESSED_RGB_PVRTC_2BPPV1_IMG},"pvrtc-rgba2unorm-webgl":{gl:V.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG},"etc1-rbg-unorm-webgl":{gl:V.COMPRESSED_RGB_ETC1_WEBGL},"atc-rgb-unorm-webgl":{gl:V.COMPRESSED_RGB_ATC_WEBGL},"atc-rgba-unorm-webgl":{gl:V.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL},"atc-rgbai-unorm-webgl":{gl:V.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL}};function me(e){const t=ge[e],r=function(e){const t=ge[e],r=t?.gl;if(void 0===r)throw new Error(`Unsupported texture format ${e}`);return r}(e),n=x(e);return{internalFormat:r,format:t?.dataFormat||Ce(n.channels,n.integer,n.normalized,r),type:n.dataType?ue(n.dataType):t?.types?.[0]||V.UNSIGNED_BYTE,compressed:n.compressed||!1}}function Ce(e,t,r,n){if(n===V.RGBA||n===V.RGB)return n;switch(e){case"r":return t&&!r?V.RED_INTEGER:V.RED;case"rg":return t&&!r?V.RG_INTEGER:V.RG;case"rgb":return t&&!r?V.RGB_INTEGER:V.RGB;case"rgba":return t&&!r?V.RGBA_INTEGER:V.RGBA;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return V.RGBA}}const Ne={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class Ie extends G{testedFeatures=(()=>new Set)();constructor(e,t,r){super([],r),this.gl=e,this.extensions=t,Ee(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures?.[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in fe}(e)&&function(e,t,r){return(fe[t]||[]).every((t=>Ee(e,t,r)))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter((e=>"polygon-mode-webgl"!==e));for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(Ne),...Object.keys(fe)]}getWebGLFeature(e){const t=Ne[e];return"string"==typeof t?Boolean(Ee(this.gl,t,this.extensions)):Boolean(t)}}class be extends U{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(V.MAX_TEXTURE_SIZE)}get maxTextureDimension3D(){return this.getParameter(V.MAX_3D_TEXTURE_SIZE)}get maxTextureArrayLayers(){return this.getParameter(V.MAX_ARRAY_TEXTURE_LAYERS)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(V.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}get maxSamplersPerShaderStage(){return this.getParameter(V.MAX_COMBINED_TEXTURE_IMAGE_UNITS)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(V.MAX_UNIFORM_BUFFER_BINDINGS)}get maxUniformBufferBindingSize(){return this.getParameter(V.MAX_UNIFORM_BLOCK_SIZE)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(V.UNIFORM_BUFFER_OFFSET_ALIGNMENT)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(V.MAX_VERTEX_ATTRIBS)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(V.MAX_VARYING_COMPONENTS)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}limits={};constructor(e){super(),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class Le{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};width=1;height=1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Le.defaultProps,...e},e=this.props,!(0,E.B)())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"==typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{const t=function(e){const{width:t,height:r}=e,n=document.createElement("canvas");return n.id=(0,h.L)("lumagl-auto-created-canvas"),n.width=t||1,n.height=r||1,n.style.width=Number.isFinite(t)?`${t}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}(e),r=function(e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}if(e)return e;return document.body}(e?.container||null);r.insertBefore(t,r.firstChild),this.canvas=t,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.canvas&&this.update()})),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!=typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!=typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),t=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return t?e/t:1}catch{return 1}}cssToDevicePixels(e,t){void 0===t&&(t=!0);const r=this.cssToDeviceRatio(),[n,s]=this.getDrawingBufferSize();return function(e,t,r,n,s){const i=e,a=Fe(i[0],t,r);let o=Pe(i[1],t,n,s),_=Fe(i[0]+1,t,r);const l=_===r-1?_:_-1;let E;_=Pe(i[1]+1,t,n,s),s?(_=0===_?_:_+1,E=o,o=_):E=_===n-1?_:_-1;return{x:a,y:o,width:Math.max(l-a+1,1),height:Math.max(E-o+1,1)}}(e,r,n,s,t)}setDevicePixelRatio(e,t){if(void 0===t&&(t={}),!this.htmlCanvas)return;let r="width"in t?t.width:this.htmlCanvas.clientWidth,n="height"in t?t.height:this.htmlCanvas.clientHeight;r&&n||(u.R.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,n=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==n||s.devicePixelRatio!==e){let t=e;const s=Math.floor(r*t),i=Math.floor(n*t);this.htmlCanvas.width=s,this.htmlCanvas.height=i;if(this.device.gl){const[a,o]=this.getDrawingBufferSize();a===s&&o===i||(t=Math.min(a/r,o/n),this.htmlCanvas.width=Math.floor(r*t),this.htmlCanvas.height=Math.floor(n*t),u.R.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=n,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=e)}}function Fe(e,t,r){return Math.min(Math.round(e*t),r-1)}function Pe(e,t,r,n){return n?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}var Oe=r(8314),De=r(5839);class Be extends Oe.F{static defaultProps={...Oe.F.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}constructor(e,t){void 0===t&&(t={}),super(e,t,Be.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map((t=>t.texture.clone(e))),r=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:r})}resize(e){let t=!e;if(e){const[r,n]=Array.isArray(e)?e:[e.width,e.height];t=t||n!==this.height||r!==this.width,this.width=r,this.height=n}t&&(u.R.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(((e,t)=>{if("string"==typeof e){const r=this.createColorTexture(e,t);return this.attachResource(r),r.view}return e instanceof De.g?e.view:e}));const e=this.props.depthStencilAttachment;if(e)if("string"==typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof De.g?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:De.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:De.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){for(let r=0;r<this.colorAttachments.length;++r)if(this.colorAttachments[r]){const n=this.colorAttachments[r].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[r]),this.colorAttachments[r]=n.view,this.attachResource(n.view)}if(this.depthStencilAttachment){const r=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=r.view,this.attachResource(r)}this.updateAttachments()}}class Me extends Be{colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const r=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||r?this.props.handle:this.gl.createFramebuffer(),r||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(V.FRAMEBUFFER,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const r=V.COLOR_ATTACHMENT0+t;this._attachTextureView(r,e)}}if(this.depthStencilAttachment){const e=function(e){switch(x(e).attachment){case"depth":return V.DEPTH_ATTACHMENT;case"stencil":return V.STENCIL_ATTACHMENT;case"depth-stencil":return V.DEPTH_STENCIL_ATTACHMENT;default:throw new Error(`Not a depth stencil format: ${e}`)}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(V.FRAMEBUFFER);if(e!==V.FRAMEBUFFER_COMPLETE)throw new Error(`Framebuffer ${function(e){switch(e){case V.FRAMEBUFFER_COMPLETE:return"success";case V.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"Mismatched attachments";case V.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"No attachments";case V.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"Height/width mismatch";case V.FRAMEBUFFER_UNSUPPORTED:return"Unsupported or split attachments";case V.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"Samples mismatch";default:return`${e}`}}(e)}`)}this.gl.bindFramebuffer(V.FRAMEBUFFER,e)}_attachTextureView(e,t){const{gl:r}=this.device,{texture:n}=t,s=t.props.baseMipLevel,i=t.props.baseArrayLayer;switch(r.bindTexture(n.glTarget,n.handle),n.glTarget){case V.TEXTURE_2D_ARRAY:case V.TEXTURE_3D:r.framebufferTextureLayer(V.FRAMEBUFFER,e,n.handle,s,i);break;case V.TEXTURE_CUBE_MAP:const t=function(e){return e<V.TEXTURE_CUBE_MAP_POSITIVE_X?e+V.TEXTURE_CUBE_MAP_POSITIVE_X:e}(i);r.framebufferTexture2D(V.FRAMEBUFFER,e,t,n.handle,s);break;case V.TEXTURE_2D:r.framebufferTexture2D(V.FRAMEBUFFER,e,V.TEXTURE_2D,n.handle,s);break;default:throw new Error("Illegal texture type")}r.bindTexture(n.glTarget,null)}}class xe extends Le{format="rgba8unorm";depthStencilFormat="depth24plus";_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Me(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl)if(this.canvas){const t=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(t,e)}else;}commit(){}}async function Ue(e,t){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",e),t&&(n.id=t),new Promise(((t,s)=>{n.onload=t,n.onerror=t=>s(new Error(`Unable to load script '${e}': ${t}`)),r.appendChild(n)}))}let Ge=null,ve=!1;const ye={debugSpectorJS:u.R.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};function we(e){return e.luma=e.luma||{},e.luma}function He(e,t){return void 0===t&&(t={}),t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return u.R.warn("webgl-debug not loaded")(),e;const r=we(e);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...V,...e});const n=globalThis.WebGLDebugUtils.makeDebugContext(e,We.bind(null,t),Ve.bind(null,t));for(const a in V)a in n||"number"!=typeof V[a]||(n[a]=V[a]);class s{}Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.setPrototypeOf(s,n);const i=Object.create(s);return r.realContext=e,r.debugContext=i,i.debug=!0,i}(e,t):function(e){const t=we(e);return t.realContext?t.realContext:e}(e)}function Xe(e,t){t=Array.from(t).map((e=>void 0===e?"undefined":e));let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${e}(${r})`}function We(e,t,r,n){n=Array.from(n).map((e=>void 0===e?"undefined":e));const s=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${r}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(r,n)})`;u.R.error(s)()}function Ve(e,t,r){let n="";u.R.level>=1&&(n=Xe(t,r),e.traceWebGL&&u.R.log(1,n)());for(const s of r)void 0===s&&(n=n||Xe(t,r))}const Ke={};function je(e){void 0===e&&(e="id"),Ke[e]=Ke[e]||1;return`${e}-${Ke[e]++}`}class Ye extends R.h{glIndexType=(()=>V.UNSIGNED_SHORT)();constructor(e,t){void 0===t&&(t={}),super(e,t),this.device=e,this.gl=this.device.gl;const r="object"==typeof t?t.handle:void 0;this.handle=r||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=function(e){if(e&R.h.INDEX)return V.ELEMENT_ARRAY_BUFFER;if(e&R.h.VERTEX)return V.ARRAY_BUFFER;if(e&R.h.UNIFORM)return V.UNIFORM_BUFFER;return V.ARRAY_BUFFER}(this.props.usage),this.glUsage=function(e){if(e&R.h.INDEX)return V.STATIC_DRAW;if(e&R.h.VERTEX)return V.STATIC_DRAW;if(e&R.h.UNIFORM)return V.DYNAMIC_DRAW;return V.STATIC_DRAW}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?V.UNSIGNED_INT:V.UNSIGNED_SHORT,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.byteLength+t);const n=this.glTarget;this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this.bytesUsed=r,this.byteLength=r,this._setDebugData(e,t,r),this.trackAllocatedMemory(r)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const r=this.glTarget;return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,t,this.glUsage),this.gl.bindBuffer(r,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,t){void 0===t&&(t=0);const r=V.COPY_WRITE_BUFFER;this.gl.bindBuffer(r,this.handle),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this._setDebugData(e,t,e.byteLength)}async readAsync(e,t){return void 0===e&&(e=0),this.readSyncWebGL(e,t)}readSyncWebGL(e,t){void 0===e&&(e=0),t=t??this.byteLength-e;const r=new Uint8Array(t);return this.gl.bindBuffer(V.COPY_READ_BUFFER,this.handle),this.gl.getBufferSubData(V.COPY_READ_BUFFER,e,r,0,t),this.gl.bindBuffer(V.COPY_READ_BUFFER,null),this._setDebugData(r,e,t),r}}var ke=r(349);function $e(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}class ze extends ke.M{constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(V.VERTEX_SHADER);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(V.FRAGMENT_SHADER);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then((()=>this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),r=[];for(const n of t){if(n.length<=1)continue;const e=n.split(":");if(2===e.length){const[t,n]=e;r.push({message:n.trim(),type:$e(t),lineNum:0,linePos:0});continue}const[t,s,i,...a]=e;let o=parseInt(i,10);isNaN(o)&&(o=0);let _=parseInt(s,10);isNaN(_)&&(_=0),r.push({message:a.join(":").trim(),type:$e(t),lineNum:o,linePos:_})}return r}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return e?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es\n${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))u.R.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),u.R.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,V.COMPLETION_STATUS_KHR))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,V.COMPILE_STATUS)?"success":"error"}}var Qe=r(9532);function Ze(e,t){const r=e,{gl:n}=r;if(t.cullMode)switch(t.cullMode){case"none":n.disable(V.CULL_FACE);break;case"front":n.enable(V.CULL_FACE),n.cullFace(V.FRONT);break;case"back":n.enable(V.CULL_FACE),n.cullFace(V.BACK)}if(t.frontFace&&n.frontFace(rt("frontFace",t.frontFace,{ccw:V.CCW,cw:V.CW})),t.unclippedDepth&&e.features.has("depth-clip-control")&&n.enable(V.DEPTH_CLAMP_EXT),void 0!==t.depthBias&&(n.enable(V.POLYGON_OFFSET_FILL),n.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,n=rt("provokingVertex",t.provokingVertex,{first:V.FIRST_VERTEX_CONVENTION_WEBGL,last:V.LAST_VERTEX_CONVENTION_WEBGL});e?.provokingVertexWEBGL(n)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,n=rt("polygonMode",t.polygonMode,{fill:V.FILL_WEBGL,line:V.LINE_WEBGL});e?.polygonModeWEBGL(V.FRONT,n),e?.polygonModeWEBGL(V.BACK,n)}t.polygonOffsetLine&&n.enable(V.POLYGON_OFFSET_LINE_WEBGL)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&n.enable(V.CLIP_DISTANCE0_WEBGL),t.clipDistance1&&n.enable(V.CLIP_DISTANCE1_WEBGL),t.clipDistance2&&n.enable(V.CLIP_DISTANCE2_WEBGL),t.clipDistance3&&n.enable(V.CLIP_DISTANCE3_WEBGL),t.clipDistance4&&n.enable(V.CLIP_DISTANCE4_WEBGL),t.clipDistance5&&n.enable(V.CLIP_DISTANCE5_WEBGL),t.clipDistance6&&n.enable(V.CLIP_DISTANCE6_WEBGL),t.clipDistance7&&n.enable(V.CLIP_DISTANCE7_WEBGL)),void 0!==t.depthWriteEnabled&&n.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?n.enable(V.DEPTH_TEST):n.disable(V.DEPTH_TEST),n.depthFunc(qe("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;n.stencilMaskSeparate(V.FRONT,e),n.stencilMaskSeparate(V.BACK,e)}if(t.stencilReadMask&&u.R.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,r=qe("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?n.enable(V.STENCIL_TEST):n.disable(V.STENCIL_TEST),n.stencilFuncSeparate(V.FRONT,r,0,e),n.stencilFuncSeparate(V.BACK,r,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=Je("stencilPassOperation",t.stencilPassOperation),r=Je("stencilFailOperation",t.stencilFailOperation),s=Je("stencilDepthFailOperation",t.stencilDepthFailOperation);n.stencilOpSeparate(V.FRONT,r,s,e),n.stencilOpSeparate(V.BACK,r,s,e)}switch(t.blend){case!0:n.enable(V.BLEND);break;case!1:n.disable(V.BLEND)}if(t.blendColorOperation||t.blendAlphaOperation){const e=et("blendColorOperation",t.blendColorOperation||"add"),r=et("blendAlphaOperation",t.blendAlphaOperation||"add");n.blendEquationSeparate(e,r);const s=tt("blendColorSrcFactor",t.blendColorSrcFactor||"one"),i=tt("blendColorDstFactor",t.blendColorDstFactor||"zero"),a=tt("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),o=tt("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,i,a,o)}}function qe(e,t){return rt(e,t,{never:V.NEVER,less:V.LESS,equal:V.EQUAL,"less-equal":V.LEQUAL,greater:V.GREATER,"not-equal":V.NOTEQUAL,"greater-equal":V.GEQUAL,always:V.ALWAYS})}function Je(e,t){return rt(e,t,{keep:V.KEEP,zero:V.ZERO,replace:V.REPLACE,invert:V.INVERT,"increment-clamp":V.INCR,"decrement-clamp":V.DECR,"increment-wrap":V.INCR_WRAP,"decrement-wrap":V.DECR_WRAP})}function et(e,t){return rt(e,t,{add:V.FUNC_ADD,subtract:V.FUNC_SUBTRACT,"reverse-subtract":V.FUNC_REVERSE_SUBTRACT,min:V.MIN,max:V.MAX})}function tt(e,t){return rt(e,t,{one:V.ONE,zero:V.ZERO,"src-color":V.SRC_COLOR,"one-minus-src-color":V.ONE_MINUS_SRC_COLOR,"dst-color":V.DST_COLOR,"one-minus-dst-color":V.ONE_MINUS_DST_COLOR,"src-alpha":V.SRC_ALPHA,"one-minus-src-alpha":V.ONE_MINUS_SRC_ALPHA,"dst-alpha":V.DST_ALPHA,"one-minus-dst-alpha":V.ONE_MINUS_DST_ALPHA,"src-alpha-saturated":V.SRC_ALPHA_SATURATE,"constant-color":V.CONSTANT_COLOR,"one-minus-constant-color":V.ONE_MINUS_CONSTANT_COLOR,"constant-alpha":V.CONSTANT_ALPHA,"one-minus-constant-alpha":V.ONE_MINUS_CONSTANT_ALPHA})}function rt(e,t,r){if(!(t in r))throw new Error(function(e,t){return`Illegal parameter ${t} for ${e}`}(e,t));return r[t]}function nt(e){let t=!0;for(const r in e){t=!1;break}return t}function st(e){const t={};return e.addressModeU&&(t[V.TEXTURE_WRAP_S]=it(e.addressModeU)),e.addressModeV&&(t[V.TEXTURE_WRAP_T]=it(e.addressModeV)),e.addressModeW&&(t[V.TEXTURE_WRAP_R]=it(e.addressModeW)),e.magFilter&&(t[V.TEXTURE_MAG_FILTER]=at(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[V.TEXTURE_MIN_FILTER]=function(e,t){void 0===t&&(t="none");if(!t)return at(e);switch(t){case"none":return at(e);case"nearest":return"nearest"===e?V.NEAREST_MIPMAP_NEAREST:V.NEAREST_MIPMAP_LINEAR;case"linear":return"nearest"===e?V.LINEAR_MIPMAP_NEAREST:V.LINEAR_MIPMAP_LINEAR}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[V.TEXTURE_MIN_LOD]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[V.TEXTURE_MAX_LOD]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[V.TEXTURE_COMPARE_MODE]=V.COMPARE_REF_TO_TEXTURE),e.compare&&(t[V.TEXTURE_COMPARE_FUNC]=qe("compare",e.compare)),e.maxAnisotropy&&(t[V.TEXTURE_MAX_ANISOTROPY_EXT]=e.maxAnisotropy),t}function it(e){switch(e){case"clamp-to-edge":return V.CLAMP_TO_EDGE;case"repeat":return V.REPEAT;case"mirror-repeat":return V.MIRRORED_REPEAT}}function at(e){switch(e){case"nearest":return V.NEAREST;case"linear":return V.LINEAR}}class ot extends Qe.L{constructor(e,t){super(e,t),this.device=e,this.parameters=st(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,r]of Object.entries(e)){const e=Number(t);switch(e){case V.TEXTURE_MIN_LOD:case V.TEXTURE_MAX_LOD:this.device.gl.samplerParameterf(this.handle,e,r);break;default:this.device.gl.samplerParameteri(this.handle,e,r)}}}}var _t=r(1213);class lt extends _t.X{constructor(e,t){super(e,{...De.g.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}const Et="Failed to deduce GL constant from typed array";function ct(e){switch(e){case V.ALPHA:case V.R32F:case V.RED:case V.RED_INTEGER:return 1;case V.RG32I:case V.RG32UI:case V.RG32F:case V.RG_INTEGER:case V.RG:return 2;case V.RGB:case V.RGB_INTEGER:case V.RGB32F:return 3;case V.RGBA:case V.RGBA_INTEGER:case V.RGBA32F:return 4;default:return 0}}function dt(e,t,r){if(function(e){for(const t in e)return!1;return!0}(t))return r(e);const{nocatch:n=!0}=t,s=oe.get(e);let i;if(s.push(),se(e,t),n)i=r(e),s.pop();else try{i=r(e)}finally{s.pop()}return i}function ut(e,t,r,n){const{width:s,height:i}=n,{dimension:a,depth:o=0,mipLevel:_=0}=n,{x:l=0,y:E=0,z:c=0}=n,{glFormat:d,glType:u}=n,h=Rt(n.glTarget,a,o),R=n.flipY?{[V.UNPACK_FLIP_Y_WEBGL]:!0}:{};dt(e,R,(()=>{switch(a){case"2d-array":case"3d":e.bindTexture(h,t),e.texSubImage3D(h,_,l,E,c,s,i,o,d,u,r),e.bindTexture(h,null);break;case"2d":case"cube":e.bindTexture(h,t),e.texSubImage2D(h,_,l,E,s,i,d,u,r),e.bindTexture(h,null);break;default:throw new Error(a)}}))}function ht(e,t,r){const{dimension:n,width:s,height:i,depth:a=0,mipLevel:o=0,byteOffset:_=0}=r,{x:l=0,y:E=0,z:c=0}=r,{glFormat:d,glType:u,compressed:h}=r,R=Rt(r.glTarget,n,a);switch(n){case"2d-array":case"3d":h?e.compressedTexSubImage3D(R,o,l,E,c,s,i,a,d,t,_):e.texSubImage3D(R,o,l,E,c,s,i,a,d,u,t,_);break;case"2d":case"cube":h?e.compressedTexSubImage2D(R,o,l,E,s,i,d,t,_):e.texSubImage2D(R,o,l,E,s,i,d,u,t,_);break;default:throw new Error(n)}}function Rt(e,t,r){return"cube"===t?V.TEXTURE_CUBE_MAP_POSITIVE_X+r:e}function Tt(e,t){const{sourceX:r=0,sourceY:n=0,sourceAttachment:s=0}=t||{};let{target:i=null,sourceWidth:a,sourceHeight:o,sourceDepth:_,sourceFormat:l,sourceType:E}=t||{};const{framebuffer:c,deleteFramebuffer:d}=pt(e),{gl:u,handle:h}=c;a||=c.width,o||=c.height;const R=c.colorAttachments[s]?.texture;if(!R)throw new Error(`Invalid framebuffer attachment ${s}`);_=R?.depth||1,l||=R?.glFormat||V.RGBA,E||=R?.glType||V.UNSIGNED_BYTE,i=function(e,t,r,n,s,i){if(e)return e;t||=V.UNSIGNED_BYTE;const a=function(e,t){const{clamped:r=!0}=t||{};switch(e){case V.FLOAT:return Float32Array;case V.UNSIGNED_SHORT:case V.UNSIGNED_SHORT_5_6_5:case V.UNSIGNED_SHORT_4_4_4_4:case V.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case V.UNSIGNED_INT:return Uint32Array;case V.UNSIGNED_BYTE:return r?Uint8ClampedArray:Uint8Array;case V.BYTE:return Int8Array;case V.SHORT:return Int16Array;case V.INT:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}(t,{clamped:!1}),o=ct(r);return new a(n*s*o)}(i,E,l,a,o),E=E||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return V.FLOAT;case Uint16Array:return V.UNSIGNED_SHORT;case Uint32Array:return V.UNSIGNED_INT;case Uint8Array:case Uint8ClampedArray:return V.UNSIGNED_BYTE;case Int8Array:return V.BYTE;case Int16Array:return V.SHORT;case Int32Array:return V.INT;default:throw new Error(Et)}}(i);const T=u.bindFramebuffer(V.FRAMEBUFFER,h);return u.readBuffer(u.COLOR_ATTACHMENT0+s),u.readPixels(r,n,a,o,l,E,i),u.readBuffer(u.COLOR_ATTACHMENT0),u.bindFramebuffer(V.FRAMEBUFFER,T||null),d&&c.destroy(),i}function At(e,t){const{target:r,sourceX:n=0,sourceY:s=0,sourceFormat:i=V.RGBA,targetByteOffset:a=0}=t||{};let{sourceWidth:o,sourceHeight:_,sourceType:l}=t||{};const{framebuffer:E,deleteFramebuffer:c}=pt(e);o=o||E.width,_=_||E.height;const d=E;l=l||V.UNSIGNED_BYTE;let u=r;if(!u){const e=a+o*_*ct(i)*function(e){switch(e){case V.UNSIGNED_BYTE:return 1;case V.UNSIGNED_SHORT_5_6_5:case V.UNSIGNED_SHORT_4_4_4_4:case V.UNSIGNED_SHORT_5_5_5_1:return 2;case V.FLOAT:return 4;default:return 0}}(l);u=d.device.createBuffer({byteLength:e})}const h=e.device.createCommandEncoder();return h.copyTextureToBuffer({sourceTexture:e,width:o,height:_,origin:[n,s],destinationBuffer:u,byteOffset:a}),h.destroy(),c&&E.destroy(),u}function pt(e){return e instanceof Be?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:St(e),deleteFramebuffer:!0}}function St(e,t){const{device:r,width:n,height:s,id:i}=e;return r.createFramebuffer({...t,id:`framebuffer-for-${i}`,width:n,height:s,colorAttachments:[e]})}class ft extends De.g{sampler=void 0;view=void 0;textureUnit=0;constructor(e,t){super(e,t);const r={...this.props};r.data=t.data,this.device=e,this.gl=this.device.gl,this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return V.TEXTURE_2D;case"3d":return V.TEXTURE_3D;case"cube":return V.TEXTURE_CUBE_MAP;case"2d-array":return V.TEXTURE_2D_ARRAY}throw new Error(e)}(this.props.dimension);const n=me(this.props.format);this.glInternalFormat=n.internalFormat,this.glFormat=n.format,this.glType=n.type,this.compressed=n.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(r),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:t,height:r}=e;if(!t||!r){const n=De.g.getTextureDataSize(e.data);t=n?.width||1,r=n?.height||1}if(this.width=t,this.height=r,this.depth=e.depth,this.setSampler(e.sampler),this.view=new lt(this.device,{...this.props,texture:this}),this.bind(),function(e,t,r){const{dimension:n,width:s,height:i,depth:a=0}=r,{glInternalFormat:o}=r,_=r.glTarget;switch(n){case"2d-array":case"3d":e.texStorage3D(_,t,o,s,i,a);break;default:e.texStorage2D(_,t,o,s,i)}}(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new lt(this.device,{...e,texture:this})}setSampler(e){let t;void 0===e&&(e={}),e instanceof ot?(this.sampler=e,t=e.props):(this.sampler=new ot(this.device,e),t=e);const r=st(t);this._setSamplerParameters(r)}generateMipmap(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(u.R.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),e?.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){u.R.warn(`Error generating mipmap for ${this}: ${t.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const t=De.g.getExternalImageSize(e.image),r={...De.g.defaultCopyExternalImageOptions,...t,...e},{image:n,depth:s,mipLevel:i,x:a,y:o,z:_,flipY:l}=r;let{width:E,height:c}=r;const{dimension:d,glTarget:u,glFormat:h,glInternalFormat:R,glType:T}=this;if(E=Math.min(E,this.width-a),c=Math.min(c,this.height-o),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return ut(this.device.gl,this.handle,n,{dimension:d,mipLevel:i,x:a,y:o,z:_,width:E,height:c,depth:s,glFormat:h,glInternalFormat:R,glType:T,glTarget:u,flipY:l}),{width:r.width,height:r.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,t){void 0===t&&(t=0),this.bind();const r=De.g.normalizeTextureData(e,this);r.length>1&&!1!==this.props.mipmaps&&u.R.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let n=0;n<r.length;n++){const e=r[n];this._setMipLevel(t,n,e)}this.unbind()}setTexture3DData(e){if("3d"!==this.props.dimension)throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),ht(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,t){if(void 0===t&&(t=0),"cube"!==this.props.dimension)throw new Error(this.id);for(const r of De.g.CubeFaces)this.setTextureCubeFaceData(e[r],r)}setTextureArrayData(e){if("2d-array"!==this.props.dimension)throw new Error(this.id);throw new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,t,r){void 0===r&&(r=0),Array.isArray(e)&&e.length>1&&!1!==this.props.mipmaps&&u.R.warn(`${this.id} has mipmap and multiple LODs.`)();const n=De.g.CubeFaces.indexOf(t);this.setTexture2DData(e,n)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:t,width:r,height:n,pixels:s,data:i,format:a=V.RGBA,type:o=V.UNSIGNED_BYTE}=e,{gl:_}=this,l=s||i;this.bind(),l instanceof Promise?l.then((r=>this.setImageDataForFace(Object.assign({},e,{face:t,data:r,pixels:r})))):this.width||this.height?_.texImage2D(t,0,a,r,n,0,a,o,l):_.texImage2D(t,0,a,a,o,l)}_getImageDataMap(e){for(let t=0;t<De.g.CubeFaces.length;++t){const r=De.g.CubeFaces[t];e[r]&&(e[V.TEXTURE_CUBE_MAP_POSITIVE_X+t]=e[r],delete e[r])}return e}_setSamplerParameters(e){u.R.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,r]of Object.entries(e)){const e=Number(t),n=r;switch(e){case V.TEXTURE_MIN_LOD:case V.TEXTURE_MAX_LOD:this.gl.texParameterf(this.glTarget,e,n);break;case V.TEXTURE_MIN_FILTER:case V.TEXTURE_WRAP_S:case V.TEXTURE_WRAP_T:this.gl.texParameteri(this.glTarget,e,n);break;case V.TEXTURE_MAX_ANISOTROPY_EXT:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,n);break;default:this.gl.texParameteri(this.glTarget,e,n)}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,t,r,n){if(void 0===n&&(n=this.glTarget),De.g.isExternalImage(r))ut(this.device.gl,this.handle,r,{...this,depth:e,mipLevel:t,glTarget:n,flipY:this.props.flipY});else{if(!De.g.isTextureLevelData(r))throw new Error("Texture: invalid image data");ht(this.device.gl,r.data,{...this,depth:e,mipLevel:t,glTarget:n})}}getActiveUnit(){return this.gl.getParameter(V.ACTIVE_TEXTURE)-V.TEXTURE0}bind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.glTarget,null),e}}class gt extends Oe.F{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps=(()=>({...Oe.F.defaultProps,framebuffer:null,parameters:void 0,clearColor:gt.defaultClearColor,clearColors:void 0,clearDepth:gt.defaultClearDepth,clearStencil:gt.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}))();get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=gt.normalizeProps(e,t),gt.defaultProps)}static normalizeProps(e,t){const r=e.props._resourceDefaults?.renderPass;return{...r,...t}}}const mt=[1,2,4,8];class Ct extends gt{constructor(e,t){let r;if(super(e,t),this.device=e,!t?.parameters?.viewport)if(t?.framebuffer){const{width:e,height:n}=t.framebuffer;r=[0,0,e,n]}else{const[t,n]=e.getCanvasContext().getDrawingBufferSize();r=[0,0,t,n]}if(this.device.pushState(),this.setParameters({viewport:r,...this.props.parameters}),this.props.framebuffer){const e=this.props.framebuffer.colorAttachments.map(((e,t)=>V.COLOR_ATTACHMENT0+t));this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([V.BACK]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e){void 0===e&&(e={});const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[V.RASTERIZER_DISCARD]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[V.STENCIL_REF]=e.stencilReference),e.colorMask&&(t.colorMask=mt.map((t=>Boolean(t&e.colorMask)))),this.glParameters=t,se(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;t?.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;e?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach(((e,t)=>{e&&this.clearColorBuffer(t,e)})),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=V.COLOR_BUFFER_BIT,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=V.DEPTH_BUFFER_BIT,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=V.STENCIL_BUFFER_BIT,e.clearStencil=this.props.clearStencil),0!==t&&dt(this.device.gl,e,(()=>{this.device.gl.clear(t)}))}clearColorBuffer(e,t){void 0===e&&(e=0),void 0===t&&(t=[0,0,0,0]),dt(this.device.gl,{framebuffer:this.props.framebuffer},(()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(V.COLOR,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(V.COLOR,e,t);break;case Float32Array:this.device.gl.clearBufferfv(V.COLOR,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}}))}}var Nt=r(9853);const It=[V.SAMPLER_2D,V.SAMPLER_CUBE,V.SAMPLER_3D,V.SAMPLER_2D_SHADOW,V.SAMPLER_2D_ARRAY,V.SAMPLER_2D_ARRAY_SHADOW,V.SAMPLER_CUBE_SHADOW,V.INT_SAMPLER_2D,V.INT_SAMPLER_3D,V.INT_SAMPLER_CUBE,V.INT_SAMPLER_2D_ARRAY,V.UNSIGNED_INT_SAMPLER_2D,V.UNSIGNED_INT_SAMPLER_3D,V.UNSIGNED_INT_SAMPLER_CUBE,V.UNSIGNED_INT_SAMPLER_2D_ARRAY],bt={[V.FLOAT]:[V.FLOAT,1,"float","f32","float32"],[V.FLOAT_VEC2]:[V.FLOAT,2,"vec2","vec2<f32>","float32x2"],[V.FLOAT_VEC3]:[V.FLOAT,3,"vec3","vec3<f32>","float32x3"],[V.FLOAT_VEC4]:[V.FLOAT,4,"vec4","vec4<f32>","float32x4"],[V.INT]:[V.INT,1,"int","i32","sint32"],[V.INT_VEC2]:[V.INT,2,"ivec2","vec2<i32>","sint32x2"],[V.INT_VEC3]:[V.INT,3,"ivec3","vec3<i32>","sint32x3"],[V.INT_VEC4]:[V.INT,4,"ivec4","vec4<i32>","sint32x4"],[V.UNSIGNED_INT]:[V.UNSIGNED_INT,1,"uint","u32","uint32"],[V.UNSIGNED_INT_VEC2]:[V.UNSIGNED_INT,2,"uvec2","vec2<u32>","uint32x2"],[V.UNSIGNED_INT_VEC3]:[V.UNSIGNED_INT,3,"uvec3","vec3<u32>","uint32x3"],[V.UNSIGNED_INT_VEC4]:[V.UNSIGNED_INT,4,"uvec4","vec4<u32>","uint32x4"],[V.BOOL]:[V.FLOAT,1,"bool","f32","float32"],[V.BOOL_VEC2]:[V.FLOAT,2,"bvec2","vec2<f32>","float32x2"],[V.BOOL_VEC3]:[V.FLOAT,3,"bvec3","vec3<f32>","float32x3"],[V.BOOL_VEC4]:[V.FLOAT,4,"bvec4","vec4<f32>","float32x4"],[V.FLOAT_MAT2]:[V.FLOAT,8,"mat2","mat2x2<f32>"],[V.FLOAT_MAT2x3]:[V.FLOAT,8,"mat2x3","mat2x3<f32>"],[V.FLOAT_MAT2x4]:[V.FLOAT,8,"mat2x4","mat2x4<f32>"],[V.FLOAT_MAT3x2]:[V.FLOAT,12,"mat3x2","mat3x2<f32>"],[V.FLOAT_MAT3]:[V.FLOAT,12,"mat3","mat3x3<f32>"],[V.FLOAT_MAT3x4]:[V.FLOAT,12,"mat3x4","mat3x4<f32>"],[V.FLOAT_MAT4x2]:[V.FLOAT,16,"mat4x2","mat4x2<f32>"],[V.FLOAT_MAT4x3]:[V.FLOAT,16,"mat4x3","mat4x3<f32>"],[V.FLOAT_MAT4]:[V.FLOAT,16,"mat4","mat4x4<f32>"]};function Lt(e){const t=bt[e];if(!t)throw new Error("uniform");const[r,n,,s]=t;return{format:s,components:n,glType:r}}function Ft(e){const t=bt[e];if(!t)throw new Error("attribute");const[,r,,n,s]=t;return{attributeType:n,vertexFormat:s,components:r}}function Pt(e,t){const r={attributes:[],bindings:[]};r.attributes=function(e,t){const r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const n=e.getActiveAttrib(t,s);if(!n)throw new Error("activeInfo");const{name:i,type:a}=n,o=e.getAttribLocation(t,i);if(o>=0){const{attributeType:e}=Ft(a),t=/instance/i.test(i)?"instance":"vertex";r.push({name:i,location:o,stepMode:t,type:e})}}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);const n=function(e,t){const r=(r,n)=>e.getActiveUniformBlockParameter(t,r,n),n=[],s=e.getProgramParameter(t,V.ACTIVE_UNIFORM_BLOCKS);for(let i=0;i<s;i++){const s={name:e.getActiveUniformBlockName(t,i)||"",location:r(i,V.UNIFORM_BLOCK_BINDING),byteLength:r(i,V.UNIFORM_BLOCK_DATA_SIZE),vertex:r(i,V.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),fragment:r(i,V.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),uniformCount:r(i,V.UNIFORM_BLOCK_ACTIVE_UNIFORMS),uniforms:[]},a=r(i,V.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)||[],o=e.getActiveUniforms(t,a,V.UNIFORM_TYPE),_=e.getActiveUniforms(t,a,V.UNIFORM_SIZE),l=e.getActiveUniforms(t,a,V.UNIFORM_OFFSET),E=e.getActiveUniforms(t,a,V.UNIFORM_ARRAY_STRIDE);for(let r=0;r<s.uniformCount;++r){const n=e.getActiveUniform(t,a[r]);if(!n)throw new Error("activeInfo");s.uniforms.push({name:n.name,format:Lt(o[r]).format,type:o[r],arrayLength:_[r],byteOffset:l[r],byteStride:E[r]})}n.push(s)}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);for(const _ of n){const e=_.uniforms.map((e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength})));r.bindings.push({type:"uniform",name:_.name,group:0,location:_.location,visibility:(_.vertex?1:0)&(_.fragment?2:0),minBindingSize:_.byteLength,uniforms:e})}const s=function(e,t){const r=[],n=e.getProgramParameter(t,V.ACTIVE_UNIFORMS);for(let s=0;s<n;s++){const n=e.getActiveUniform(t,s);if(!n)throw new Error("activeInfo");const{name:i,size:a,type:o}=n,{name:_,isArray:l}=Bt(i);let E=e.getUniformLocation(t,_);const c={location:E,name:_,size:a,type:o,isArray:l};if(r.push(c),c.size>1)for(let s=0;s<c.size;s++){const n=`${_}[${s}]`;E=e.getUniformLocation(t,n);const i={...c,name:n,location:E};r.push(i)}}return r}(e,t);let i=0;for(const _ of s)if(a=_.type,It.includes(a)){const{viewDimension:e,sampleType:t}=Dt(_.type);r.bindings.push({type:"texture",name:_.name,group:0,location:i,viewDimension:e,sampleType:t}),_.textureUnit=i,i+=1}var a;s.length&&(r.uniforms=s);const o=function(e,t){const r=[],n=e.getProgramParameter(t,V.TRANSFORM_FEEDBACK_VARYINGS);for(let s=0;s<n;s++){const n=e.getTransformFeedbackVarying(t,s);if(!n)throw new Error("activeInfo");const{name:i,type:a,size:o}=n,{glType:_,components:l}=Lt(a),E={location:s,name:i,type:_,size:o*l};r.push(E)}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);return o?.length&&(r.varyings=o),r}const Ot={[V.SAMPLER_2D]:["2d","float"],[V.SAMPLER_CUBE]:["cube","float"],[V.SAMPLER_3D]:["3d","float"],[V.SAMPLER_2D_SHADOW]:["3d","depth"],[V.SAMPLER_2D_ARRAY]:["2d-array","float"],[V.SAMPLER_2D_ARRAY_SHADOW]:["2d-array","depth"],[V.SAMPLER_CUBE_SHADOW]:["cube","float"],[V.INT_SAMPLER_2D]:["2d","sint"],[V.INT_SAMPLER_3D]:["3d","sint"],[V.INT_SAMPLER_CUBE]:["cube","sint"],[V.INT_SAMPLER_2D_ARRAY]:["2d-array","uint"],[V.UNSIGNED_INT_SAMPLER_2D]:["2d","uint"],[V.UNSIGNED_INT_SAMPLER_3D]:["3d","uint"],[V.UNSIGNED_INT_SAMPLER_CUBE]:["cube","uint"],[V.UNSIGNED_INT_SAMPLER_2D_ARRAY]:["2d-array","uint"]};function Dt(e){const t=Ot[e];if(!t)throw new Error("sampler");const[r,n]=t;return{viewDimension:r,sampleType:n}}function Bt(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function Mt(e,t,r,n){const s=e;let i=n;!0===i&&(i=1),!1===i&&(i=0);const a="number"==typeof i?[i]:i;switch(r){case V.SAMPLER_2D:case V.SAMPLER_CUBE:case V.SAMPLER_3D:case V.SAMPLER_2D_SHADOW:case V.SAMPLER_2D_ARRAY:case V.SAMPLER_2D_ARRAY_SHADOW:case V.SAMPLER_CUBE_SHADOW:case V.INT_SAMPLER_2D:case V.INT_SAMPLER_3D:case V.INT_SAMPLER_CUBE:case V.INT_SAMPLER_2D_ARRAY:case V.UNSIGNED_INT_SAMPLER_2D:case V.UNSIGNED_INT_SAMPLER_3D:case V.UNSIGNED_INT_SAMPLER_CUBE:case V.UNSIGNED_INT_SAMPLER_2D_ARRAY:if("number"!=typeof n)throw new Error("samplers must be set to integers");return e.uniform1i(t,n);case V.FLOAT:return e.uniform1fv(t,a);case V.FLOAT_VEC2:return e.uniform2fv(t,a);case V.FLOAT_VEC3:return e.uniform3fv(t,a);case V.FLOAT_VEC4:return e.uniform4fv(t,a);case V.INT:return e.uniform1iv(t,a);case V.INT_VEC2:return e.uniform2iv(t,a);case V.INT_VEC3:return e.uniform3iv(t,a);case V.INT_VEC4:return e.uniform4iv(t,a);case V.BOOL:return e.uniform1iv(t,a);case V.BOOL_VEC2:return e.uniform2iv(t,a);case V.BOOL_VEC3:return e.uniform3iv(t,a);case V.BOOL_VEC4:return e.uniform4iv(t,a);case V.UNSIGNED_INT:return s.uniform1uiv(t,a,1);case V.UNSIGNED_INT_VEC2:return s.uniform2uiv(t,a,2);case V.UNSIGNED_INT_VEC3:return s.uniform3uiv(t,a,3);case V.UNSIGNED_INT_VEC4:return s.uniform4uiv(t,a,4);case V.FLOAT_MAT2:return e.uniformMatrix2fv(t,!1,a);case V.FLOAT_MAT3:return e.uniformMatrix3fv(t,!1,a);case V.FLOAT_MAT4:return e.uniformMatrix4fv(t,!1,a);case V.FLOAT_MAT2x3:return s.uniformMatrix2x3fv(t,!1,a);case V.FLOAT_MAT2x4:return s.uniformMatrix2x4fv(t,!1,a);case V.FLOAT_MAT3x2:return s.uniformMatrix3x2fv(t,!1,a);case V.FLOAT_MAT3x4:return s.uniformMatrix3x4fv(t,!1,a);case V.FLOAT_MAT4x2:return s.uniformMatrix4x2fv(t,!1,a);case V.FLOAT_MAT4x3:return s.uniformMatrix4x3fv(t,!1,a)}throw new Error("Illegal uniform")}var xt=r(6282);function Ut(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((r=>{const n=e[r];var s;s=n,null!==(0,xt.H9)(s)||"number"==typeof s||"boolean"==typeof s?t.uniforms[r]=n:t.bindings[r]=n})),t}class Gt extends Nt.r{uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:r,bufferMode:n=V.SEPARATE_ATTRIBS}=t;r&&r.length>0&&(this.varyings=r,this.device.gl.transformFeedbackVaryings(this.handle,r,n)),this._linkShaders(),u.R.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=Pt(this.device.gl,this.handle),u.R.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=function(e,t){const r={...e,attributes:e.attributes.map((e=>({...e})))};for(const n of t?.attributes||[]){const e=r.attributes.find((e=>e.name===n.name));e?(e.type=n.type||e.type,e.stepMode=n.stepMode||e.stepMode):u.R.warn(`shader layout attribute ${n.name} not present in shader`)}return r}(this.introspectedLayout,t.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[r,n]of Object.entries(e)){const e=this.shaderLayout.bindings.find((e=>e.name===r))||this.shaderLayout.bindings.find((e=>e.name===`${r}Uniforms`));if(e){switch(n||u.R.warn(`Unsetting binding "${r}" in render pipeline "${this.id}"`)(),e.type){case"uniform":if(!(n instanceof Ye||n.buffer instanceof Ye))throw new Error("buffer value");break;case"texture":if(!(n instanceof lt||n instanceof ft||n instanceof Me))throw new Error("texture value");break;case"sampler":u.R.warn(`Ignoring sampler ${r}`)();break;default:throw new Error(e.type)}this.bindings[r]=n}else{const e=this.shaderLayout.bindings.map((e=>`"${e.name}"`)).join(", ");t?.disableWarnings||u.R.warn(`No binding "${r}" in render pipeline "${this.id}", expected one of ${e}`,n)()}}}draw(e){const{renderPass:t,parameters:r=this.props.parameters,topology:n=this.props.topology,vertexArray:s,vertexCount:i,instanceCount:a,isInstanced:o=!1,firstVertex:_=0,transformFeedback:l}=e,E=function(e){switch(e){case"point-list":return V.POINTS;case"line-list":return V.LINES;case"line-strip":return V.LINE_STRIP;case"triangle-list":return V.TRIANGLES;case"triangle-strip":return V.TRIANGLE_STRIP;default:throw new Error(e)}}(n),c=Boolean(s.indexBuffer),d=s.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return u.R.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return u.R.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),s.bindBeforeRender(t),l&&l.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const h=t;return function(e,t,r,n){if(nt(t))return n(e);const s=e;s.pushState();try{return Ze(e,t),se(s.gl,r),n(e)}finally{s.popState()}}(this.device,r,h.glParameters,(()=>{c&&o?this.device.gl.drawElementsInstanced(E,i||0,d,_,a||0):c?this.device.gl.drawElements(E,i||0,d,_):o?this.device.gl.drawArraysInstanced(E,_,i||0,a||0):this.device.gl.drawArrays(E,_,i||0),l&&l.end()})),s.unbindAfterRender(t),!0}setUniformsWebGL(e){const{bindings:t}=Ut(e);Object.keys(t).forEach((e=>{u.R.warn(`Unsupported value "${JSON.stringify(t[e])}" used in setUniforms() for key ${e}. Use setBindings() instead?`)()})),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),u.R.time(4,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),u.R.timeEnd(4,`linkProgram for ${this.id}`)(),u.R.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}u.R.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),u.R.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){if("success"!==e){switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then((()=>this.vs.debugShader()))}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then((()=>this.fs.debugShader()))}const t=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${t}`)}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,e.LINK_STATUS))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,e.VALIDATE_STATUS)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,V.COMPLETION_STATUS_KHR))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(u.R.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,r=0;for(const n of this.shaderLayout.bindings){const s=this.bindings[n.name]||this.bindings[n.name.replace(/Uniforms$/,"")];if(!s)throw new Error(`No value for binding ${n.name} in ${this.id}`);switch(n.type){case"uniform":const{name:i}=n,a=e.getUniformBlockIndex(this.handle,i);if(a===V.INVALID_INDEX)throw new Error(`Invalid uniform block name ${i}`);e.uniformBlockBinding(this.handle,r,a),s instanceof Ye?e.bindBufferBase(V.UNIFORM_BUFFER,r,s.handle):e.bindBufferRange(V.UNIFORM_BUFFER,r,s.buffer.handle,s.offset||0,s.size||s.buffer.byteLength-s.offset),r+=1;break;case"texture":if(!(s instanceof lt||s instanceof ft||s instanceof Me))throw new Error("texture");let o;if(s instanceof lt)o=s.texture;else if(s instanceof ft)o=s;else{if(!(s instanceof Me&&s.colorAttachments[0]instanceof lt))throw new Error("No texture");u.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),o=s.colorAttachments[0].texture}e.activeTexture(V.TEXTURE0+t),e.bindTexture(o.glTarget,o.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${n.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:r,type:n,textureUnit:s}=e,i=this.uniforms[t]??s;void 0!==i&&Mt(this.device.gl,r,n,i)}}}class vt extends Oe.F{static defaultProps=(()=>({...Oe.F.defaultProps,measureExecutionTime:void 0}))();get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,vt.defaultProps)}}class yt extends Oe.F{static defaultProps={...Oe.F.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,yt.defaultProps)}}class wt extends yt{commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e){void 0===e&&(e=this.commands);for(const t of e)switch(t.name){case"copy-buffer-to-buffer":Ht(this.device,t.options);break;case"copy-buffer-to-texture":Xt(this.device,t.options);break;case"copy-texture-to-buffer":Wt(this.device,t.options);break;case"copy-texture-to-texture":Vt(this.device,t.options);break;default:throw new Error(t.name)}}}function Ht(e,t){const r=t.sourceBuffer,n=t.destinationBuffer;e.gl.bindBuffer(V.COPY_READ_BUFFER,r.handle),e.gl.bindBuffer(V.COPY_WRITE_BUFFER,n.handle),e.gl.copyBufferSubData(V.COPY_READ_BUFFER,V.COPY_WRITE_BUFFER,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(V.COPY_READ_BUFFER,null),e.gl.bindBuffer(V.COPY_WRITE_BUFFER,null)}function Xt(e,t){throw new Error("Not implemented")}function Wt(e,t){const{sourceTexture:r,mipLevel:n=0,aspect:s="all",width:i=t.sourceTexture.width,height:a=t.sourceTexture.height,depthOrArrayLayers:o=0,origin:_=[0,0],destinationBuffer:l,byteOffset:E=0,bytesPerRow:c,rowsPerImage:d}=t;if("all"!==s)throw new Error("aspect not supported in WebGL");if(0!==n||0!==o||c||d)throw new Error("not implemented");const{framebuffer:u,destroyFramebuffer:h}=Kt(r);let R;try{const t=l,r=i||u.width,n=a||u.height,s=me(u.colorAttachments[0].texture.props.format),o=s.format,c=s.type;e.gl.bindBuffer(V.PIXEL_PACK_BUFFER,t.handle),R=e.gl.bindFramebuffer(V.FRAMEBUFFER,u.handle),e.gl.readPixels(_[0],_[1],r,n,o,c,E)}finally{e.gl.bindBuffer(V.PIXEL_PACK_BUFFER,null),void 0!==R&&e.gl.bindFramebuffer(V.FRAMEBUFFER,R),h&&u.destroy()}}function Vt(e,t){const{sourceTexture:r,destinationMipLevel:n=0,origin:s=[0,0],destinationOrigin:i=[0,0],destinationTexture:a}=t;let{width:o=t.destinationTexture.width,height:_=t.destinationTexture.height}=t;const{framebuffer:l,destroyFramebuffer:E}=Kt(r),[c,d]=s,[u,h,R]=i,T=e.gl.bindFramebuffer(V.FRAMEBUFFER,l.handle);let A,p=null;if(!(a instanceof ft))throw new Error("invalid destination");switch(p=a,o=Number.isFinite(o)?o:p.width,_=Number.isFinite(_)?_:p.height,p.bind(0),A=p.glTarget,A){case V.TEXTURE_2D:case V.TEXTURE_CUBE_MAP:e.gl.copyTexSubImage2D(A,n,u,h,c,d,o,_);break;case V.TEXTURE_2D_ARRAY:case V.TEXTURE_3D:e.gl.copyTexSubImage3D(A,n,u,h,R,c,d,o,_)}p&&p.unbind(),e.gl.bindFramebuffer(V.FRAMEBUFFER,T),E&&l.destroy()}function Kt(e){if(e instanceof De.g){const{width:t,height:r,id:n}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${n}`,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class jt extends vt{constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new wt(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,r){}}var Yt=r(9647);class kt extends Oe.F{static defaultProps={...Oe.F.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}indexBuffer=null;constructor(e,t){super(e,t,kt.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:r,bufferLayout:n}=t.renderPipeline||{};if(!r||!n)throw new Error("VertexArray");this.attributeInfos=(0,Yt.M)(r,n,this.maxVertexAttributes)}setConstantWebGL(e,t){throw new Error("constant attributes not supported")}}var $t=r(8397),zt=r(7651);class Qt extends kt{get[Symbol.toStringTag](){return"VertexArray"}buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return"Chrome"===(0,zt.X)()}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&t.glTarget!==V.ELEMENT_ARRAY_BUFFER)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(V.ELEMENT_ARRAY_BUFFER,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const r=t;if(r.glTarget===V.ELEMENT_ARRAY_BUFFER)throw new Error("Use .setIndexBuffer()");const{size:n,type:s,stride:i,offset:a,normalized:o,integer:_,divisor:l}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(V.ARRAY_BUFFER,r.handle),_?this.device.gl.vertexAttribIPointer(e,n,s,i,a):this.device.gl.vertexAttribPointer(e,n,s,o,i,a),this.device.gl.bindBuffer(V.ARRAY_BUFFER,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,l||0),this.attributes[e]=r,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const r=ue(t.bufferDataType);return{size:t.bufferComponents,type:r,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e,t){void 0===t&&(t=!0);const r=Qt.isConstantAttributeZeroSupported(this.device);(t||(r||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const r=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),n=r.byteLength*e,s=r.length*e;if(this.buffer&&n!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${n} !== ${this.buffer.byteLength}.`);let i=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:n}),i=i||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(r,this.bufferValue),i){const e=(0,$t.X)(t.constructor,s);!function(e){const{target:t,source:r,start:n=0,count:s=1}=e,i=r.length,a=s*i;let o=0;for(let _=n;o<i;o++)t[_++]=r[o];for(;o<a;)o<a-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+a-o),o=a);e.target}({target:e,source:r,start:0,count:s}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class Zt extends Oe.F{static defaultProps=(()=>({...Oe.F.defaultProps,layout:void 0,buffers:{}}))();get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,Zt.defaultProps)}}class qt extends Zt{buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e){void 0===e&&(e="point-list"),this.gl.bindTransformFeedback(V.TRANSFORM_FEEDBACK,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return V.POINTS;case"line-list":case"line-strip":return V.LINES;case"triangle-list":case"triangle-strip":return V.TRIANGLES;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(V.TRANSFORM_FEEDBACK,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])}))}setBuffer(e,t){const r=this._getVaryingIndex(e),{buffer:n,byteLength:s,byteOffset:i}=this._getBufferRange(t);if(r<0)return this.unusedBuffers[e]=n,void u.R.warn(`${this.id} unusedBuffers varying buffer ${e}`)();this.buffers[r]={buffer:n,byteLength:s,byteOffset:i},this.bindOnUse||this._bindBuffer(r,n,i,s)}getBuffer(e){if(Jt(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e){if(void 0===e&&(e=this.handle),"function"!=typeof e)return this.gl.bindTransformFeedback(V.TRANSFORM_FEEDBACK,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(V.TRANSFORM_FEEDBACK,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(V.TRANSFORM_FEEDBACK,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof Ye)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:r=0,byteLength:n=e.buffer.byteLength}=e;return{buffer:t,byteOffset:r,byteLength:n}}_getVaryingIndex(e){if(Jt(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:r,byteOffset:n}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,n,r)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(V.TRANSFORM_FEEDBACK_BUFFER,Number(e),null)}_bindBuffer(e,t,r,n){void 0===r&&(r=0);const s=t&&t.handle;s&&void 0!==n?this.gl.bindBufferRange(V.TRANSFORM_FEEDBACK_BUFFER,e,s,r,n):this.gl.bindBufferBase(V.TRANSFORM_FEEDBACK_BUFFER,e,s)}}function Jt(e){return"number"==typeof e?Number.isInteger(e):/^\d+$/.test(e)}class er extends Oe.F{static defaultProps=(()=>({...Oe.F.defaultProps,type:void 0,count:void 0}))();get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,er.defaultProps)}}class tr extends er{target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(V.TIME_ELAPSED_EXT)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?V.ANY_SAMPLES_PASSED_CONSERVATIVE:V.ANY_SAMPLES_PASSED)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(V.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,V.QUERY_RESULT_AVAILABLE);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(V.GPU_DISJOINT_EXT)}getResult(){return this.device.gl.getQueryParameter(this.handle,V.QUERY_RESULT)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e){if(void 0===e&&(e=Number.POSITIVE_INFINITY),this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((r,n)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):t++>e?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)})),this._pollingPromise}}class rr extends v{type="webgl";debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;constructor(e){super({...e,id:e.id||je("webgl-device")});const t=v._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let r=t.canvas?.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);this.canvasContext=new xe(this,t),this.lost=new Promise((e=>{this._resolveContextLost=e}));const n={...e.webgl};"premultiplied"===t.alphaMode&&(n.premultipliedAlpha=!0),void 0!==e.powerPreference&&(n.powerPreference=e.powerPreference);const s=this.props._handle||function(e,t,r){let n="";const s={preserveDrawingBuffer:!0,...r};let i=null;if(i||=e.getContext("webgl2",s),s.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),i||r.failIfMajorPerformanceCaveat||(s.failIfMajorPerformanceCaveat=!1,i=e.getContext("webgl2",s),i.luma||={},i.luma.softwareRenderer=!0),i||(i=e.getContext("webgl",{}),i&&(i=null,n||="Your browser only supports WebGL1")),!i)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:a,onContextRestored:o}=t;return e.addEventListener("webglcontextlost",(e=>a(e)),!1),e.addEventListener("webglcontextrestored",(e=>o(e)),!1),i.luma||={},i}(this.canvasContext.canvas,{onContextLost:e=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:e=>console.log("WebGL context restored")},n);if(!s)throw new Error("WebGL context creation failed");if(r=s.device,r){if(e._reuseDevices)return u.R.log(1,`Not creating a new Device, instead returning a reference to Device ${r.id} already attached to WebGL context`,r)(),r._reused=!0,r;throw new Error(`WebGL context already attached to device ${r.id}`)}this.handle=s,this.gl=s,this.spectorJS=function(e){if(!(e={...ye,...e}).debugSpectorJS)return null;if(!Ge&&globalThis.SPECTOR&&!globalThis.luma?.spector){u.R.probe(1,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Ge=new e,globalThis.luma&&(globalThis.luma.spector=Ge)}if(!Ge)return null;if(ve||(ve=!0,Ge.spyCanvases(),Ge?.onCaptureStarted.add((e=>u.R.info("Spector capture started:",e)())),Ge?.onCapture.add((e=>{u.R.info("Spector capture complete:",e)(),Ge?.getResultUI(),Ge?.resultView.display(),Ge?.resultView.addCapture(e)}))),e.gl){const t=e.gl,r=t.device;Ge?.startCapture(e.gl,500),t.device=r,new Promise((e=>setTimeout(e,2e3))).then((e=>{u.R.info("Spector capture stopped after 2 seconds")(),Ge?.stopCapture()}))}return Ge}({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=ce(this.gl,this._extensions),this.limits=new be(this.gl),this.features=new Ie(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),!1!==t.autoResize&&this.canvasContext.resize();const i=new oe(this.gl,{log:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return u.R.log(1,...t)()}});i.trackState(this.gl,{copyState:!1});const a=e.debugWebGL||e.debug,o=e.debugWebGL;a&&(this.gl=He(this.gl,{debugWebGL:a,traceWebGL:o}),u.R.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(u.R.level=Math.max(u.R.level,1)))}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new Ye(this,t)}createTexture(e){return new ft(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new ot(this,e)}createShader(e){return new ze(this,e)}createFramebuffer(e){return new Me(this,e)}createVertexArray(e){return new Qt(this,e)}createTransformFeedback(e){return new qt(this,e)}createQuerySet(e){return new tr(this,e)}createRenderPipeline(e){return new Gt(this,e)}beginRenderPass(e){return new Ct(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e){return void 0===e&&(e={}),new jt(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return Tt(e,t)}readPixelsToBufferWebGL(e,t){return At(e,t)}setParametersWebGL(e){se(this.gl,e)}getParametersWebGL(e){return ie(this.gl,e)}withParametersWebGL(e,t){return dt(this.gl,e,t)}resetWebGL(){u.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),se(this.gl,K)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,r){let n=t.create;const s=ge[t.format];return void 0===s?.gl&&(n=!1),s?.x&&(n=n&&Boolean(Ee(e,s.x,r))),{format:t.format,create:n&&t.create,render:n&&t.render,filter:n&&t.filter,blend:n&&t.blend,store:n&&t.store}}(this.gl,e,this._extensions)}loseDevice(){let e=!1;const t=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return t&&(e=!0,t.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){oe.get(this.gl).push()}popState(){oe.get(this.gl).pop()}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){const r=Number(e);for(const n in this.gl)if(this.gl[n]===r)return`GL.${n}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce(((e,r)=>{let[n,s]=r;return e[`${n}:${this.getGLKey(n,t)}`]=`${s}:${this.getGLKey(s,t)}`,e}),{})}setConstantAttributeWebGL(e,t){const r=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(r).fill(null);const n=this._constants[e];switch(n&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(n,t)&&u.R.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r)}}(this,e,t);break;case Int32Array:!function(e,t,r){e.gl.vertexAttribI4iv(t,r)}(this,e,t);break;case Uint32Array:!function(e,t,r){e.gl.vertexAttribI4uiv(t,r)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return Ee(this.gl,e,this._extensions),this._extensions}}const nr={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:V.UNSIGNED_INT_24_8},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:V.HALF_FLOAT},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:V.FRAGMENT_SHADER_DERIVATIVE_HINT},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:V.MIN,MAX_EXT:V.MAX},EXT_shader_texture_lod:{}},sr=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:V.COLOR_ATTACHMENT0,COLOR_ATTACHMENT1_WEBGL:V.COLOR_ATTACHMENT1,COLOR_ATTACHMENT2_WEBGL:V.COLOR_ATTACHMENT2,COLOR_ATTACHMENT3_WEBGL:V.COLOR_ATTACHMENT3}),ir=e=>({VERTEX_ARRAY_BINDING_OES:V.VERTEX_ARRAY_BINDING,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),ar=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(){return e.drawArraysInstanced(...arguments)},drawElementsInstancedANGLE(){return e.drawElementsInstanced(...arguments)},vertexAttribDivisorANGLE(){return e.vertexAttribDivisor(...arguments)}});function or(e){void 0===e&&(e=!0);const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...nr,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:sr(e),OES_vertex_array_object:ir(e),ANGLE_instanced_arrays:ar(e)},r=e.getExtension;e.getExtension=function(n){const s=r.call(e,n);return s||(n in t?t[n]:null)};const n=e.getSupportedExtensions;e.getSupportedExtensions=function(){const r=n.apply(e)||[];return r?.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}const _r=new class extends W{type="webgl";constructor(){super(),v.defaultProps={...v.defaultProps,...ye},rr.adapter=this}isSupported(){return"undefined"!=typeof WebGL2RenderingContext}enforceWebGL2(e){or(e)}async attach(e){if(e instanceof rr)return e;if(e?.device instanceof v)return e.device;if(!function(e){if("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new rr({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e){void 0===e&&(e={}),u.R.groupCollapsed(1,"WebGLDevice created")();const t=[];(e.debugWebGL||e.debug)&&t.push(async function(){(0,E.B)()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Ue("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),e.debugSpectorJS&&t.push(async function(e){if(!globalThis.SPECTOR)try{await Ue(e.debugSpectorJSUrl||ye.debugSpectorJSUrl)}catch(t){u.R.warn(String(t))}}(e));const r=await Promise.allSettled(t);for(const i of r)"rejected"===i.status&&u.R.error(`Failed to initialize debug libraries ${i.reason}`)();const n=new rr(e),s=`${n._reused?"Reusing":"Created"} device with WebGL2 ${n.debug?"debug ":""}context: ${n.info.vendor}, ${n.info.renderer} for canvas: ${n.canvasContext.id}`;return u.R.probe(1,s)(),u.R.table(1,n.info)(),u.R.groupEnd(1)(),n}};class lr extends R.h{constructor(e,t){super(e,t),this.device=e,this.byteLength=function(e){return e.byteLength||e.data?.byteLength||0}(t);const r=Boolean(t.data),n=4*Math.ceil(this.byteLength/4);this.handle=this.props.handle||this.device.handle.createBuffer({size:n,usage:this.props.usage||GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:this.props.mappedAtCreation||r,label:this.props.id}),t.data&&this._writeMapped(t.data),r&&!t.mappedAtCreation&&this.handle.unmap()}destroy(){this.handle?.destroy(),this.handle=null}write(e,t){void 0===t&&(t=0),this.device.handle.queue.writeBuffer(this.handle,t,e.buffer,e.byteOffset,e.byteLength)}async readAsync(e,t){void 0===e&&(e=0),void 0===t&&(t=this.byteLength);const r=new lr(this.device,{usage:R.h.MAP_READ|R.h.COPY_DST,byteLength:t}),n=this.device.handle.createCommandEncoder();n.copyBufferToBuffer(this.handle,e,r.handle,0,t),this.device.handle.queue.submit([n.finish()]),await r.handle.mapAsync(GPUMapMode.READ,e,t);const s=r.handle.getMappedRange().slice(0);return r.handle.unmap(),r.destroy(),new Uint8Array(s)}_writeMapped(e){const t=this.handle.getMappedRange();new e.constructor(t).set(e)}mapAsync(e,t,r){return void 0===t&&(t=0),this.handle.mapAsync(e,t,r)}getMappedRange(e,t){return void 0===e&&(e=0),this.handle.getMappedRange(e,t)}unmap(){this.handle.unmap()}}function Er(e){if(e.includes("webgl"))throw new Error("webgl-only format");return e}class cr extends Qe.L{constructor(e,t){super(e,t),this.device=e;const r={...this.props,mipmapFilter:void 0};"comparison-sampler"!==t.type&&delete r.compare,t.mipmapFilter&&"none"!==t.mipmapFilter&&(r.mipmapFilter=t.mipmapFilter),this.handle=this.handle||this.device.handle.createSampler(r),this.handle.label=this.props.id}destroy(){this.handle=null}}class dr extends _t.X{constructor(e,t){super(e,t),this.device=e,this.texture=t.texture,this.handle=this.handle||this.texture.handle.createView({format:t.format||this.texture.format,dimension:t.dimension||this.texture.dimension,aspect:t.aspect,baseMipLevel:t.baseMipLevel,mipLevelCount:t.mipLevelCount,baseArrayLayer:t.baseArrayLayer,arrayLayerCount:t.arrayLayerCount}),this.handle.label=this.props.id}destroy(){this.handle=null}}const ur={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class hr extends De.g{constructor(e,t){super(e,t),this.device=e;const r={...this.props};t.data&&(r.data=t.data),this.initialize(r)}destroy(){this.handle?.destroy(),this.handle=null}createView(e){return new dr(this.device,{...e,texture:this})}initialize(e){this.handle=this.props.handle||this.createHandle(),this.handle.label||=this.id,this.props.data&&(De.g.isExternalImage(this.props.data)?this.copyExternalImage({image:this.props.data}):this.setData({data:this.props.data})),this.width=this.handle.width,this.height=this.handle.height,this.sampler=e.sampler instanceof cr?e.sampler:new cr(this.device,e.sampler||{}),this.view=new dr(this.device,{...this.props,texture:this})}createHandle(){const e=this.props.width||this.props.data?.width||1,t=this.props.height||this.props.data?.height||1;return this.device.handle.createTexture({label:this.id,size:{width:e,height:t,depthOrArrayLayers:this.depth},usage:this.props.usage||De.g.TEXTURE|De.g.COPY_DST,dimension:ur[this.dimension],format:Er(this.format),mipLevelCount:this.mipLevels,sampleCount:this.props.samples})}createGPUTextureView(){return this.handle.createView({label:this.id})}setSampler(e){return this.sampler=e instanceof cr?e:new cr(this.device,e),this}setTexture1DData(e){throw new Error("not implemented")}setTexture2DData(e,t,r){throw new Error("not implemented")}setTexture3DData(e,t,r){throw new Error("not implemented")}setTextureCubeData(e,t){throw new Error("not implemented")}setTextureArrayData(e){throw new Error("not implemented")}setTextureCubeArrayData(e){throw new Error("not implemented")}setData(e){if(ArrayBuffer.isView(e.data)){const t=new Uint8ClampedArray(e.data.buffer),r=new ImageData(t,this.width,this.height);return this.copyExternalImage({image:r})}throw new Error("Texture.setData: Use CommandEncoder to upload data to texture in WebGPU")}copyExternalImage(e){const t=De.g.getExternalImageSize(e.image),r={...De.g.defaultCopyExternalImageOptions,...t,...e},{image:n,sourceX:s,sourceY:i,width:a,height:o,depth:_,mipLevel:l,x:E,y:c,z:d,aspect:u,colorSpace:h,premultipliedAlpha:R,flipY:T}=r;return this.device.handle.queue.copyExternalImageToTexture({source:n,origin:[s,i],flipY:T},{texture:this.handle,origin:[E,c,d],mipLevel:l,aspect:u,colorSpace:h,premultipliedAlpha:R},[a,o,_]),{width:a,height:o}}}class Rr extends Oe.F{static defaultProps=(()=>({...Oe.F.defaultProps,source:void 0,colorSpace:"srgb"}))();get[Symbol.toStringTag](){return"ExternalTexture"}constructor(e,t){super(e,t,Rr.defaultProps)}}class Tr extends Rr{constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.handle.importExternalTexture({source:t.source,colorSpace:t.colorSpace}),this.sampler=null}destroy(){this.handle=null}setSampler(e){return this.sampler=e instanceof cr?e:new cr(this.device,e),this}}class Ar extends ke.M{constructor(e,t){super(e,t),this.device=e;const r=t.source.includes("#version");if("glsl"===this.props.language||r)throw new Error("GLSL shaders are not supported in WebGPU");this.device.handle.pushErrorScope("validation"),this.handle=this.props.handle||this.device.handle.createShaderModule({code:t.source}),this.device.handle.popErrorScope().then((e=>{e&&u.R.error(`${this} creation failed:\n"${e.message}"`,this,this.props.source)()})),this.handle.label=this.props.id,this._checkCompilationError()}get asyncCompilationStatus(){return this.getCompilationInfo().then((()=>this.compilationStatus))}async _checkCompilationError(){const e=await this.getCompilationInfo(),t=Boolean(e.find((e=>"error"===e.type)));this.compilationStatus=t?"error":"success",this.debugShader(),"error"===this.compilationStatus&&u.R.error("Shader compilation error",e)()}destroy(){this.handle=null}async getCompilationInfo(){return(await this.handle.getCompilationInfo()).messages}}function pr(e){return e.depthStencil=e.depthStencil||{format:"depth24plus",stencilFront:{},stencilBack:{},depthWriteEnabled:!1,depthCompare:"less-equal"},e.depthStencil}function Sr(e){return pr(e).stencilFront}function fr(e){return pr(e).stencilBack}const gr={cullMode:(e,t,r)=>{r.primitive=r.primitive||{},r.primitive.cullMode=t},frontFace:(e,t,r)=>{r.primitive=r.primitive||{},r.primitive.frontFace=t},depthWriteEnabled:(e,t,r)=>{pr(r).depthWriteEnabled=t},depthCompare:(e,t,r)=>{pr(r).depthCompare=t},depthFormat:(e,t,r)=>{pr(r).format=t},depthBias:(e,t,r)=>{pr(r).depthBias=t},depthBiasSlopeScale:(e,t,r)=>{pr(r).depthBiasSlopeScale=t},depthBiasClamp:(e,t,r)=>{pr(r).depthBiasClamp=t},stencilReadMask:(e,t,r)=>{pr(r).stencilReadMask=t},stencilWriteMask:(e,t,r)=>{pr(r).stencilWriteMask=t},stencilCompare:(e,t,r)=>{const n=Sr(r),s=fr(r);n.compare=t,s.compare=t},stencilPassOperation:(e,t,r)=>{const n=Sr(r),s=fr(r);n.passOp=t,s.passOp=t},stencilFailOperation:(e,t,r)=>{const n=Sr(r),s=fr(r);n.failOp=t,s.failOp=t},stencilDepthFailOperation:(e,t,r)=>{const n=Sr(r),s=fr(r);n.depthFailOp=t,s.depthFailOp=t},sampleCount:(e,t,r)=>{r.multisample=r.multisample||{},r.multisample.count=t},sampleMask:(e,t,r)=>{r.multisample=r.multisample||{},r.multisample.mask=t},sampleAlphaToCoverageEnabled:(e,t,r)=>{r.multisample=r.multisample||{},r.multisample.alphaToCoverageEnabled=t},colorMask:(e,t,r)=>{Nr(r)[0].writeMask=t},blendColorOperation:(e,t,r)=>{Nr(r)}},mr={primitive:{cullMode:"back",topology:"triangle-list"},vertex:{module:void 0,entryPoint:"main"},fragment:{module:void 0,entryPoint:"main",targets:[]},layout:"auto"};function Cr(e,t){void 0===t&&(t={}),Object.assign(e,{...mr,...e}),function(e,t){for(const[r,n]of Object.entries(t)){const t=gr[r];if(!t)throw new Error(`Illegal parameter ${r}`);t(r,n,e)}}(e,t)}function Nr(e){if(e.fragment.targets=e.fragment?.targets||[],!Array.isArray(e.fragment?.targets))throw new Error("colorstate");return 0===e.fragment?.targets?.length&&e.fragment.targets?.push({}),e.fragment?.targets}function Ir(e,t,r,n){const s=function(e,t){const r=[];for(const[n,s]of Object.entries(e)){let e=br(t,n);e&&r.push(Lr(s,e.location)),e=br(t,`${n}Sampler`),e&&r.push(Lr(s,e.location,{sampler:!0}))}return r}(n,r);return e.createBindGroup({layout:t,entries:s})}function br(e,t){const r=e.bindings.find((e=>e.name===t||`${e.name}uniforms`===t.toLocaleLowerCase()));return r||u.R.warn(`Binding ${t} not set: Not found in shader layout.`)(),r||null}function Lr(e,t,r){if(e instanceof R.h)return{binding:t,resource:{buffer:e.handle}};if(e instanceof Qe.L)return{binding:t,resource:e.handle};if(e instanceof De.g)return r?.sampler?{binding:t,resource:e.sampler.handle}:{binding:t,resource:e.handle.createView({label:"bind-group-auto-created"})};throw new Error("invalid binding")}var Fr=r(8337);function Pr(e){if(e.endsWith("-webgl"))throw new Error(`WebGPU does not support vertex format ${e}`);return e}function Or(e,t){const r=[],n=new Set;for(const s of t){const t=[];let i="vertex",a=0;const o=s.format;if(s.attributes)for(const r of s.attributes){const _=Dr(e,r.attribute,n),l=_?.location;i=_?.stepMode||(_?.name.startsWith("instance")?"instance":"vertex"),t.push({format:Pr(r.format||s.format),offset:r.byteOffset,shaderLocation:l}),a+=(0,Fr.w)(o).byteLength}else{const r=Dr(e,s.name,n);if(!r)continue;a=(0,Fr.w)(o).byteLength,i=r.stepMode||(r.name.startsWith("instance")?"instance":"vertex"),t.push({format:Pr(o),offset:0,shaderLocation:r.location})}r.push({arrayStride:s.byteStride||a,stepMode:i,attributes:t})}for(const s of e.attributes)n.has(s.name)||r.push({arrayStride:(0,Fr.w)("float32x3").byteLength,stepMode:s.stepMode||(s.name.startsWith("instance")?"instance":"vertex"),attributes:[{format:Pr("float32x3"),offset:0,shaderLocation:s.location}]});return r}function Dr(e,t,r){const n=e.attributes.find((e=>e.name===t));if(!n)return u.R.warn(`Unknown attribute ${t}`)(),null;if(r.has(t))throw new Error(`Duplicate attribute ${t}`);return r.add(t),n}class Br extends Nt.r{fs=null;_bindGroupLayout=null;_bindGroup=null;constructor(e,t){if(super(e,t),this.device=e,this.handle=this.props.handle,!this.handle){const e=this._getRenderPipelineDescriptor();u.R.groupCollapsed(1,`new WebGPURenderPipeline(${this.id})`)(),u.R.probe(1,JSON.stringify(e,null,2))(),u.R.groupEnd(1)(),this.device.handle.pushErrorScope("validation"),this.handle=this.device.handle.createRenderPipeline(e),this.device.handle.popErrorScope().then((e=>{e&&u.R.error(`${this} creation failed:\n"${e.message}"`,this,this.props.vs?.source)()}))}this.handle.label=this.props.id,this.vs=t.vs,this.fs=t.fs,this._bindings={...this.props.bindings}}destroy(){this.handle=null}setBindings(e){Object.assign(this._bindings,e)}draw(e){const t=e.renderPass;this.device.handle.pushErrorScope("validation"),t.handle.setPipeline(this.handle),this.device.handle.popErrorScope().then((e=>{e&&u.R.error(`${this} setPipeline failed:\n"${e.message}"`,this)()}));const r=this._getBindGroup();return r&&t.handle.setBindGroup(0,r),e.vertexArray.bindBeforeRender(e.renderPass),e.indexCount?t.handle.drawIndexed(e.indexCount,e.instanceCount,e.firstIndex,e.baseVertex,e.firstInstance):t.handle.draw(e.vertexCount||0,e.instanceCount||1,e.firstInstance),e.vertexArray.unbindAfterRender(e.renderPass),!0}_getBindGroup(){return 0===this.shaderLayout.bindings.length?null:(this._bindGroupLayout=this._bindGroupLayout||this.handle.getBindGroupLayout(0),this._bindGroup=this._bindGroup||Ir(this.device.handle,this._bindGroupLayout,this.shaderLayout,this._bindings),this._bindGroup)}_getRenderPipelineDescriptor(){const e={vertex:{module:this.props.vs.handle,entryPoint:this.props.vertexEntryPoint||"main",buffers:Or(this.shaderLayout,this.props.bufferLayout)},fragment:{module:this.props.fs.handle,entryPoint:this.props.fragmentEntryPoint||"main",targets:[{format:Er(this.device.getCanvasContext().format)}]},primitive:{topology:this.props.topology},layout:"auto"};return Cr(e,this.props.parameters),e}}class Mr extends Be{colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t),this.device=e,this.autoCreateAttachmentTextures()}updateAttachments(){}}var xr=r(5128);class Ur extends xr.C{_bindGroupLayout=null;_bindGroup=null;_bindings={};constructor(e,t){super(e,t),this.device=e;const r=this.props.shader;this.handle=this.props.handle||this.device.handle.createComputePipeline({label:this.props.id,compute:{module:r.handle,entryPoint:this.props.entryPoint,constants:this.props.constants},layout:"auto"})}setBindings(e){Object.assign(this._bindings,e)}_getBindGroup(){return this._bindGroupLayout=this._bindGroupLayout||this.handle.getBindGroupLayout(0),this._bindGroup=this._bindGroup||Ir(this.device.handle,this._bindGroupLayout,this.shaderLayout,this._bindings),this._bindGroup}}class Gr extends gt{pipeline=null;constructor(e,t){void 0===t&&(t={}),super(e,t),this.device=e;const r=t.framebuffer||e.getCanvasContext().getCurrentFramebuffer(),n=this.getRenderPassDescriptor(r),s=t.timestampQuerySet;if(s&&(n.occlusionQuerySet=s.handle),e.features.has("timestamp-query")){const e=t.timestampQuerySet;n.timestampWrites=e?{querySet:e.handle,beginningOfPassWriteIndex:t.beginTimestampIndex,endOfPassWriteIndex:t.endTimestampIndex}:void 0}if(!e.commandEncoder)throw new Error("commandEncoder not available");this.device.handle.pushErrorScope("validation"),this.handle=this.props.handle||e.commandEncoder.beginRenderPass(n),this.device.handle.popErrorScope().then((e=>{e&&u.R.error(`${this} creation failed:\n"${e.message}"`,this)()})),this.handle.label=this.props.id,u.R.groupCollapsed(3,`new WebGPURenderPass(${this.id})`)(),u.R.probe(3,JSON.stringify(n,null,2))(),u.R.groupEnd(3)()}destroy(){}end(){this.handle.end()}setPipeline(e){this.pipeline=e,this.handle.setPipeline(this.pipeline.handle)}setBindings(e){this.pipeline?.setBindings(e);const t=this.pipeline?._getBindGroup();t&&this.handle.setBindGroup(0,t)}setIndexBuffer(e,t,r,n){void 0===r&&(r=0),this.handle.setIndexBuffer(e.handle,t,r,n)}setVertexBuffer(e,t,r){void 0===r&&(r=0),this.handle.setVertexBuffer(e,t.handle,r)}draw(e){e.indexCount?this.handle.drawIndexed(e.indexCount,e.instanceCount,e.firstIndex,e.baseVertex,e.firstInstance):this.handle.draw(e.vertexCount||0,e.instanceCount||1,e.firstIndex,e.firstInstance)}drawIndirect(){}setParameters(e){const{blendConstant:t,stencilReference:r,scissorRect:n,viewport:s}=e;t&&this.handle.setBlendConstant(t),r&&this.handle.setStencilReference(r),n&&this.handle.setScissorRect(n[0],n[1],n[2],n[3]),s&&this.handle.setViewport(s[0],s[1],s[2],s[3],s[4],s[5])}pushDebugGroup(e){this.handle.pushDebugGroup(e)}popDebugGroup(){this.handle.popDebugGroup()}insertDebugMarker(e){this.handle.insertDebugMarker(e)}beginOcclusionQuery(e){this.handle.beginOcclusionQuery(e)}endOcclusionQuery(){this.handle.endOcclusionQuery()}getRenderPassDescriptor(e){const t={colorAttachments:[]};if(t.colorAttachments=e.colorAttachments.map(((e,t)=>({loadOp:!1!==this.props.clearColor?"clear":"load",colorClearValue:this.props.clearColors?.[t]||this.props.clearColor||gt.defaultClearColor,storeOp:this.props.discard?"discard":"store",view:e.handle}))),e.depthStencilAttachment){t.depthStencilAttachment={view:e.depthStencilAttachment.handle};const{depthStencilAttachment:r}=t;this.props.depthReadOnly&&(r.depthReadOnly=!0),!1!==this.props.clearDepth&&(r.depthClearValue=this.props.clearDepth);!0&&(r.depthLoadOp=!1!==this.props.clearDepth?"clear":"load",r.depthStoreOp="store");!1&&(r.stencilLoadOp=!1!==this.props.clearStencil?"clear":"load",r.stencilStoreOp="store")}return t}}class vr extends Oe.F{static defaultProps=(()=>({...Oe.F.defaultProps,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}))();get[Symbol.toStringTag](){return"ComputePass"}constructor(e,t){super(e,t,vr.defaultProps)}}class yr extends vr{_webgpuPipeline=null;constructor(e,t){let r;if(super(e,t),this.device=e,e.features.has("timestamp-query")){const e=t.timestampQuerySet;e&&(r={querySet:e.handle,beginningOfPassWriteIndex:t.beginTimestampIndex,endOfPassWriteIndex:t.endTimestampIndex})}this.handle=this.props.handle||e.commandEncoder?.beginComputePass({label:this.props.id,timestampWrites:r})}destroy(){}end(){this.handle.end()}setPipeline(e){const t=e;this.handle.setPipeline(t.handle),this._webgpuPipeline=t,this.setBindings([])}setBindings(e){const t=this._webgpuPipeline._getBindGroup();this.handle.setBindGroup(0,t)}dispatch(e,t,r){this.handle.dispatchWorkgroups(e,t,r)}dispatchIndirect(e,t){void 0===t&&(t=0);const r=e;this.handle.dispatchWorkgroupsIndirect(r.handle,t)}pushDebugGroup(e){this.handle.pushDebugGroup(e)}popDebugGroup(){this.handle.popDebugGroup()}insertDebugMarker(e){this.handle.insertDebugMarker(e)}}class wr extends kt{get[Symbol.toStringTag](){return"WebGPUVertexArray"}constructor(e,t){super(e,t),this.device=e}destroy(){}setIndexBuffer(e){this.indexBuffer=e}setBuffer(e,t){this.attributes[e]=t}bindBeforeRender(e,t,r){const n=e,s=this.indexBuffer;s?.handle&&(u.R.info(3,"setting index buffer",s?.handle,s?.indexType)(),n.handle.setIndexBuffer(s?.handle,s?.indexType));for(let i=0;i<this.maxVertexAttributes;i++){const e=this.attributes[i];e?.handle&&(u.R.info(3,`setting vertex buffer ${i}`,e?.handle)(),n.handle.setVertexBuffer(i,e?.handle))}}unbindAfterRender(e){}static isConstantAttributeZeroSupported(e){return"Chrome"===(0,zt.X)()}}class Hr extends Le{format=(()=>navigator.gpu.getPreferredCanvasFormat())();depthStencilFormat="depth24plus";depthStencilAttachment=null;get[Symbol.toStringTag](){return"WebGPUCanvasContext"}constructor(e,t,r){super(r),this.device=e,this.width=-1,this.height=-1,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.gpuCanvasContext=this.canvas.getContext("webgpu"),this.format="bgra8unorm"}destroy(){this.gpuCanvasContext.unconfigure()}getCurrentFramebuffer(){this.update();const e=this.getCurrentTexture();return this.width=e.width,this.height=e.height,this._createDepthStencilAttachment(),new Mr(this.device,{colorAttachments:[e],depthStencilAttachment:this.depthStencilAttachment})}update(){const e=this.width,t=this.height,[r,n]=this.getPixelSize();(r!==e||n!==t)&&(this.width=r,this.height=n,this.depthStencilAttachment&&(this.depthStencilAttachment.destroy(),this.depthStencilAttachment=null),this.gpuCanvasContext.configure({device:this.device.handle,format:Er(this.format),colorSpace:this.props.colorSpace,alphaMode:this.props.alphaMode}),u.R.log(1,`${this} Resized ${e}x${t} => ${r}x${n}px`)())}resize(e){if(this.update(),this.device.handle)if(this.canvas){const t=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(t,e)}else;}getCurrentTexture(){return this.device.createTexture({id:`${this.id}#color-texture`,handle:this.gpuCanvasContext.getCurrentTexture(),format:this.format})}_createDepthStencilAttachment(){return this.depthStencilAttachment||(this.depthStencilAttachment=this.device.createTexture({id:`${this.id}#depth-stencil-texture`,format:this.depthStencilFormat,width:this.width,height:this.height,usage:GPUTextureUsage.RENDER_ATTACHMENT})),this.depthStencilAttachment}}class Xr extends er{constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.handle.createQuerySet({type:this.props.type,count:this.props.count}),this.handle.label=this.props.id}destroy(){this.handle?.destroy(),this.handle=null}}class Wr extends v{type="webgpu";canvasContext=null;_isLost=!1;commandEncoder=null;renderPass=null;constructor(e,t,r,n){super({...e,id:e.id||"webgpu-device"}),this.handle=t,this.adapter=r,this.adapterInfo=n,this.info=this._getInfo(),this.features=this._getFeatures(),this.limits=this.handle.limits,t.addEventListener("uncapturederror",(e=>{const t=e instanceof GPUUncapturedErrorEvent?e.error.message:"Unknown WebGPU error";this.reportError(new Error(t)),this.props.debug,e.preventDefault()})),this.lost=new Promise((async e=>{const t=await this.handle.lost;this._isLost=!0,e({reason:"destroyed",message:t.message})}));const s=v._getCanvasContextProps(e);s&&(this.canvasContext=new Hr(this,this.adapter,s))}destroy(){this.handle.destroy()}get isLost(){return this._isLost}createBuffer(e){const t=this._normalizeBufferProps(e);return new lr(this,t)}createTexture(e){return new hr(this,e)}createExternalTexture(e){return new Tr(this,e)}createShader(e){return new Ar(this,e)}createSampler(e){return new cr(this,e)}createRenderPipeline(e){return new Br(this,e)}createFramebuffer(e){return new Mr(this,e)}createComputePipeline(e){return new Ur(this,e)}createVertexArray(e){return new wr(this,e)}beginRenderPass(e){return this.commandEncoder=this.commandEncoder||this.handle.createCommandEncoder(),new Gr(this,e)}beginComputePass(e){return this.commandEncoder=this.commandEncoder||this.handle.createCommandEncoder(),new yr(this,e)}createTransformFeedback(e){throw new Error("Transform feedback not supported in WebGPU")}createQuerySet(e){return new Xr(this,e)}createCanvasContext(e){return new Hr(this,this.adapter,e)}submit(){const e=this.commandEncoder?.finish();e&&(this.handle.pushErrorScope("validation"),this.handle.queue.submit([e]),this.handle.popErrorScope().then((e=>{e&&this.reportError(new Error(`WebGPU command submission failed: ${e.message}`))}))),this.commandEncoder=null}_getInfo(){const[e,t]=(this.adapterInfo.driver||"").split(" Version "),r=this.adapterInfo.vendor||this.adapter.__brand||"unknown",n=e||"",s=t||"",i="apple"===r?"apple":"unknown",a=this.adapterInfo.architecture||"unknown",o=this.adapterInfo.backend||"unknown";return{type:"webgpu",vendor:r,renderer:n,version:s,gpu:i,gpuType:(this.adapterInfo.type||"").split(" ")[0].toLowerCase()||"unknown",gpuBackend:o,gpuArchitecture:a,shadingLanguage:"wgsl",shadingLanguageVersion:100}}_getFeatures(){const e=new Set(this.handle.features);e.has("depth-clamping")&&(e.delete("depth-clamping"),e.add("depth-clip-control")),e.has("texture-compression-bc")&&e.add("texture-compression-bc5-webgl");const t=["timer-query-webgl","compilation-status-async-webgl","float32-renderable-webgl","float16-renderable-webgl","norm16-renderable-webgl","texture-filterable-anisotropic-webgl","shader-noperspective-interpolation-webgl"];for(const r of t)e.add(r);return new G(Array.from(e),this.props._disabledFeatures)}_getDeviceSpecificTextureFormatCapabilities(e){const{format:t}=e;return t.includes("webgl")?{format:t,create:!1,render:!1,filter:!1,blend:!1,store:!1}:e}copyExternalImageToTexture(e){const{source:t,sourceX:r=0,sourceY:n=0,texture:s,mipLevel:i=0,aspect:a="all",colorSpace:o="display-p3",premultipliedAlpha:_=!1,width:l=s.width,height:E=s.height,depth:c=1}=e,d=s;this.handle?.queue.copyExternalImageToTexture({source:t,origin:[r,n]},{texture:d.handle,origin:[0,0,0],mipLevel:i,aspect:a,colorSpace:o,premultipliedAlpha:_},[l,E,c])}}const Vr=new class extends W{type="webgpu";constructor(){super(),Wr.adapter=this}isSupported(){return Boolean("undefined"!=typeof navigator&&navigator.gpu)}async create(e){if(!navigator.gpu)throw new Error("WebGPU not available. Open in Chrome Canary and turn on chrome://flags/#enable-unsafe-webgpu");u.R.groupCollapsed(1,"WebGPUDevice created")();const t=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!t)throw new Error("Failed to request WebGPU adapter");const r=t.info||await(t.requestAdapterInfo?.());u.R.probe(2,"Adapter available",r)();const n=[],s={};if(e._requestMaxLimits){n.push(...Array.from(t.features));const e=Object.keys(t.limits).filter((e=>!["minSubgroupSize","maxSubgroupSize"].includes(e)));for(const r of e){const e=r,n=t.limits[e];"number"==typeof n&&(s[e]=n)}}const i=await t.requestDevice({requiredFeatures:n,requiredLimits:s});u.R.probe(1,"GPUDevice available")();const a=new Wr(e,i,t,r);return u.R.probe(1,"Device created. For more info, set chrome://flags/#enable-webgpu-developer-features")(),u.R.table(1,a.info)(),u.R.groupEnd(1)(),a}async attach(e){throw new Error("WebGPUAdapter.attach() not implemented")}};let Kr,jr={};const Yr=(0,l.vt)((e=>({deviceType:void 0,deviceError:void 0,device:void 0,setDeviceType:async t=>{let r,n;try{n=await async function(e){return jr[e]=jr[e]||X.createDevice({adapters:[_r,Vr],type:e,height:0,createCanvasContext:{container:(Kr||(Kr=document.createElement("div"),Kr.style.display="none",document.body.appendChild(Kr)),Kr)}}),await jr[e]}(t)}catch(s){r=s.message}return e((e=>({deviceType:t,deviceError:r,device:n})))}})));Yr.getState().setDeviceType("webgl");var kr=r(6065);const $r=kr.Ay.div`
  display: flex;
  flex-direction: row;

  & > * + * {
    margin-left: 2px;
  }
`,zr=kr.Ay.div((e=>`\n  cursor: pointer;\n  padding: 10px 20px;\n  font-weight: bold;\n  &:hover {\n    background-color: #eeefef;\n  }\n  ${e.isSelected?"\n    color: #276EF1;\n    border-bottom: 4px solid #276EF1;\n  ":""}\n`)),Qr=kr.Ay.div`
  background-color: rgb(250, 248, 245);
`,Zr=e=>{const{children:t}=e,r=n.Children.toArray(t),[s,i]=(0,n.useState)(r[0]?.props.tag||r[0]?.props.title);let a=void 0!==e.selectedItem?e.selectedItem:s;const o=void 0!==e.setSelectedItem?e.setSelectedItem:i;return r.some((e=>(e.props.tag||e.props.title)===a))||(a=s),n.createElement(n.Fragment,null,n.createElement($r,null,r.map((e=>n.createElement(zr,{key:e.props.title,isSelected:(e.props.tag||e.props.title)===a,onClick:()=>o(e.props.tag||e.props.title)},e.props.title)))),n.createElement(Qr,null,r.find((e=>(e.props.tag||e.props.title)===a))))},qr=e=>{const{children:t}=e;return n.createElement(n.Fragment,null,t)};var Jr=r(1993);const en={devices:["webgl2","webgpu"]},tn=e=>{e={...en,...e};const t=Yr((e=>e.deviceType)),r=Yr((e=>e.deviceError)),s=Yr((e=>e.setDeviceType));return n.createElement(Zr,{selectedItem:t,setSelectedItem:s},e.devices.includes("webgl2")&&n.createElement(qr,{key:"WebGL2",title:"WebGL2",tag:"webgl"},r),e.devices.includes("webgpu")&&n.createElement(qr,{key:"WebGPU",title:"WebGPU",tag:"webgpu"},r))},rn=e=>n.createElement(Jr.A,null,(()=>n.createElement(tn,e)));const nn=e=>{let{f:t}=e;const r=Yr((e=>e.device)),s=r?r.info[t]:"N/A";return n.createElement("code",{style:{color:"darkgreen"}},s)},sn=e=>{let{f:t}=e;const r=Yr((e=>e.device));return n.createElement("code",{style:{color:"darkgreen"}},function(e,t){return e?e.limits[t]?String(e.limits[t]):"0 \u274c":"N/A"}(r,t))},an=e=>{let{f:t}=e;const r=Yr((e=>e.device));return n.createElement("span",null,function(e,t){return e?e.features.has(t)?"\u2705":"\u274c":"N/A"}(r,t))},on=e=>{let{f:t}=e;const r=Yr((e=>e.device));return n.createElement("span",{key:t},function(e,t){try{const r=e&&e.isTextureFormatSupported(t);return e?r?"\u2705":"\u274c":"N/A"}catch{return"\u274c"}}(r,t))},_n=e=>{let{f:t}=e;const r=Yr((e=>e.device));return n.createElement("span",null,function(e,t){try{const r=e&&e.isTextureFormatSupported(t)&&e.isTextureFormatFilterable(t);return e?r?"\u2705":"\u274c":"N/A"}catch{return"\u274c"}}(r,t))},ln=e=>{let{f:t}=e;const r=Yr((e=>e.device)),n=t;try{const e=r&&r.isTextureFormatSupported(n)&&r.isTextureFormatRenderable(n);return r?e?"\u2705":"\u274c":"N/A"}catch{return"\u274c"}};let En=0;const cn={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:X.stats.get("animation-loop-"+En++),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class dn{device=null;canvas=null;animationProps=null;timeline=null;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...cn,...e},!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new c.A({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){this.props.onError(e),this._error=Error();const t=this.device?.canvasContext?.canvas;if(t instanceof HTMLCanvasElement){const t=document.createElement("h1");t.innerHTML=e.message,t.style.position="absolute",t.style.top="20%",t.style.left="10px",t.style.color="black",t.style.backgroundColor="red",document.body.appendChild(t)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device?.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:r}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const r=this.props.onAddHTML(t);r&&(t.innerHTML=r)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.canvasContext?.getPixelSize()||[1,1];let r=1;const n=this.device?.canvasContext?.canvas;return n&&n.clientHeight?r=n.clientWidth/n.clientHeight:e>0&&t>0&&(r=e/t),{width:e,height:t,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}var un=r(147);"undefined"!=typeof window&&(window.website=!0);const hn=e=>{let t="ssr";const[r,s]=(0,n.useState)(null),i=(0,n.useRef)(new WeakMap),a=(0,n.useRef)(null),o=Yr((e=>e.deviceType));return t=e.container||`luma-example-container-${o}`,(0,n.useEffect)((()=>{if(!r||i.current.get(r))return;i.current.set(r,!0);let n=null,s=null;const _=async()=>{r.style.width="100%",r.style.height="100%",s=await X.createDevice({adapters:[_r,Vr],type:o,createCanvasContext:{canvas:r,container:t}}),n=function(e,t){let r=null;const n=t?.device||X.createDevice({id:"animation-loop",adapters:t?.adapters,createCanvasContext:!0}),s=new dn({...t,device:n,onInitialize:async t=>(r=new e(t),await(r?.onInitialize(t))),onRender:e=>r?.onRender(e),onFinalize:e=>r?.onFinalize(e)});return s.getInfo=()=>this.AnimationLoopTemplateCtor.info,s}(e.template,{device:s,autoResizeViewport:!0,autoResizeDrawingBuffer:!0}),n?.start();const i="https://raw.githubusercontent.com/visgl/luma.gl/master";e.directory?(0,un.Qj)(`${i}/examples/${e.directory}/${e.id}/`):(0,un.Qj)(`${i}/website/static/images/`)};return a.current=Promise.resolve(a.current).then((()=>{_().catch((e=>{console.error(`start ${o} failed`,e)}))})),()=>{a.current=Promise.resolve(a.current).then((()=>{n&&(n.destroy(),n=null),s&&s.destroy()})).catch((e=>{console.error(`unmounting ${o} failed`,e)}))}}),[o,r]),n.createElement("canvas",{key:o,ref:s})}},5568:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>_,contentTitle:()=>a,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var n=r(4848),s=r(8453);r(8226);const i={},a="Using GPU Textures",o={id:"api-guide/gpu/gpu-textures",title:"Using GPU Textures",description:"While the idea behind textures is simple in principle (a grid of pixels stored on GPU memory), GPU Textures are surprisingly complex objects.",source:"@site/../docs/api-guide/gpu/gpu-textures.mdx",sourceDirName:"api-guide/gpu",slug:"/api-guide/gpu/gpu-textures",permalink:"/docs/api-guide/gpu/gpu-textures",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/luma.gl/tree/main/docs/../docs/api-guide/gpu/gpu-textures.mdx",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Using GPU Buffers",permalink:"/docs/api-guide/gpu/gpu-buffers"},next:{title:"How Rendering Works",permalink:"/docs/api-guide/gpu/gpu-rendering"}},_={},l=[{value:"Texture Dimension",id:"texture-dimension",level:2},{value:"Texture Formats",id:"texture-formats",level:2},{value:"Compressed Textures",id:"compressed-textures",level:3},{value:"Supercompressed Textures",id:"supercompressed-textures",level:2},{value:"Texture Data",id:"texture-data",level:2},{value:"Texture creation",id:"texture-creation",level:2},{value:"Sampling",id:"sampling",level:2},{value:"Texture filtering",id:"texture-filtering",level:3},{value:"Mipmaps",id:"mipmaps",level:3},{value:"Binding textures",id:"binding-textures",level:2},{value:"Texture Rendering (Writing to Textures on the GPU)",id:"texture-rendering-writing-to-textures-on-the-gpu",level:2},{value:"Blending",id:"blending",level:2},{value:"Data Textures",id:"data-textures",level:2},{value:"Copying Textures",id:"copying-textures",level:2},{value:"Texture Format Capabilities",id:"texture-format-capabilities",level:2}];function E(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"using-gpu-textures",children:"Using GPU Textures"}),"\n",(0,n.jsx)(t.p,{children:"While the idea behind textures is simple in principle (a grid of pixels stored on GPU memory), GPU Textures are surprisingly complex objects."}),"\n",(0,n.jsx)(t.p,{children:"Capabilities"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Shaders can read (sample) from textures"}),"\n",(0,n.jsx)(t.li,{children:"Textures can be set up as render targets (by attaching them to a framebuffer)."}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Arrays"})," Textures can have multiple images (texture arrays, cube textures, 3d textures...), indexed by a ",(0,n.jsx)(t.code,{children:"depth"})," parameter."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Mipmaps"}),' Each texture image can have a "pyramid" of "mipmap" images representing']}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Textures are supported by additional GPU objects:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Samplers"})," - The specifics of how shaders read from textures (interpolation methods, edge behaviors etc) are controlled by ",(0,n.jsx)(t.strong,{children:"GPU Sampler objects"}),". luma.gl will create a default sampler object for each texture, but the application can override if designed"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"TextureViews"})," - A texture view specifies a subset of the images in a texture, enabling operations to be performed on such subsets. luma.gl will create a default TextureView for each texture, but the application can create additional TextureViews."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Framebuffers"}),' - A framebuffer is a map of "attachment points" to one or more textures that can be used when creating ',(0,n.jsx)(t.code,{children:"RenderPasses"})," and made available to shaders."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Setting texture data from CPU data:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:'There is a fast path for setting texture data from "images", that can also be used for 8 bit RGBA data.'}),"\n",(0,n.jsx)(t.li,{children:"General data transfer is more complicated, it needs to go through a GPU Buffer and a CommandEncoder object."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Notes:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Some GPUs offer additional Texture-related capabilities (such as availability of advanced image formats, more formats being filterable or renderable etc)."}),"\n",(0,n.jsxs)(t.li,{children:["Check ",(0,n.jsx)(t.code,{children:"DeviceFeatures"})," if you would like to take advantage of such features to discover what features are implemented by the current ",(0,n.jsx)(t.code,{children:"Device"})," (i.e. the current WebGPU or WebGL environment / browser the application is running on)."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"texture-dimension",children:"Texture Dimension"}),"\n",(0,n.jsx)(t.p,{children:"Most textures tend to be two dimensional textures, however GPUs can support additional configurations"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Dimension"}),(0,n.jsx)(t.th,{children:"WebGPU"}),(0,n.jsx)(t.th,{children:"WebGL2"}),(0,n.jsx)(t.th,{children:"Layout"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"1d"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u274c"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData"})}),(0,n.jsx)(t.td,{children:"Contains a one dimensional texture (for compute)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"2d"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData"})}),(0,n.jsx)(t.td,{children:'Contains a "normal" image texture'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"2d-array"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData[]"})}),(0,n.jsx)(t.td,{children:'Holds an "array" of 2D textures.'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"3d"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData[]"})}),(0,n.jsx)(t.td,{children:'Holds a "stack" of textures which enables 3D interpolation.'})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"cube"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData[6]"})}),(0,n.jsx)(t.td,{children:"Holds 6 textures representing sides of a cube."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"cube-array"})}),(0,n.jsx)(t.td,{children:"\u2705"}),(0,n.jsx)(t.td,{children:"\u274c"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"TextureData[6][]"})}),(0,n.jsx)(t.td,{children:"Holds an array where every 6 textures represent the sides of a cube."})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"Sometimes a composite texture can be used as a unit, but sometimes it is necessary to specify a specific subtexture."}),"\n",(0,n.jsx)(t.h2,{id:"texture-formats",children:"Texture Formats"}),"\n",(0,n.jsx)(t.p,{children:'A "texture format" specifies which components (RGBA) are present in pixels, and how those pixels are stored in GPU memory. This is an important property of a GPU Texture\nwhich must be specified on Texture creation.'}),"\n",(0,n.jsxs)(t.p,{children:["In luma.gl, texture formats are identified using string constants, and the ",(0,n.jsx)(t.code,{children:"TextureFormat"})," type can be used to ensure texture format strings are valid."]}),"\n",(0,n.jsx)(t.p,{children:"The following table lists all the texture formats constants supported by luma.gl (ordered by how many bytes each pixel occupies)."}),"\n",(0,n.jsx)(t.p,{children:"Note that even though a GPU supports creating and sampling textures of a certain format, additional capabilities may need to be checked separatey, more information below the table."}),"\n",(0,n.jsxs)(t.p,{children:["GPUs support a wide range of texture formats. In luma.gl, each format is identified with a string (the ",(0,n.jsx)(t.code,{children:"TextureFormat"})," type)."]}),"\n",(0,n.jsx)(t.h3,{id:"compressed-textures",children:"Compressed Textures"}),"\n",(0,n.jsx)(t.p,{children:"Compressed textures refers to textures that are compressed in a way that can be decompressed performantly on the GPU during sampling.\nSuch textures do not need to be decompressed fully (neither on CPU or GPU) but can be uploaded directly to the GPU in their compressed format, and will remain compressed there.\nThere are some considerations when using compressed textures as support varies between devices, so assets must typically be prepared in multiple formats."}),"\n",(0,n.jsxs)(t.p,{children:["For more information, see e.g. ",(0,n.jsx)(t.a,{href:"https://aras-p.info/blog/2020/12/08/Texture-Compression-in-2020/",children:"Compressed Textures in 2020"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["For supported compressed texture formats, see ",(0,n.jsx)(t.a,{href:"/docs/api-reference/core/texture-formats",children:"Texture Formats"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"supercompressed-textures",children:"Supercompressed Textures"}),"\n",(0,n.jsx)(t.p,{children:"Supercompressed textures solve the portability problem of compressed textures by\ndefining a common super-compressed format which can be decoded after load into a supported compressed texture format."}),"\n",(0,n.jsxs)(t.p,{children:["To use Basis supercompressed textures in luma.gl, see the ",(0,n.jsx)(t.a,{href:"https://loaders.gl",children:"loaders.gl"})," ",(0,n.jsx)(t.code,{children:"BasisLoader"})," which can extract compressed textures from a basis encoded texture."]}),"\n",(0,n.jsx)(t.h2,{id:"texture-data",children:"Texture Data"}),"\n",(0,n.jsx)(t.p,{children:"The textures may not be completely packed, there may be padding (per row)"}),"\n",(0,n.jsx)(t.h2,{id:"texture-creation",children:"Texture creation"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-typescript",children:"const texture = device.createTexture({});\n"})}),"\n",(0,n.jsx)(t.h2,{id:"sampling",children:"Sampling"}),"\n",(0,n.jsx)(t.p,{children:"A primary purpose of textures is to allow the GPU to read from them."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-glsl",children:"  vec4 texel = sampler2D(texture)\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-wgsl"})}),"\n",(0,n.jsx)(t.h3,{id:"texture-filtering",children:"Texture filtering"}),"\n",(0,n.jsx)(t.p,{children:"Texture formats that are filterable can be interpolated by the GPI"}),"\n",(0,n.jsxs)(t.p,{children:["Filtering is specified using a separate ",(0,n.jsx)(t.code,{children:"Sampler"})," object."]}),"\n",(0,n.jsx)(t.p,{children:"Sampling is a sophisticated process"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"magnification"}),"\n",(0,n.jsx)(t.li,{children:"minification"}),"\n",(0,n.jsx)(t.li,{children:"anistropy"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The parameters used for sampling is specified in a sampler object."}),"\n",(0,n.jsx)(t.h3,{id:"mipmaps",children:"Mipmaps"}),"\n",(0,n.jsx)(t.p,{children:"To improve samling mipmaps can be included in a texture. Mipmaps are a pyramid of lower resolution images that are used when the texture is sampled at a distance.\nMipmaps can be generated automatically by the GPU, or can be provided by the application."}),"\n",(0,n.jsxs)(t.p,{children:["Mipmap usage is controller via ",(0,n.jsx)(t.code,{children:"SamplerProps.mipmapFilter"}),":"]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:(0,n.jsx)(t.code,{children:"mipmapFilter"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.code,{children:"minFilter"})}),(0,n.jsx)(t.th,{children:"Description"}),(0,n.jsx)(t.th,{children:"Linearity"}),(0,n.jsx)(t.th,{children:"Speed"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"none"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"nearest"})}),(0,n.jsx)(t.td,{children:"Mo filtering, no mipmaps"}),(0,n.jsx)(t.td,{}),(0,n.jsx)(t.td,{})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"none"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"linear"})}),(0,n.jsx)(t.td,{children:"Filtering, no mipmaps"}),(0,n.jsx)(t.td,{children:"bilinear"}),(0,n.jsx)(t.td,{children:"slowest *"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"nearest"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"nearest"})}),(0,n.jsx)(t.td,{children:"No filtering, sharp switching between mipmaps"}),(0,n.jsx)(t.td,{}),(0,n.jsx)(t.td,{})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"nearest"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"linear"})}),(0,n.jsx)(t.td,{children:"No filtering, smooth transition between mipmaps"}),(0,n.jsx)(t.td,{}),(0,n.jsx)(t.td,{})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"linear"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"nearest"})}),(0,n.jsx)(t.td,{children:"Filtering, sharp switching between mipmaps"}),(0,n.jsx)(t.td,{children:"bilinear with mipmaps"}),(0,n.jsx)(t.td,{children:"fastest *"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"linear"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"linear"})}),(0,n.jsx)(t.td,{children:"Filtering, smooth transition between mipmaps"}),(0,n.jsx)(t.td,{children:"trilinear"}),(0,n.jsx)(t.td,{})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"Performance typically depends on texture LOD, and perhaps surprisingly, mipmaps not only improve visual quality, but can also improve performance. When a scaled down, lower quality mipmap is selected it reduces memory bandwidth requirements."}),"\n",(0,n.jsx)(t.p,{children:"Texture filtering is considered bilinear because it is a linear filter that is applied in two directions, sequentially. First, a linear filter is applied along the image's x axis (width), and then a second filter is applied along the y axis (height). This is why bilinear filtering is sometimes referred to as linear/bilinear."}),"\n",(0,n.jsx)(t.h2,{id:"binding-textures",children:"Binding textures"}),"\n",(0,n.jsx)(t.p,{children:"Before textures can be sampled in the"}),"\n",(0,n.jsx)(t.h2,{id:"texture-rendering-writing-to-textures-on-the-gpu",children:"Texture Rendering (Writing to Textures on the GPU)"}),"\n",(0,n.jsx)(t.p,{children:"Texture formats that are renderable can be bound to framebuffer attachments so that shaders can write to them."}),"\n",(0,n.jsx)(t.h2,{id:"blending",children:"Blending"}),"\n",(0,n.jsx)(t.h2,{id:"data-textures",children:"Data Textures"}),"\n",(0,n.jsx)(t.p,{children:"In WebGPU/WGSL, textures can be used with compute shaders through storage bindings."}),"\n",(0,n.jsx)(t.h2,{id:"copying-textures",children:"Copying Textures"}),"\n",(0,n.jsxs)(t.p,{children:["Texture data can be copied between GPU and CPU and vice versa, via GPU Buffers. See ",(0,n.jsx)(t.code,{children:"CommandEncoder"})," for more information."]}),"\n",(0,n.jsx)(t.h2,{id:"texture-format-capabilities",children:"Texture Format Capabilities"}),"\n",(0,n.jsxs)(t.p,{children:["Even though a device allows a ",(0,n.jsx)(t.code,{children:"Texture"})," to be created with a certain texture format, there may still be limitations in what operations can be done with that texture.\nluma provides ",(0,n.jsx)(t.code,{children:"Device"})," methods to help applications determine the capabilities of a texture format."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Can textures with the format..."}),(0,n.jsx)(t.th,{children:"Check using"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["be ",(0,n.jsx)(t.strong,{children:"created and sampled"})," (using ",(0,n.jsx)(t.code,{children:"nearest"})," filters)?"]}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"device.isTextureFormatSupported(format)"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["be sampled using ",(0,n.jsx)(t.strong,{children:"linear filtering"}),"?"]}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"device.isTextureFormatFilterable(format)"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"be rendered into? (render targets / color attachments)"}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"device.isTextureFormatRenderable(format)"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"be used for storage bindings?"}),(0,n.jsx)(t.td,{children:"N/A"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"be blended?"}),(0,n.jsxs)(t.td,{children:["Yes, if sampler type ",(0,n.jsx)(t.code,{children:"float"})," is supported"]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"support multisampling?"}),(0,n.jsx)(t.td,{children:"N/A"})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"Remarks"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Mipmaps can only be auto created for formats that are both filterable and renderable."}),"\n",(0,n.jsx)(t.li,{children:"A renderable format is either a color renderable format, or a depth-or-stencil format"}),"\n",(0,n.jsx)(t.li,{children:"All depth/stencil formats are renderable."}),"\n",(0,n.jsxs)(t.li,{children:['Samplers always read a "vec4" regardless of which texture format is used. For formats with less than 4 components, missing red, green and blue components in the texture format are read as ',(0,n.jsx)(t.code,{children:"0.0"}),", alpha as ",(0,n.jsx)(t.code,{children:"1.0"}),"/"]}),"\n",(0,n.jsx)(t.li,{children:"Note that some formats are not mandated by the base standard but represent additional capabilities (e.g. a WebGL2 device running on top of an OpenGL ES 3.2 driver). ."}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(E,{...e})}):E(e)}},1020:(e,t,r)=>{var n=r(6540),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,E=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(E=t.ref),t)a.call(t,n)&&!_.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:s,type:e,key:l,ref:E,props:i,_owner:o.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},4848:(e,t,r)=>{e.exports=r(1020)},8453:(e,t,r)=>{r.d(t,{R:()=>a,x:()=>o});var n=r(6540);const s={},i=n.createContext(s);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);