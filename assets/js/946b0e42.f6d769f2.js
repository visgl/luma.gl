/*! For license information please see 946b0e42.f6d769f2.js.LICENSE.txt */
"use strict";(self.webpackChunkwebsite_docusaurus=self.webpackChunkwebsite_docusaurus||[]).push([[8875],{7271:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});var s=n(4848),o=n(8453);const i={},d="TransformFeedback",t={id:"api-reference/core/resources/transform-feedback",title:"TransformFeedback",description:"WebGPU not supported",source:"@site/../docs/api-reference/core/resources/transform-feedback.md",sourceDirName:"api-reference/core/resources",slug:"/api-reference/core/resources/transform-feedback",permalink:"/docs/api-reference/core/resources/transform-feedback",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/luma.gl/tree/main/docs/../docs/api-reference/core/resources/transform-feedback.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"TextureView",permalink:"/docs/api-reference/core/resources/texture-view"},next:{title:"QuerySet",permalink:"/docs/api-reference/core/resources/query-set"}},c={},l=[{value:"Usage",id:"usage",level:2},{value:"Properties",id:"properties",level:2},{value:"Methods",id:"methods",level:2},{value:"constructor(device : WebGLDevice, props: TransformFeedbackProps)",id:"constructordevice--webgldevice-props-transformfeedbackprops",level:3},{value:"destroy() : void",id:"destroy--void",level:3},{value:"setBuffers(buffers: Object) : void",id:"setbuffersbuffers-object--void",level:3},{value:"begin(topology : PrimitiveTopology = &#39;point-list&#39;) : void",id:"begintopology--primitivetopology--point-list--void",level:3},{value:"end() : void",id:"end--void",level:3},{value:"Enumerations",id:"enumerations",level:2},{value:"Limits",id:"limits",level:2},{value:"Remarks",id:"remarks",level:2}];function a(e){const r={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h1,{id:"transformfeedback",children:"TransformFeedback"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://img.shields.io/badge/webgpu-no-red.svg?style=flat-square%22",alt:"WebGPU not supported"})}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsxs)(r.p,{children:["NOTICE: ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," is only available in WebGL 2. It is not recommend for applications to use these objects directly. See the ",(0,s.jsx)(r.code,{children:"BufferTransform"})," class."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"TransformFeedback"})," objects hold state needed to perform ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGLTransformFeedback",children:"WebGLTransformFeedback"})," operations, which capture the output of a vertex shader to varyings in a buffer. Each ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," object holds buffer bindings used to store output, allowing applications to switch between different ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," objects and update bindings, similar to how ",(0,s.jsx)(r.code,{children:"VertexArrayObjects"})," hold input vertex buffers."]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"TransformFeedback"})," objects must assigned to a ",(0,s.jsx)(r.code,{children:"Model"})," with the appropriate varyings. Some caveats apply, see ",(0,s.jsx)(r.a,{href:"#remarks",children:"remarks"}),"."]}),"\n",(0,s.jsxs)(r.p,{children:["When using transform feedback, it is usually desirable to turn off rasterization to prevent the fragment shader from running unnecessarily. This can be achieved by setting the ",(0,s.jsx)(r.code,{children:"discard: true"})," option when creating a render pipeline."]}),"\n",(0,s.jsxs)(r.p,{children:["For more information, see ",(0,s.jsx)(r.a,{href:"https://www.khronos.org/opengl/wiki/Transform_Feedback",children:"OpenGL Wiki"}),"."]}),"\n",(0,s.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsxs)(r.p,{children:["Create a ",(0,s.jsx)(r.code,{children:"Model"})," for transform feedback operations."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"return new Model(device, {\n  vs,\n  fs,\n  vertexCount,\n  topology: 'point-list'\n  attributes: {inValue: buffer},\n  bufferLayout: [{name: 'inValue', format: 'float32'}],\n  varyings: ['outValue'],\n});\n"})}),"\n",(0,s.jsxs)(r.p,{children:["Create a ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," and assign output buffers."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const transformFeedback = device.createTransformFeedback({\n  layout: model.pipeline.shaderLayout,\n  buffers: {0: positionBuffer, 1: colorBuffer}\n});\n\nmodel.setTransformFeedback(transformFeedback);\n"})}),"\n",(0,s.jsxs)(r.p,{children:["When binding the buffers, index should be equal to the corresponding varying entry in ",(0,s.jsx)(r.code,{children:"varyings"})," array passed to ",(0,s.jsx)(r.code,{children:"Model"}),". Buffers can also be bound using varying name, and resolved using the model's associated ",(0,s.jsx)(r.code,{children:"Pipeline"})," and ",(0,s.jsx)(r.code,{children:"ShaderLayout"}),"."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const transformFeedback = device.createTransformFeedback({\n  layout: model.pipeline.shaderLayout,\n  buffers: {\n    outputColor: bufferColor,\n    gl_Position: bufferPosition\n  }\n});\n"})}),"\n",(0,s.jsxs)(r.p,{children:["To run a ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," operation, draw a Model with an associated ",(0,s.jsx)(r.code,{children:"TransformFeedback"}),". Optionally, set ",(0,s.jsx)(r.code,{children:"discard"})," to avoid unnecessary\nrasterization while performing the operation."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const renderPass = device.beginRenderPass({discard: true});\n\nmodel.draw(renderPass);\n\nrenderPass.end();\n"})}),"\n",(0,s.jsx)(r.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:".bindOnUse"})," = ",(0,s.jsx)(r.code,{children:"true"})," - If true, binds and unbinds buffers before and after use, rather than right away when set. Workaround for a possible ",(0,s.jsx)(r.a,{href:"https://github.com/KhronosGroup/WebGL/issues/2346",children:"Khronos/Chrome bug"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(r.h3,{id:"constructordevice--webgldevice-props-transformfeedbackprops",children:"constructor(device : WebGLDevice, props: TransformFeedbackProps)"}),"\n",(0,s.jsxs)(r.p,{children:["Requires a WebGL 2 device. See ",(0,s.jsx)(r.code,{children:"TransformFeedbackProps"})," for props. ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," instances should be created by ",(0,s.jsx)(r.code,{children:"Device#createTransformFeedback"}),", rather than using the constructor directly."]}),"\n",(0,s.jsxs)(r.p,{children:["WebGL APIs ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/createTransformFeedback",children:(0,s.jsx)(r.code,{children:"gl.createTransformFeedback"})})]}),"\n",(0,s.jsx)(r.p,{children:"Props:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"props.layout"})," = (",(0,s.jsx)(r.code,{children:"ShaderLayout"}),") - Layout of shader (for varyings)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"props.buffers"})," = (Object) - Map of location index or name to Buffer or BufferRange object. Used for varyings. If buffer parameters object is supplied, it contains following fields.","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"buffer"})," = (",(0,s.jsx)(r.code,{children:"Buffer"}),") - Buffer object to be bound."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"byteOffset"}),"= (Number, default: 0) - Byte offset for writes into the buffer."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"byteLength"}),"= (Number, default: buffer.byteLength) - Byte length, from offset, available for writes into the buffer."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Notes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"buffers"})," - will get bound to indices in the ",(0,s.jsx)(r.code,{children:"GL.TRANSFORM_FEEDBACK_BUFFER"})," target."]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"destroy--void",children:"destroy() : void"}),"\n",(0,s.jsxs)(r.p,{children:["Destroys a ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," object."]}),"\n",(0,s.jsxs)(r.p,{children:["WebGL APIs ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/deleteTransformFeedback",children:(0,s.jsx)(r.code,{children:"gl.deleteTransformFeedback"})})]}),"\n",(0,s.jsx)(r.h3,{id:"setbuffersbuffers-object--void",children:"setBuffers(buffers: Object) : void"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"buffers"})," = (Object) - Map of location index or name to Buffer or BufferRange object. Used for varyings. If buffer parameters object is supplied, it contains following fields.","\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"buffer"})," = (Buffer) - Buffer object to be bound."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"byteOffset"})," = (Number, default: 0) - Byte offset for writes into the buffer."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"byteLength"})," = (Number, default: buffer.byteLength) - Byte length, from offset, available for writes into the buffer."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Notes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["To use ",(0,s.jsx)(r.code,{children:"gl.bindBufferRange"}),", ",(0,s.jsx)(r.code,{children:"byteLength"})," must be specified. When not specified, ",(0,s.jsx)(r.code,{children:"gl.bindBufferBase"})," is used for binding."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["WebGL APIs ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/bindBufferBase",children:(0,s.jsx)(r.code,{children:"gl.bindBufferBase"})}),", ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/bindBufferRange",children:(0,s.jsx)(r.code,{children:"gl.bindBufferRange"})})]}),"\n",(0,s.jsx)(r.h3,{id:"begintopology--primitivetopology--point-list--void",children:"begin(topology : PrimitiveTopology = 'point-list') : void"}),"\n",(0,s.jsxs)(r.p,{children:["Activates transform feedback using the buffer bindings in this ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," object."]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"primitiveMode"})," (",(0,s.jsx)(r.code,{children:"PrimitiveTopology"}),") - See WebGPU's ",(0,s.jsx)(r.a,{href:"https://www.w3.org/TR/webgpu/#enumdef-gpuprimitivetopology",children:"GPUPrimitiveTopology"}),"."]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"Notes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["Buffers can not be accessed until ",(0,s.jsx)(r.code,{children:"TransformFeedback.end"})," or ",(0,s.jsx)(r.code,{children:"TransformFeedback.pause"})," have been called."]}),"\n",(0,s.jsxs)(r.li,{children:["Buffers can not be changed until ",(0,s.jsx)(r.code,{children:"TransformFeedback.end"})," or has been called, which includes doing anything which reads from or writes to any part of these buffers (outside of feedback writes, of course, or reallocating storage for any of these buffers)."]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["WebGL APIs ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/beginTransformFeedback",children:(0,s.jsx)(r.code,{children:"gl.beginTransformFeedback"})})]}),"\n",(0,s.jsx)(r.h3,{id:"end--void",children:"end() : void"}),"\n",(0,s.jsx)(r.p,{children:"Ends transform feedback operation, allowing access and changes to Buffers."}),"\n",(0,s.jsxs)(r.p,{children:["WebGL APIs ",(0,s.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/endTransformFeedback",children:(0,s.jsx)(r.code,{children:"gl.endTransformFeedback"})})]}),"\n",(0,s.jsx)(r.h2,{id:"enumerations",children:"Enumerations"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Primitive Mode"}),(0,s.jsx)(r.th,{children:"Compatible Topology"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.POINTS"})}),(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"point-list"})})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.LINES"})}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"line-list"}),", ",(0,s.jsx)(r.code,{children:"line-strip"})]})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.TRIANGLES"})}),(0,s.jsxs)(r.td,{children:[(0,s.jsx)(r.code,{children:"triangle-list"}),", ",(0,s.jsx)(r.code,{children:"triangle-strip"})]})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"limits",children:"Limits"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Limit"}),(0,s.jsx)(r.th,{children:"Value"}),(0,s.jsx)(r.th,{children:"Description"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS"})}),(0,s.jsx)(r.td,{children:">=4"}),(0,s.jsx)(r.td,{children:"total number of variables that can be captured }"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS"})}),(0,s.jsx)(r.td,{children:">=4"}),(0,s.jsx)(r.td,{children:"number of components that any particular variable can contain"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS"})}),(0,s.jsx)(r.td,{children:">= 64"}),(0,s.jsx)(r.td,{children:"total number of components in interleaved capture"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.code,{children:"GL.MAX_TRANSFORM_FEEDBACK_BUFFERS"})}),(0,s.jsx)(r.td,{children:"TBD"}),(0,s.jsx)(r.td,{children:"Advanced interleaving total number of buffers"})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"remarks",children:"Remarks"}),"\n",(0,s.jsxs)(r.p,{children:["About ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," activation caveats"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["When activated, ",(0,s.jsx)(r.code,{children:"TransformFeedback"})," is coupled to the current ",(0,s.jsx)(r.code,{children:"Model"}),"."]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"TransformFeedback#begin"})," prevents the app from changing or re-linking the current program. So for instance, ",(0,s.jsx)(r.code,{children:"Program.use"})," (",(0,s.jsx)(r.code,{children:"gl.useProgram"}),") cannot be called until after calling ",(0,s.jsx)(r.code,{children:"TransformFeedback#end"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},1020:(e,r,n)=>{var s=n(6540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,t=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,r,n){var s,i={},l=null,a=null;for(s in void 0!==n&&(l=""+n),void 0!==r.key&&(l=""+r.key),void 0!==r.ref&&(a=r.ref),r)d.call(r,s)&&!c.hasOwnProperty(s)&&(i[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps)void 0===i[s]&&(i[s]=r[s]);return{$$typeof:o,type:e,key:l,ref:a,props:i,_owner:t.current}}r.Fragment=i,r.jsx=l,r.jsxs=l},4848:(e,r,n)=>{e.exports=n(1020)},8453:(e,r,n)=>{n.d(r,{R:()=>d,x:()=>t});var s=n(6540);const o={},i=s.createContext(o);function d(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);