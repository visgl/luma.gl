/*! For license information please see 1268d5ff.f8dfb9ee.js.LICENSE.txt */
"use strict";(self.webpackChunkwebsite_docusaurus=self.webpackChunkwebsite_docusaurus||[]).push([[8149],{5358:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var n=s(4848),t=s(8453);const i={},c="QuerySet",d={id:"api-reference/core/resources/query-set",title:"QuerySet",description:"This page is incomplete.",source:"@site/../docs/api-reference/core/resources/query-set.md",sourceDirName:"api-reference/core/resources",slug:"/api-reference/core/resources/query-set",permalink:"/docs/api-reference/core/resources/query-set",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/luma.gl/tree/main/docs/../docs/api-reference/core/resources/query-set.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"TransformFeedback",permalink:"/docs/api-reference/core/resources/transform-feedback"},next:{title:"VertexArray",permalink:"/docs/api-reference/core/resources/vertex-array"}},o={},l=[{value:"Usage",id:"usage",level:2},{value:"Types",id:"types",level:2},{value:"<code>QueryProps</code>",id:"queryprops",level:3},{value:"DeviceFeatures",id:"devicefeatures",level:2},{value:"Methods",id:"methods",level:2},{value:"<code>constructor(device: Device, props: Object)</code>",id:"constructordevice-device-props-object",level:3},{value:"<code>destroy()</code>",id:"destroy",level:3},{value:"beginTimeElapsedQuery()",id:"begintimeelapsedquery",level:3},{value:"RenderPass",id:"renderpass",level:2},{value:"<code>RenderPass.beginOcclusionQuery({conservative = false})</code>",id:"renderpassbeginocclusionqueryconservative--false",level:3},{value:"<code>RenderPass.beginTransformFeedbackQuery()</code>",id:"renderpassbegintransformfeedbackquery",level:3}];function a(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"queryset",children:"QuerySet"}),"\n",(0,n.jsx)(r.admonition,{type:"caution",children:(0,n.jsx)(r.p,{children:"This page is incomplete."})}),"\n",(0,n.jsxs)(r.p,{children:["A ",(0,n.jsx)(r.code,{children:"QuerySet"})," object provides an API for using asynchronous GPU queries of the following types"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"timer queries."}),"\n",(0,n.jsx)(r.li,{children:"'Occlusion'"}),"\n",(0,n.jsx)(r.li,{children:"'Transform Feedback'"}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["A ",(0,n.jsx)(r.code,{children:"QuerySet"})," holds a number of 64 bit values."]}),"\n",(0,n.jsxs)(r.p,{children:["Timer queries are available if the ",(0,n.jsx)(r.code,{children:"timestamp-query"})," extension is available. (On WebGL 2 this is equivalent to the\n",(0,n.jsx)(r.a,{href:"https://www.khronos.org/registry/webgl/extensions/EXT_disjoint_timer_query_webgl2/",children:(0,n.jsx)(r.code,{children:"EXT_disjoint_timer_query_webgl2"})}),"\nbeing supported on the current browser."]}),"\n",(0,n.jsx)(r.p,{children:"Note that even when supported, timer queries can fail whenever a change in the GPU occurs that will make the values returned by this extension unusable for performance metrics, for example if the GPU is throttled mid-frame."}),"\n",(0,n.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(r.p,{children:"Create a timestamp query set:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"import {QuerySet} from '@luma.gl/core';\n...\nconst timestampQuery = device.createQuerySet({type: 'timestamp'}});\n"})}),"\n",(0,n.jsx)(r.h2,{id:"types",children:"Types"}),"\n",(0,n.jsx)(r.h3,{id:"queryprops",children:(0,n.jsx)(r.code,{children:"QueryProps"})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"type"}),": ",(0,n.jsx)(r.code,{children:"occlusion"})," | ",(0,n.jsx)(r.code,{children:"timestamp"})," - type of timer"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"count"}),": ",(0,n.jsx)(r.code,{children:"number"})," - number of query results held by this ",(0,n.jsx)(r.code,{children:"QuerySet"})]}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Query Type"}),(0,n.jsx)(r.th,{children:"Usage"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"timestamp"})," (",(0,n.jsx)(r.code,{children:"RenderPass begin/end"}),")"]}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"beginRenderPass({timestampQuery: ...})"})}),(0,n.jsx)(r.td,{children:"Time taken by GPU to execute RenderPass commands"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"timestamp"}),"  (",(0,n.jsx)(r.code,{children:"ComputePass begin/end"}),")"]}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"beginComputePass({timestampQuery: ...})"})}),(0,n.jsx)(r.td,{children:"Time taken by GPU to execute ComputePass commands"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"occlusion"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"beginOcclusionQuery({conservative: false})"})}),(0,n.jsx)(r.td,{children:"Occlusion query how many fragment samples pass tests (depth, stencil, ...)"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"occlusion"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"beginOcclusionQuery({conservative: true})"})}),(0,n.jsx)(r.td,{children:"Same as above above, but less accurate and faster"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"transform-feedback"})," (Not yet supported)"]}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"beginTransformFeedbackQuery()"})}),(0,n.jsx)(r.td,{children:"Number of primitives that are written to transform feedback buffers."})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["In addition to above queries, Query object also provides ",(0,n.jsx)(r.code,{children:"getTimeStamp"})," which returns GPU time stamp at the time this query is executed by GPU. Two sets of these methods can be used to calculate time taken by GPU for a set of GL commands."]}),"\n",(0,n.jsx)(r.h2,{id:"devicefeatures",children:"DeviceFeatures"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.code,{children:"timestamp-query"}),": Whether ",(0,n.jsx)(r.code,{children:"QuerySet"})," can be created with type ",(0,n.jsx)(r.code,{children:"timestamp"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(r.h3,{id:"constructordevice-device-props-object",children:(0,n.jsx)(r.code,{children:"constructor(device: Device, props: Object)"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.code,{children:"new Query(gl, {})"})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"options.timers=false Object - If true, checks if 'TIME_ELAPSED_EXT' queries are supported"}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"destroy",children:(0,n.jsx)(r.code,{children:"destroy()"})}),"\n",(0,n.jsx)(r.p,{children:"Destroys the WebGL object. Rejects any pending query."}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"return Query - returns itself, to enable chaining of calls."}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"begintimeelapsedquery",children:"beginTimeElapsedQuery()"}),"\n",(0,n.jsx)(r.p,{children:"Shortcut for timer query (dependent on extension in both WebGL 1 and 2)"}),"\n",(0,n.jsx)(r.h2,{id:"renderpass",children:"RenderPass"}),"\n",(0,n.jsx)(r.h3,{id:"renderpassbeginocclusionqueryconservative--false",children:(0,n.jsx)(r.code,{children:"RenderPass.beginOcclusionQuery({conservative = false})"})}),"\n",(0,n.jsx)(r.p,{children:"Shortcut for occlusion query (dependent on WebGL 2)"}),"\n",(0,n.jsx)(r.h3,{id:"renderpassbegintransformfeedbackquery",children:(0,n.jsx)(r.code,{children:"RenderPass.beginTransformFeedbackQuery()"})}),"\n",(0,n.jsx)(r.p,{children:"WebGL 2 only. not yet implemented."})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},1020:(e,r,s)=>{var n=s(6540),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(e,r,s){var n,i={},l=null,a=null;for(n in void 0!==s&&(l=""+s),void 0!==r.key&&(l=""+r.key),void 0!==r.ref&&(a=r.ref),r)c.call(r,n)&&!o.hasOwnProperty(n)&&(i[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===i[n]&&(i[n]=r[n]);return{$$typeof:t,type:e,key:l,ref:a,props:i,_owner:d.current}}r.Fragment=i,r.jsx=l,r.jsxs=l},4848:(e,r,s)=>{e.exports=s(1020)},8453:(e,r,s)=>{s.d(r,{R:()=>c,x:()=>d});var n=s(6540);const t={},i=n.createContext(t);function c(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);