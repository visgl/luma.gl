"use strict";(self.webpackChunkwebsite_docusaurus=self.webpackChunkwebsite_docusaurus||[]).push([[407],{7406:(e,t,r)=>{r.d(t,{M:()=>u,P:()=>o});var n=r(3845),i=r(8862),a=r(7172),s=r(18);function o(e,t){for(var r,i={},a=(0,n.A)(e.attributes);!(r=a()).done;){var s=r.value,o=c(e,t,s.name);o&&(i[s.name]=o)}return i}function u(e,t,r){void 0===r&&(r=16);for(var n=o(e,t),i=new Array(r).fill(null),a=0,s=Object.values(n);a<s.length;a++){var u=s[a];i[u.location]=u}return i}function c(e,t,r){var o=function(e,t){var r=e.attributes.find((function(e){return e.name===t}));r||i.R.warn('shader layout attribute "'+t+'" not present in shader');return r||null}(e,r),u=function(e,t){l(e);var r=function(e,t){for(var r,i=(0,n.A)(e);!(r=i()).done;){var a=r.value;if(a.format&&a.name===t)return{attributeName:a.name,bufferName:t,stepMode:a.stepMode,vertexFormat:a.format,byteOffset:0,byteStride:a.byteStride||0}}return null}(e,t);if(r)return r;if(r=function(e,t){for(var r,i=(0,n.A)(e);!(r=i()).done;){var a,o=r.value,u=o.byteStride;if("number"!=typeof o.byteStride)for(var c,l=(0,n.A)(o.attributes||[]);!(c=l()).done;){var f=c.value;u+=(0,s.yx)(f.format).byteLength}var h=null==(a=o.attributes)?void 0:a.find((function(e){return e.attribute===t}));if(h)return{attributeName:h.attribute,bufferName:o.name,stepMode:o.stepMode,vertexFormat:h.format,byteOffset:h.byteOffset,byteStride:u}}return null}(e,t),r)return r;return i.R.warn('layout for attribute "'+t+'" not present in buffer layout'),null}(t,r);if(!o)return null;var c=(0,a.wH)(o.type),f=(0,s.Mz)(c),h=(null==u?void 0:u.vertexFormat)||f,d=(0,s.yx)(h);return{attributeName:(null==u?void 0:u.attributeName)||o.name,bufferName:(null==u?void 0:u.bufferName)||o.name,location:o.location,shaderType:o.type,primitiveType:c.primitiveType,shaderComponents:c.components,vertexFormat:h,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:c.integer,stepMode:(null==u?void 0:u.stepMode)||o.stepMode||"vertex",byteOffset:(null==u?void 0:u.byteOffset)||0,byteStride:(null==u?void 0:u.byteStride)||0}}function l(e){for(var t,r=(0,n.A)(e);!(t=r()).done;){var a=t.value;(a.attributes&&a.format||!a.attributes&&!a.format)&&i.R.warn("BufferLayout "+name+" must have either 'attributes' or 'format' field")}}},6555:(e,t,r)=>{r.d(t,{Q:()=>a});var n=r(6769),i=r(1010);var a=function(){t.isHTMLCanvas=function(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement},t.isOffscreenCanvas=function(e){return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas};var e=t.prototype;function t(e){var r,a,o,u,c=this;if(this.isInitialized=!1,this.isVisible=!0,this._initializedResolvers={promise:new Promise((function(e,t){o=e,u=t})),resolve:o,reject:u},this.destroyed=!1,this.props=Object.assign({},t.defaultProps,e),e=this.props,this.initialized=this._initializedResolvers.promise,(0,n.B)()?e.canvas?"string"==typeof e.canvas?this.canvas=s(e.canvas):this.canvas=e.canvas:this.canvas=function(e){var t=e.width,r=e.height,n=document.createElement("canvas");n.id=(0,i.L)("lumagl-auto-created-canvas"),n.width=t||1,n.height=r||1,n.style.width=Number.isFinite(t)?t+"px":"100%",n.style.height=Number.isFinite(r)?r+"px":"100%",null!=e&&e.visible||(n.style.visibility="hidden");var a=function(e){if("string"==typeof e){var t=document.getElementById(e);if(!t)throw new Error(e+" is not an HTML element");return t}if(e)return e;return document.body}((null==e?void 0:e.container)||null);return a.insertBefore(n,a.firstChild),n}(e):this.canvas={width:e.width||1,height:e.height||1},t.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):t.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=(null==(r=this.htmlCanvas)?void 0:r.clientWidth)||this.canvas.width,this.cssHeight=(null==(a=this.htmlCanvas)?void 0:a.clientHeight)||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],t.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver((function(e){return c._handleIntersection(e)})),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver((function(e){return c._handleResize(e)}));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch(l){this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout((function(){return c._observeDevicePixelRatio()}),0),this.props.trackPosition&&this._trackPosition()}}return e.toString=function(){return this[Symbol.toStringTag]+"("+this.id+")"},e.destroy=function(){this.destroyed=!0},e.setProps=function(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this},e.getCSSSize=function(){return[this.cssWidth,this.cssHeight]},e.getPosition=function(){return this._position},e.getDevicePixelSize=function(){return[this.devicePixelWidth,this.devicePixelHeight]},e.getDrawingBufferSize=function(){return[this.drawingBufferWidth,this.drawingBufferHeight]},e.getMaxDrawingBufferSize=function(){var e=this.device.limits.maxTextureDimension2D;return[e,e]},e.setDrawingBufferSize=function(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t},e.getDevicePixelRatio=function(){return"undefined"!=typeof window&&window.devicePixelRatio||1},e.cssToDevicePixels=function(e,t){void 0===t&&(t=!0);var r=this.cssToDeviceRatio(),n=this.getDrawingBufferSize();return function(e,t,r,n,i){var a,s=e,c=o(s[0],t,r),l=u(s[1],t,n,i),f=o(s[0]+1,t,r),h=f===r-1?f:f-1;f=u(s[1]+1,t,n,i),i?(a=l,l=f=0===f?f:f+1):a=f===n-1?f:f-1;return{x:c,y:l,width:Math.max(h-c+1,1),height:Math.max(a-l+1,1)}}(e,r,n[0],n[1],t)},e.getPixelSize=function(){return this.getDevicePixelSize()},e.getAspect=function(){var e=this.getDevicePixelSize();return e[0]/e[1]},e.cssToDeviceRatio=function(){try{var e=this.getDrawingBufferSize()[0],t=this.getCSSSize()[0];return t?e/t:1}catch(r){return 1}},e.resize=function(e){this.setDrawingBufferSize(e.width,e.height)},e._setAutoCreatedCanvasId=function(e){var t;"lumagl-auto-created-canvas"===(null==(t=this.htmlCanvas)?void 0:t.id)&&(this.htmlCanvas.id=e)},e._handleIntersection=function(e){var t=this,r=e.find((function(e){return e.target===t.canvas}));if(r){var n=r.isIntersecting;this.isVisible!==n&&(this.isVisible=n,this.device.props.onVisibilityChange(this))}},e._handleResize=function(e){var t,r,n=this,i=e.find((function(e){return e.target===n.canvas}));if(i){this.cssWidth=i.contentBoxSize[0].inlineSize,this.cssHeight=i.contentBoxSize[0].blockSize;var a=this.getDevicePixelSize(),s=(null==(t=i.devicePixelContentBoxSize)?void 0:t[0].inlineSize)||i.contentBoxSize[0].inlineSize*devicePixelRatio,o=(null==(r=i.devicePixelContentBoxSize)?void 0:r[0].blockSize)||i.contentBoxSize[0].blockSize*devicePixelRatio,u=this.getMaxDrawingBufferSize(),c=u[0],l=u[1];this.devicePixelWidth=Math.max(1,Math.min(s,c)),this.devicePixelHeight=Math.max(1,Math.min(o,l)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:a})}},e._updateDrawingBufferSize=function(){if(this.props.autoResize){if("number"==typeof this.props.useDevicePixels){var e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()},e._observeDevicePixelRatio=function(){var e=this,t=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:t}),matchMedia("(resolution: "+this.devicePixelRatio+"dppx)").addEventListener("change",(function(){return e._observeDevicePixelRatio()}),{once:!0})},e._trackPosition=function(e){var t=this;void 0===e&&(e=100);var r=setInterval((function(){t.destroyed?clearInterval(r):t.updatePosition()}),e)},e.updatePosition=function(){var e,t=null==(e=this.htmlCanvas)?void 0:e.getBoundingClientRect();if(t){var r=[t.left,t.top];if(null!=this._position||(this._position=r),r[0]!==this._position[0]||r[1]!==this._position[1]){var n,i,a=this._position;this._position=r,null==(n=(i=this.device.props).onPositionChange)||n.call(i,this,{oldPosition:a})}}},t}();function s(e){var t=document.getElementById(e);if(!a.isHTMLCanvas(t))throw new Error("Object is not a canvas element");return t}function o(e,t,r){return Math.min(Math.round(e*t),r-1)}function u(e,t,r,n){return n?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}a.defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1}},2920:(e,t,r)=>{r.d(t,{M:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){return e.call(this,r,n,t.defaultProps)||this}return(0,a.A)(t,e),(0,i.A)(t,[{key:n,get:function(){return"CommandBuffer"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps)},7608:(e,t,r)=>{r.d(t,{i:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){return e.call(this,r,n,t.defaultProps)||this}return(0,a.A)(t,e),(0,i.A)(t,[{key:n,get:function(){return"CommandEncoder"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps,{measureExecutionTime:void 0})},9871:(e,t,r)=>{r.d(t,{G:()=>c});var n,i=r(8696),a=r(7387),s=r(8314),o=r(5839),u=r(8862);n=Symbol.toStringTag;var c=function(e){function t(r,n){var i;return void 0===n&&(n={}),(i=e.call(this,r,n,t.defaultProps)||this).width=i.props.width,i.height=i.props.height,i}(0,a.A)(t,e);var r=t.prototype;return r.clone=function(e){var t=this.colorAttachments.map((function(t){return t.texture.clone(e)})),r=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer(Object.assign({},this.props,{colorAttachments:t,depthStencilAttachment:r}))},r.resize=function(e){var t=!e;if(e){var r=Array.isArray(e)?e:[e.width,e.height],n=r[0],i=r[1];t=t||i!==this.height||n!==this.width,this.width=n,this.height=i}t&&(u.R.log(2,"Resizing framebuffer "+this.id+" to "+this.width+"x"+this.height)(),this.resizeAttachments(this.width,this.height))},r.autoCreateAttachmentTextures=function(){var e=this;if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((function(t,r){if("string"==typeof t){var n=e.createColorTexture(t,r);return e.attachResource(n),n.view}return t instanceof o.g?t.view:t}));var t=this.props.depthStencilAttachment;if(t)if("string"==typeof t){var r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof o.g?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t},r.createColorTexture=function(e,t){return this.device.createTexture({id:this.id+"-color-attachment-"+t,usage:o.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})},r.createDepthStencilTexture=function(e){return this.device.createTexture({id:this.id+"-depth-stencil-attachment",usage:o.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})},r.resizeAttachments=function(e,t){for(var r=0;r<this.colorAttachments.length;++r)if(this.colorAttachments[r]){var n=this.colorAttachments[r].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[r]),this.colorAttachments[r]=n.view,this.attachResource(n.view)}if(this.depthStencilAttachment){var i=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()},(0,i.A)(t,[{key:n,get:function(){return"Framebuffer"}}]),t}(s.F);c.defaultProps=Object.assign({},s.F.defaultProps,{width:1,height:1,colorAttachments:[],depthStencilAttachment:null})},6273:(e,t,r)=>{r.d(t,{d:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){return e.call(this,r,n,t.defaultProps)||this}return(0,a.A)(t,e),(0,i.A)(t,[{key:n,get:function(){return"QuerySet"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps,{type:void 0,count:void 0})},6730:(e,t,r)=>{r.d(t,{A:()=>u});var n,i,a=r(8696),s=r(7387),o=r(8314);i=Symbol.toStringTag;var u=function(e){function t(r,n){return n=t.normalizeProps(r,n),e.call(this,r,n,t.defaultProps)||this}return(0,s.A)(t,e),t.normalizeProps=function(e,t){return t},(0,a.A)(t,[{key:i,get:function(){return"RenderPass"}}]),t}(o.F);n=u,u.defaultClearColor=[0,0,0,1],u.defaultClearDepth=1,u.defaultClearStencil=0,u.defaultProps=Object.assign({},o.F.defaultProps,{framebuffer:null,parameters:void 0,clearColor:n.defaultClearColor,clearColors:void 0,clearDepth:n.defaultClearDepth,clearStencil:n.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0})},9853:(e,t,r)=>{r.d(t,{r:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){var i;return(i=e.call(this,r,n,t.defaultProps)||this).linkStatus="pending",i.hash="",i.shaderLayout=i.props.shaderLayout,i.bufferLayout=i.props.bufferLayout||[],i}return(0,a.A)(t,e),(0,i.A)(t,[{key:n,get:function(){return"RenderPipeline"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps,{vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}})},9532:(e,t,r)=>{r.d(t,{L:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){return n=t.normalizeProps(r,n),e.call(this,r,n,t.defaultProps)||this}return(0,a.A)(t,e),t.normalizeProps=function(e,t){return t},(0,i.A)(t,[{key:n,get:function(){return"Sampler"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps,{type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1})},349:(e,t,r)=>{r.d(t,{M:()=>d});var n,i=r(675),a=r(467),s=r(8696),o=r(7387),u=r(8314),c=r(1010),l=r(3845);function f(e,t,r,n){if(null!=n&&n.inlineSource){var i=function(e,t,r){for(var n="",i=t-2;i<=t;i++){var a=e[i-1];void 0!==a&&(n+=h(a,t,r))}return n}(t,r);return"\n"+i+(e.linePos>0?" ".repeat(e.linePos+5)+"^^^\n":"")+e.type.toUpperCase()+": "+e.message+"\n\n"}var a="error"===e.type?"red":"#8B4000";return null!=n&&n.html?"<div class='luma-compiler-log-error' style=\"color:"+a+';"><b> '+e.type.toUpperCase()+": "+e.message+"</b></div>":e.type.toUpperCase()+": "+e.message}function h(e,t,r){var n=null!=r&&r.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return function(e,t){for(var r="",n=e.length;n<t;++n)r+=" ";return r+e}(String(t),4)+": "+n+(null!=r&&r.html?"<br/>":"\n")}n=Symbol.toStringTag;var d=function(e){function t(r,n){var i;return n=Object.assign({},n,{debugShaders:n.debugShaders||r.props.debugShaders||"errors"}),(i=e.call(this,r,Object.assign({id:_(n)},n),t.defaultProps)||this).compilationStatus="pending",i.stage=i.props.stage,i.source=i.props.source,i}(0,o.A)(t,e);var r=t.prototype;return r.getCompilationInfoSync=function(){return null},r.getTranslatedSource=function(){return null},r.debugShader=function(){var e=(0,a.A)((0,i.A)().mark((function e(){var t,r;return(0,i.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.debugShaders,e.t0=t,e.next="never"===e.t0?4:"errors"===e.t0?5:"warnings"===e.t0||"always"===e.t0?8:9;break;case 4:return e.abrupt("return");case 5:if("success"!==this.compilationStatus){e.next=7;break}return e.abrupt("return");case 7:case 8:return e.abrupt("break",9);case 9:return e.next=11,this.getCompilationInfo();case 11:if(r=e.sent,"warnings"!==t||0!==(null==r?void 0:r.length)){e.next=14;break}return e.abrupt("return");case 14:this._displayShaderLog(r,this.id);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._displayShaderLog=function(e,t){var r,n,i=this;if("undefined"!=typeof document&&null!=(r=document)&&r.createElement){var a=t,s=this.stage+' shader "'+a+'"',o=function(e,t,r){var n="",i=t.split(/\r?\n/),a=e.slice().sort((function(e,t){return e.lineNum-t.lineNum}));switch((null==r?void 0:r.showSourceCode)||"no"){case"all":for(var s=0,o=1;o<=i.length;o++)for(n+=h(i[o-1],o,r);a.length>s&&a[s].lineNum===o;){var u=a[s++];n+=f(u,i,u.lineNum,Object.assign({},r,{inlineSource:!1}))}for(;a.length>s;)n+=f(a[s++],[],0,Object.assign({},r,{inlineSource:!1}));return n;case"issues":case"no":for(var c,d=(0,l.A)(e);!(c=d()).done;){var _=c.value;n+=f(_,i,_.lineNum,{inlineSource:"no"!==(null==r?void 0:r.showSourceCode)})}return n}}(e,this.source,{showSourceCode:"all",html:!0}),u=this.getTranslatedSource();u&&(o+='<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>'+u+"</pre></code>");var c=document.createElement("Button");c.innerHTML="\n<h1>Compilation error in "+s+'</h1><br /><br />\n<code style="user-select:text;"><pre>\n'+o+"\n</pre></code>",c.style.top="10px",c.style.left="10px",c.style.position="absolute",c.style.zIndex="9999",c.style.width="100%",c.style.textAlign="left",document.body.appendChild(c),null==(n=document.getElementsByClassName("luma-compiler-log-error")[0])||n.scrollIntoView(),c.onclick=function(){var e="data:text/plain,"+encodeURIComponent(i.source);navigator.clipboard.writeText(e)}}},(0,s.A)(t,[{key:n,get:function(){return"Shader"}}]),t}(u.F);function _(e){return function(e,t){void 0===t&&(t="unnamed");var r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return r?r[1]:t}(e.source)||e.id||(0,c.L)("unnamed "+e.stage+"-shader")}d.defaultProps=Object.assign({},u.F.defaultProps,{language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0})},1213:(e,t,r)=>{r.d(t,{X:()=>o});var n,i=r(8696),a=r(7387),s=r(8314);n=Symbol.toStringTag;var o=function(e){function t(r,n){return e.call(this,r,n,t.defaultProps)||this}return(0,a.A)(t,e),(0,i.A)(t,[{key:n,get:function(){return"TextureView"}}]),t}(s.F);o.defaultProps=Object.assign({},s.F.defaultProps,{format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0})},5839:(e,t,r)=>{r.d(t,{g:()=>h});var n,i,a=r(8696),s=r(9417),o=r(7387),u=r(8314),c=r(9532),l=r(8862),f={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};i=Symbol.toStringTag;var h=function(e){(0,o.A)(r,e);var t=r.prototype;function r(t,n){var i;if(n=r.normalizeProps(t,n),(i=e.call(this,t,n,r.defaultProps)||this).dimension=i.props.dimension,i.baseDimension=f[i.dimension],i.format=i.props.format,i.width=i.props.width,i.height=i.props.height,i.depth=i.props.depth,i.mipLevels=i.props.mipLevels,void 0===i.props.width||void 0===i.props.height)if(t.isExternalImage(n.data)){var a=t.getExternalImageSize(n.data);i.width=(null==a?void 0:a.width)||1,i.height=(null==a?void 0:a.height)||1}else i.width=1,i.height=1,void 0!==i.props.width&&void 0!==i.props.height||l.R.warn((0,s.A)(i)+" created with undefined width or height. This is deprecated. Use AsyncTexture instead.")();return i.updateTimestamp=t.incrementTimestamp(),i}return t.toString=function(){return"Texture("+this.id+","+this.format+","+this.width+"x"+this.height+")"},t.setSampler=function(e){this.sampler=e instanceof c.L?e:this.device.createSampler(e)},t.clone=function(e){return this.device.createTexture(Object.assign({},this.props,e))},r.normalizeProps=function(e,t){var r=Object.assign({},t),n=r.width,i=r.height;return"number"==typeof n&&(r.width=Math.max(1,Math.ceil(n))),"number"==typeof i&&(r.height=Math.max(1,Math.ceil(i))),r},t._initializeData=function(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})},t._normalizeCopyImageDataOptions=function(e){var t=this.width,n=this.height,i=this.depth,a=Object.assign({},r.defaultCopyDataOptions,{width:t,height:n,depth:i},e),s=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!s.bytesPerPixel)throw new Error("bytesPerRow must be provided for texture format "+this.format);return a.bytesPerRow=e.bytesPerRow||t*(s.bytesPerPixel||4),a.rowsPerImage=e.rowsPerImage||n,a},t._normalizeCopyExternalImageOptions=function(e){var t=this.device.getExternalImageSize(e.image),n=Object.assign({},r.defaultCopyExternalImageOptions,t,e);return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n},(0,a.A)(r,[{key:i,get:function(){return"Texture"}}]),r}(u.F);n=h,h.SAMPLE=4,h.STORAGE=8,h.RENDER=16,h.COPY_SRC=1,h.COPY_DST=2,h.TEXTURE=4,h.RENDER_ATTACHMENT=16,h.defaultProps=Object.assign({},u.F.defaultProps,{data:null,dimension:"2d",format:"rgba8unorm",usage:n.TEXTURE|n.RENDER_ATTACHMENT|n.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0}),h.defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"},h.defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}},7896:(e,t,r)=>{r.d(t,{o:()=>u});var n,i=r(8696),a=r(7387),s=r(7406),o=r(8314);n=Symbol.toStringTag;var u=function(e){function t(r,n){var i;return(i=e.call(this,r,n,t.defaultProps)||this).indexBuffer=null,i.maxVertexAttributes=r.limits.maxVertexAttributes,i.attributes=new Array(i.maxVertexAttributes).fill(null),i.attributeInfos=(0,s.M)(n.shaderLayout,n.bufferLayout,i.maxVertexAttributes),i}return(0,a.A)(t,e),t.prototype.setConstantWebGL=function(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()},(0,i.A)(t,[{key:n,get:function(){return"VertexArray"}}]),t}(o.F);u.defaultProps=Object.assign({},o.F.defaultProps,{shaderLayout:void 0,bufferLayout:[]})},7172:(e,t,r)=>{function n(e){return o[e]}function i(e){var t=s[e],r=t[0],n=t[1],i="i32"===r||"u32"===r,o="u32"!==r;return{primitiveType:r,components:n,byteLength:a[r]*n,integer:i,signed:o}}r.d(t,{k0:()=>n,wH:()=>i});var a={f32:4,f16:2,i32:4,u32:4},s={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},o={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}},u={vec2i:"vec2<i32>",vec3i:"vec3<i32>",vec4i:"vec4<i32>",vec2u:"vec2<u32>",vec3u:"vec3<u32>",vec4u:"vec4<u32>",vec2f:"vec2<f32>",vec3f:"vec3<f32>",vec4f:"vec4<f32>",vec2h:"vec2<f16>",vec3h:"vec3<f16>",vec4h:"vec4<f16>"};Object.assign({},u,{mat2x2f:"mat2x2<f32>",mat2x3f:"mat2x3<f32>",mat2x4f:"mat2x4<f32>",mat3x2f:"mat3x2<f32>",mat3x3f:"mat3x3<f32>",mat3x4f:"mat3x4<f32>",mat4x2f:"mat4x2<f32>",mat4x3f:"mat4x3<f32>",mat4x4f:"mat4x4<f32>",mat2x2i:"mat2x2<i32>",mat2x3i:"mat2x3<i32>",mat2x4i:"mat2x4<i32>",mat3x2i:"mat3x2<i32>",mat3x3i:"mat3x3<i32>",mat3x4i:"mat3x4<i32>",mat4x2i:"mat4x2<i32>",mat4x3i:"mat4x3<i32>",mat4x4i:"mat4x4<i32>",mat2x2u:"mat2x2<u32>",mat2x3u:"mat2x3<u32>",mat2x4u:"mat2x4<u32>",mat3x2u:"mat3x2<u32>",mat3x3u:"mat3x3<u32>",mat3x4u:"mat3x4<u32>",mat4x2u:"mat4x2<u32>",mat4x3u:"mat4x3<u32>",mat4x4u:"mat4x4<u32>",mat2x2h:"mat2x2<f16>",mat2x3h:"mat2x3<f16>",mat2x4h:"mat2x4<f16>",mat3x2h:"mat3x2<f16>",mat3x3h:"mat3x3<f16>",mat3x4h:"mat3x4<f16>",mat4x2h:"mat4x2<f16>",mat4x3h:"mat4x3<f16>",mat4x4h:"mat4x4<f16>"})},8397:(e,t,r)=>{var n;function i(e){return(!n||n.byteLength<e)&&(n=new ArrayBuffer(e)),n}function a(e,t){return new e(i(e.BYTES_PER_ELEMENT*t),0,t)}r.d(t,{X:()=>a,o:()=>i})},407:(e,t,r)=>{r.r(t),r.d(t,{WebGLDevice:()=>Rt});var n,i,a,s=r(8696),o=r(9417),u=r(7387),c=r(2947),l=r(8862),f=r(3845),h=r(5981),d=((n={})[h.GL.BLEND]=!1,n[h.GL.BLEND_COLOR]=new Float32Array([0,0,0,0]),n[h.GL.BLEND_EQUATION_RGB]=h.GL.FUNC_ADD,n[h.GL.BLEND_EQUATION_ALPHA]=h.GL.FUNC_ADD,n[h.GL.BLEND_SRC_RGB]=h.GL.ONE,n[h.GL.BLEND_DST_RGB]=h.GL.ZERO,n[h.GL.BLEND_SRC_ALPHA]=h.GL.ONE,n[h.GL.BLEND_DST_ALPHA]=h.GL.ZERO,n[h.GL.COLOR_CLEAR_VALUE]=new Float32Array([0,0,0,0]),n[h.GL.COLOR_WRITEMASK]=[!0,!0,!0,!0],n[h.GL.CULL_FACE]=!1,n[h.GL.CULL_FACE_MODE]=h.GL.BACK,n[h.GL.DEPTH_TEST]=!1,n[h.GL.DEPTH_CLEAR_VALUE]=1,n[h.GL.DEPTH_FUNC]=h.GL.LESS,n[h.GL.DEPTH_RANGE]=new Float32Array([0,1]),n[h.GL.DEPTH_WRITEMASK]=!0,n[h.GL.DITHER]=!0,n[h.GL.CURRENT_PROGRAM]=null,n[h.GL.FRAMEBUFFER_BINDING]=null,n[h.GL.RENDERBUFFER_BINDING]=null,n[h.GL.VERTEX_ARRAY_BINDING]=null,n[h.GL.ARRAY_BUFFER_BINDING]=null,n[h.GL.FRONT_FACE]=h.GL.CCW,n[h.GL.GENERATE_MIPMAP_HINT]=h.GL.DONT_CARE,n[h.GL.LINE_WIDTH]=1,n[h.GL.POLYGON_OFFSET_FILL]=!1,n[h.GL.POLYGON_OFFSET_FACTOR]=0,n[h.GL.POLYGON_OFFSET_UNITS]=0,n[h.GL.SAMPLE_ALPHA_TO_COVERAGE]=!1,n[h.GL.SAMPLE_COVERAGE]=!1,n[h.GL.SAMPLE_COVERAGE_VALUE]=1,n[h.GL.SAMPLE_COVERAGE_INVERT]=!1,n[h.GL.SCISSOR_TEST]=!1,n[h.GL.SCISSOR_BOX]=new Int32Array([0,0,1024,1024]),n[h.GL.STENCIL_TEST]=!1,n[h.GL.STENCIL_CLEAR_VALUE]=0,n[h.GL.STENCIL_WRITEMASK]=4294967295,n[h.GL.STENCIL_BACK_WRITEMASK]=4294967295,n[h.GL.STENCIL_FUNC]=h.GL.ALWAYS,n[h.GL.STENCIL_REF]=0,n[h.GL.STENCIL_VALUE_MASK]=4294967295,n[h.GL.STENCIL_BACK_FUNC]=h.GL.ALWAYS,n[h.GL.STENCIL_BACK_REF]=0,n[h.GL.STENCIL_BACK_VALUE_MASK]=4294967295,n[h.GL.STENCIL_FAIL]=h.GL.KEEP,n[h.GL.STENCIL_PASS_DEPTH_FAIL]=h.GL.KEEP,n[h.GL.STENCIL_PASS_DEPTH_PASS]=h.GL.KEEP,n[h.GL.STENCIL_BACK_FAIL]=h.GL.KEEP,n[h.GL.STENCIL_BACK_PASS_DEPTH_FAIL]=h.GL.KEEP,n[h.GL.STENCIL_BACK_PASS_DEPTH_PASS]=h.GL.KEEP,n[h.GL.VIEWPORT]=[0,0,1024,1024],n[h.GL.TRANSFORM_FEEDBACK_BINDING]=null,n[h.GL.COPY_READ_BUFFER_BINDING]=null,n[h.GL.COPY_WRITE_BUFFER_BINDING]=null,n[h.GL.PIXEL_PACK_BUFFER_BINDING]=null,n[h.GL.PIXEL_UNPACK_BUFFER_BINDING]=null,n[h.GL.FRAGMENT_SHADER_DERIVATIVE_HINT]=h.GL.DONT_CARE,n[h.GL.READ_FRAMEBUFFER_BINDING]=null,n[h.GL.RASTERIZER_DISCARD]=!1,n[h.GL.PACK_ALIGNMENT]=4,n[h.GL.UNPACK_ALIGNMENT]=4,n[h.GL.UNPACK_FLIP_Y_WEBGL]=!1,n[h.GL.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!1,n[h.GL.UNPACK_COLORSPACE_CONVERSION_WEBGL]=h.GL.BROWSER_DEFAULT_WEBGL,n[h.GL.PACK_ROW_LENGTH]=0,n[h.GL.PACK_SKIP_PIXELS]=0,n[h.GL.PACK_SKIP_ROWS]=0,n[h.GL.UNPACK_ROW_LENGTH]=0,n[h.GL.UNPACK_IMAGE_HEIGHT]=0,n[h.GL.UNPACK_SKIP_PIXELS]=0,n[h.GL.UNPACK_SKIP_ROWS]=0,n[h.GL.UNPACK_SKIP_IMAGES]=0,n),_=function(e,t,r){return t?e.enable(r):e.disable(r)},L=function(e,t,r){return e.hint(r,t)},E=function(e,t,r){return e.pixelStorei(r,t)},p=function(e,t,r){var n=r===h.GL.FRAMEBUFFER_BINDING?h.GL.DRAW_FRAMEBUFFER:h.GL.READ_FRAMEBUFFER;return e.bindFramebuffer(n,t)},g=function(e,t,r){var n,i=((n={})[h.GL.ARRAY_BUFFER_BINDING]=h.GL.ARRAY_BUFFER,n[h.GL.COPY_READ_BUFFER_BINDING]=h.GL.COPY_READ_BUFFER,n[h.GL.COPY_WRITE_BUFFER_BINDING]=h.GL.COPY_WRITE_BUFFER,n[h.GL.PIXEL_PACK_BUFFER_BINDING]=h.GL.PIXEL_PACK_BUFFER,n[h.GL.PIXEL_UNPACK_BUFFER_BINDING]=h.GL.PIXEL_UNPACK_BUFFER,n)[r];e.bindBuffer(i,t)};function G(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}var m=((i={})[h.GL.BLEND]=_,i[h.GL.BLEND_COLOR]=function(e,t){return e.blendColor.apply(e,t)},i[h.GL.BLEND_EQUATION_RGB]="blendEquation",i[h.GL.BLEND_EQUATION_ALPHA]="blendEquation",i[h.GL.BLEND_SRC_RGB]="blendFunc",i[h.GL.BLEND_DST_RGB]="blendFunc",i[h.GL.BLEND_SRC_ALPHA]="blendFunc",i[h.GL.BLEND_DST_ALPHA]="blendFunc",i[h.GL.COLOR_CLEAR_VALUE]=function(e,t){return e.clearColor.apply(e,t)},i[h.GL.COLOR_WRITEMASK]=function(e,t){return e.colorMask.apply(e,t)},i[h.GL.CULL_FACE]=_,i[h.GL.CULL_FACE_MODE]=function(e,t){return e.cullFace(t)},i[h.GL.DEPTH_TEST]=_,i[h.GL.DEPTH_CLEAR_VALUE]=function(e,t){return e.clearDepth(t)},i[h.GL.DEPTH_FUNC]=function(e,t){return e.depthFunc(t)},i[h.GL.DEPTH_RANGE]=function(e,t){return e.depthRange.apply(e,t)},i[h.GL.DEPTH_WRITEMASK]=function(e,t){return e.depthMask(t)},i[h.GL.DITHER]=_,i[h.GL.FRAGMENT_SHADER_DERIVATIVE_HINT]=L,i[h.GL.CURRENT_PROGRAM]=function(e,t){return e.useProgram(t)},i[h.GL.RENDERBUFFER_BINDING]=function(e,t){return e.bindRenderbuffer(h.GL.RENDERBUFFER,t)},i[h.GL.TRANSFORM_FEEDBACK_BINDING]=function(e,t){return null==e.bindTransformFeedback?void 0:e.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,t)},i[h.GL.VERTEX_ARRAY_BINDING]=function(e,t){return e.bindVertexArray(t)},i[h.GL.FRAMEBUFFER_BINDING]=p,i[h.GL.READ_FRAMEBUFFER_BINDING]=p,i[h.GL.ARRAY_BUFFER_BINDING]=g,i[h.GL.COPY_READ_BUFFER_BINDING]=g,i[h.GL.COPY_WRITE_BUFFER_BINDING]=g,i[h.GL.PIXEL_PACK_BUFFER_BINDING]=g,i[h.GL.PIXEL_UNPACK_BUFFER_BINDING]=g,i[h.GL.FRONT_FACE]=function(e,t){return e.frontFace(t)},i[h.GL.GENERATE_MIPMAP_HINT]=L,i[h.GL.LINE_WIDTH]=function(e,t){return e.lineWidth(t)},i[h.GL.POLYGON_OFFSET_FILL]=_,i[h.GL.POLYGON_OFFSET_FACTOR]="polygonOffset",i[h.GL.POLYGON_OFFSET_UNITS]="polygonOffset",i[h.GL.RASTERIZER_DISCARD]=_,i[h.GL.SAMPLE_ALPHA_TO_COVERAGE]=_,i[h.GL.SAMPLE_COVERAGE]=_,i[h.GL.SAMPLE_COVERAGE_VALUE]="sampleCoverage",i[h.GL.SAMPLE_COVERAGE_INVERT]="sampleCoverage",i[h.GL.SCISSOR_TEST]=_,i[h.GL.SCISSOR_BOX]=function(e,t){return e.scissor.apply(e,t)},i[h.GL.STENCIL_TEST]=_,i[h.GL.STENCIL_CLEAR_VALUE]=function(e,t){return e.clearStencil(t)},i[h.GL.STENCIL_WRITEMASK]=function(e,t){return e.stencilMaskSeparate(h.GL.FRONT,t)},i[h.GL.STENCIL_BACK_WRITEMASK]=function(e,t){return e.stencilMaskSeparate(h.GL.BACK,t)},i[h.GL.STENCIL_FUNC]="stencilFuncFront",i[h.GL.STENCIL_REF]="stencilFuncFront",i[h.GL.STENCIL_VALUE_MASK]="stencilFuncFront",i[h.GL.STENCIL_BACK_FUNC]="stencilFuncBack",i[h.GL.STENCIL_BACK_REF]="stencilFuncBack",i[h.GL.STENCIL_BACK_VALUE_MASK]="stencilFuncBack",i[h.GL.STENCIL_FAIL]="stencilOpFront",i[h.GL.STENCIL_PASS_DEPTH_FAIL]="stencilOpFront",i[h.GL.STENCIL_PASS_DEPTH_PASS]="stencilOpFront",i[h.GL.STENCIL_BACK_FAIL]="stencilOpBack",i[h.GL.STENCIL_BACK_PASS_DEPTH_FAIL]="stencilOpBack",i[h.GL.STENCIL_BACK_PASS_DEPTH_PASS]="stencilOpBack",i[h.GL.VIEWPORT]=function(e,t){return e.viewport.apply(e,t)},i[h.GL.DEPTH_CLAMP_EXT]=_,i[h.GL.POLYGON_OFFSET_LINE_WEBGL]=_,i[h.GL.CLIP_DISTANCE0_WEBGL]=_,i[h.GL.CLIP_DISTANCE1_WEBGL]=_,i[h.GL.CLIP_DISTANCE2_WEBGL]=_,i[h.GL.CLIP_DISTANCE3_WEBGL]=_,i[h.GL.CLIP_DISTANCE4_WEBGL]=_,i[h.GL.CLIP_DISTANCE5_WEBGL]=_,i[h.GL.CLIP_DISTANCE6_WEBGL]=_,i[h.GL.CLIP_DISTANCE7_WEBGL]=_,i[h.GL.PACK_ALIGNMENT]=E,i[h.GL.UNPACK_ALIGNMENT]=E,i[h.GL.UNPACK_FLIP_Y_WEBGL]=E,i[h.GL.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=E,i[h.GL.UNPACK_COLORSPACE_CONVERSION_WEBGL]=E,i[h.GL.PACK_ROW_LENGTH]=E,i[h.GL.PACK_SKIP_PIXELS]=E,i[h.GL.PACK_SKIP_ROWS]=E,i[h.GL.UNPACK_ROW_LENGTH]=E,i[h.GL.UNPACK_IMAGE_HEIGHT]=E,i[h.GL.UNPACK_SKIP_PIXELS]=E,i[h.GL.UNPACK_SKIP_ROWS]=E,i[h.GL.UNPACK_SKIP_IMAGES]=E,i.framebuffer=function(e,t){var r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(h.GL.FRAMEBUFFER,r)},i.blend=function(e,t){return t?e.enable(h.GL.BLEND):e.disable(h.GL.BLEND)},i.blendColor=function(e,t){return e.blendColor.apply(e,t)},i.blendEquation=function(e,t){var r="number"==typeof t?[t,t]:t;e.blendEquationSeparate.apply(e,r)},i.blendFunc=function(e,t){var r=2===(null==t?void 0:t.length)?[].concat(t,t):t;e.blendFuncSeparate.apply(e,r)},i.clearColor=function(e,t){return e.clearColor.apply(e,t)},i.clearDepth=function(e,t){return e.clearDepth(t)},i.clearStencil=function(e,t){return e.clearStencil(t)},i.colorMask=function(e,t){return e.colorMask.apply(e,t)},i.cull=function(e,t){return t?e.enable(h.GL.CULL_FACE):e.disable(h.GL.CULL_FACE)},i.cullFace=function(e,t){return e.cullFace(t)},i.depthTest=function(e,t){return t?e.enable(h.GL.DEPTH_TEST):e.disable(h.GL.DEPTH_TEST)},i.depthFunc=function(e,t){return e.depthFunc(t)},i.depthMask=function(e,t){return e.depthMask(t)},i.depthRange=function(e,t){return e.depthRange.apply(e,t)},i.dither=function(e,t){return t?e.enable(h.GL.DITHER):e.disable(h.GL.DITHER)},i.derivativeHint=function(e,t){e.hint(h.GL.FRAGMENT_SHADER_DERIVATIVE_HINT,t)},i.frontFace=function(e,t){return e.frontFace(t)},i.mipmapHint=function(e,t){return e.hint(h.GL.GENERATE_MIPMAP_HINT,t)},i.lineWidth=function(e,t){return e.lineWidth(t)},i.polygonOffsetFill=function(e,t){return t?e.enable(h.GL.POLYGON_OFFSET_FILL):e.disable(h.GL.POLYGON_OFFSET_FILL)},i.polygonOffset=function(e,t){return e.polygonOffset.apply(e,t)},i.sampleCoverage=function(e,t){return e.sampleCoverage(t[0],t[1]||!1)},i.scissorTest=function(e,t){return t?e.enable(h.GL.SCISSOR_TEST):e.disable(h.GL.SCISSOR_TEST)},i.scissor=function(e,t){return e.scissor.apply(e,t)},i.stencilTest=function(e,t){return t?e.enable(h.GL.STENCIL_TEST):e.disable(h.GL.STENCIL_TEST)},i.stencilMask=function(e,t){var r=t=G(t)?t:[t,t],n=r[0],i=r[1];e.stencilMaskSeparate(h.GL.FRONT,n),e.stencilMaskSeparate(h.GL.BACK,i)},i.stencilFunc=function(e,t){var r=t=G(t)&&3===t.length?[].concat(t,t):t,n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5];e.stencilFuncSeparate(h.GL.FRONT,n,i,a),e.stencilFuncSeparate(h.GL.BACK,s,o,u)},i.stencilOp=function(e,t){var r=t=G(t)&&3===t.length?[].concat(t,t):t,n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],u=r[5];e.stencilOpSeparate(h.GL.FRONT,n,i,a),e.stencilOpSeparate(h.GL.BACK,s,o,u)},i.viewport=function(e,t){return e.viewport.apply(e,t)},i);function A(e,t,r){return void 0!==t[e]?t[e]:r[e]}var v={blendEquation:function(e,t,r){return e.blendEquationSeparate(A(h.GL.BLEND_EQUATION_RGB,t,r),A(h.GL.BLEND_EQUATION_ALPHA,t,r))},blendFunc:function(e,t,r){return e.blendFuncSeparate(A(h.GL.BLEND_SRC_RGB,t,r),A(h.GL.BLEND_DST_RGB,t,r),A(h.GL.BLEND_SRC_ALPHA,t,r),A(h.GL.BLEND_DST_ALPHA,t,r))},polygonOffset:function(e,t,r){return e.polygonOffset(A(h.GL.POLYGON_OFFSET_FACTOR,t,r),A(h.GL.POLYGON_OFFSET_UNITS,t,r))},sampleCoverage:function(e,t,r){return e.sampleCoverage(A(h.GL.SAMPLE_COVERAGE_VALUE,t,r),A(h.GL.SAMPLE_COVERAGE_INVERT,t,r))},stencilFuncFront:function(e,t,r){return e.stencilFuncSeparate(h.GL.FRONT,A(h.GL.STENCIL_FUNC,t,r),A(h.GL.STENCIL_REF,t,r),A(h.GL.STENCIL_VALUE_MASK,t,r))},stencilFuncBack:function(e,t,r){return e.stencilFuncSeparate(h.GL.BACK,A(h.GL.STENCIL_BACK_FUNC,t,r),A(h.GL.STENCIL_BACK_REF,t,r),A(h.GL.STENCIL_BACK_VALUE_MASK,t,r))},stencilOpFront:function(e,t,r){return e.stencilOpSeparate(h.GL.FRONT,A(h.GL.STENCIL_FAIL,t,r),A(h.GL.STENCIL_PASS_DEPTH_FAIL,t,r),A(h.GL.STENCIL_PASS_DEPTH_PASS,t,r))},stencilOpBack:function(e,t,r){return e.stencilOpSeparate(h.GL.BACK,A(h.GL.STENCIL_BACK_FAIL,t,r),A(h.GL.STENCIL_BACK_PASS_DEPTH_FAIL,t,r),A(h.GL.STENCIL_BACK_PASS_DEPTH_PASS,t,r))}},R={enable:function(e,t){var r;return e(((r={})[t]=!0,r))},disable:function(e,t){var r;return e(((r={})[t]=!1,r))},pixelStorei:function(e,t,r){var n;return e(((n={})[t]=r,n))},hint:function(e,t,r){var n;return e(((n={})[t]=r,n))},useProgram:function(e,t){var r;return e(((r={})[h.GL.CURRENT_PROGRAM]=t,r))},bindRenderbuffer:function(e,t,r){var n;return e(((n={})[h.GL.RENDERBUFFER_BINDING]=r,n))},bindTransformFeedback:function(e,t,r){var n;return e(((n={})[h.GL.TRANSFORM_FEEDBACK_BINDING]=r,n))},bindVertexArray:function(e,t){var r;return e(((r={})[h.GL.VERTEX_ARRAY_BINDING]=t,r))},bindFramebuffer:function(e,t,r){var n,i,a;switch(t){case h.GL.FRAMEBUFFER:return e(((n={})[h.GL.DRAW_FRAMEBUFFER_BINDING]=r,n[h.GL.READ_FRAMEBUFFER_BINDING]=r,n));case h.GL.DRAW_FRAMEBUFFER:return e(((i={})[h.GL.DRAW_FRAMEBUFFER_BINDING]=r,i));case h.GL.READ_FRAMEBUFFER:return e(((a={})[h.GL.READ_FRAMEBUFFER_BINDING]=r,a));default:return null}},bindBuffer:function(e,t,r){var n,i,a=(n={},n[h.GL.ARRAY_BUFFER]=[h.GL.ARRAY_BUFFER_BINDING],n[h.GL.COPY_READ_BUFFER]=[h.GL.COPY_READ_BUFFER_BINDING],n[h.GL.COPY_WRITE_BUFFER]=[h.GL.COPY_WRITE_BUFFER_BINDING],n[h.GL.PIXEL_PACK_BUFFER]=[h.GL.PIXEL_PACK_BUFFER_BINDING],n[h.GL.PIXEL_UNPACK_BUFFER]=[h.GL.PIXEL_UNPACK_BUFFER_BINDING],n)[t];return a?e(((i={})[a]=r,i)):{valueChanged:!0}},blendColor:function(e,t,r,n,i){var a;return e(((a={})[h.GL.BLEND_COLOR]=new Float32Array([t,r,n,i]),a))},blendEquation:function(e,t){var r;return e(((r={})[h.GL.BLEND_EQUATION_RGB]=t,r[h.GL.BLEND_EQUATION_ALPHA]=t,r))},blendEquationSeparate:function(e,t,r){var n;return e(((n={})[h.GL.BLEND_EQUATION_RGB]=t,n[h.GL.BLEND_EQUATION_ALPHA]=r,n))},blendFunc:function(e,t,r){var n;return e(((n={})[h.GL.BLEND_SRC_RGB]=t,n[h.GL.BLEND_DST_RGB]=r,n[h.GL.BLEND_SRC_ALPHA]=t,n[h.GL.BLEND_DST_ALPHA]=r,n))},blendFuncSeparate:function(e,t,r,n,i){var a;return e(((a={})[h.GL.BLEND_SRC_RGB]=t,a[h.GL.BLEND_DST_RGB]=r,a[h.GL.BLEND_SRC_ALPHA]=n,a[h.GL.BLEND_DST_ALPHA]=i,a))},clearColor:function(e,t,r,n,i){var a;return e(((a={})[h.GL.COLOR_CLEAR_VALUE]=new Float32Array([t,r,n,i]),a))},clearDepth:function(e,t){var r;return e(((r={})[h.GL.DEPTH_CLEAR_VALUE]=t,r))},clearStencil:function(e,t){var r;return e(((r={})[h.GL.STENCIL_CLEAR_VALUE]=t,r))},colorMask:function(e,t,r,n,i){var a;return e(((a={})[h.GL.COLOR_WRITEMASK]=[t,r,n,i],a))},cullFace:function(e,t){var r;return e(((r={})[h.GL.CULL_FACE_MODE]=t,r))},depthFunc:function(e,t){var r;return e(((r={})[h.GL.DEPTH_FUNC]=t,r))},depthRange:function(e,t,r){var n;return e(((n={})[h.GL.DEPTH_RANGE]=new Float32Array([t,r]),n))},depthMask:function(e,t){var r;return e(((r={})[h.GL.DEPTH_WRITEMASK]=t,r))},frontFace:function(e,t){var r;return e(((r={})[h.GL.FRONT_FACE]=t,r))},lineWidth:function(e,t){var r;return e(((r={})[h.GL.LINE_WIDTH]=t,r))},polygonOffset:function(e,t,r){var n;return e(((n={})[h.GL.POLYGON_OFFSET_FACTOR]=t,n[h.GL.POLYGON_OFFSET_UNITS]=r,n))},sampleCoverage:function(e,t,r){var n;return e(((n={})[h.GL.SAMPLE_COVERAGE_VALUE]=t,n[h.GL.SAMPLE_COVERAGE_INVERT]=r,n))},scissor:function(e,t,r,n,i){var a;return e(((a={})[h.GL.SCISSOR_BOX]=new Int32Array([t,r,n,i]),a))},stencilMask:function(e,t){var r;return e(((r={})[h.GL.STENCIL_WRITEMASK]=t,r[h.GL.STENCIL_BACK_WRITEMASK]=t,r))},stencilMaskSeparate:function(e,t,r){var n;return e(((n={})[t===h.GL.FRONT?h.GL.STENCIL_WRITEMASK:h.GL.STENCIL_BACK_WRITEMASK]=r,n))},stencilFunc:function(e,t,r,n){var i;return e(((i={})[h.GL.STENCIL_FUNC]=t,i[h.GL.STENCIL_REF]=r,i[h.GL.STENCIL_VALUE_MASK]=n,i[h.GL.STENCIL_BACK_FUNC]=t,i[h.GL.STENCIL_BACK_REF]=r,i[h.GL.STENCIL_BACK_VALUE_MASK]=n,i))},stencilFuncSeparate:function(e,t,r,n,i){var a;return e(((a={})[t===h.GL.FRONT?h.GL.STENCIL_FUNC:h.GL.STENCIL_BACK_FUNC]=r,a[t===h.GL.FRONT?h.GL.STENCIL_REF:h.GL.STENCIL_BACK_REF]=n,a[t===h.GL.FRONT?h.GL.STENCIL_VALUE_MASK:h.GL.STENCIL_BACK_VALUE_MASK]=i,a))},stencilOp:function(e,t,r,n){var i;return e(((i={})[h.GL.STENCIL_FAIL]=t,i[h.GL.STENCIL_PASS_DEPTH_FAIL]=r,i[h.GL.STENCIL_PASS_DEPTH_PASS]=n,i[h.GL.STENCIL_BACK_FAIL]=t,i[h.GL.STENCIL_BACK_PASS_DEPTH_FAIL]=r,i[h.GL.STENCIL_BACK_PASS_DEPTH_PASS]=n,i))},stencilOpSeparate:function(e,t,r,n,i){var a;return e(((a={})[t===h.GL.FRONT?h.GL.STENCIL_FAIL:h.GL.STENCIL_BACK_FAIL]=r,a[t===h.GL.FRONT?h.GL.STENCIL_PASS_DEPTH_FAIL:h.GL.STENCIL_BACK_PASS_DEPTH_FAIL]=n,a[t===h.GL.FRONT?h.GL.STENCIL_PASS_DEPTH_PASS:h.GL.STENCIL_BACK_PASS_DEPTH_PASS]=i,a))},viewport:function(e,t,r,n,i){var a;return e(((a={})[h.GL.VIEWPORT]=[t,r,n,i],a))}},T=function(e,t){return e.isEnabled(t)},S=((a={})[h.GL.BLEND]=T,a[h.GL.CULL_FACE]=T,a[h.GL.DEPTH_TEST]=T,a[h.GL.DITHER]=T,a[h.GL.POLYGON_OFFSET_FILL]=T,a[h.GL.SAMPLE_ALPHA_TO_COVERAGE]=T,a[h.GL.SAMPLE_COVERAGE]=T,a[h.GL.SCISSOR_TEST]=T,a[h.GL.STENCIL_TEST]=T,a[h.GL.RASTERIZER_DISCARD]=T,a),b=new Set([h.GL.ACTIVE_TEXTURE,h.GL.TRANSFORM_FEEDBACK_ACTIVE,h.GL.TRANSFORM_FEEDBACK_PAUSED,h.GL.TRANSFORM_FEEDBACK_BUFFER_BINDING,h.GL.UNIFORM_BUFFER_BINDING,h.GL.ELEMENT_ARRAY_BUFFER_BINDING,h.GL.IMPLEMENTATION_COLOR_READ_FORMAT,h.GL.IMPLEMENTATION_COLOR_READ_TYPE,h.GL.READ_BUFFER,h.GL.DRAW_BUFFER0,h.GL.DRAW_BUFFER1,h.GL.DRAW_BUFFER2,h.GL.DRAW_BUFFER3,h.GL.DRAW_BUFFER4,h.GL.DRAW_BUFFER5,h.GL.DRAW_BUFFER6,h.GL.DRAW_BUFFER7,h.GL.DRAW_BUFFER8,h.GL.DRAW_BUFFER9,h.GL.DRAW_BUFFER10,h.GL.DRAW_BUFFER11,h.GL.DRAW_BUFFER12,h.GL.DRAW_BUFFER13,h.GL.DRAW_BUFFER14,h.GL.DRAW_BUFFER15,h.GL.SAMPLER_BINDING,h.GL.TEXTURE_BINDING_2D,h.GL.TEXTURE_BINDING_2D_ARRAY,h.GL.TEXTURE_BINDING_3D,h.GL.TEXTURE_BINDING_CUBE_MAP]);function C(e,t){if(!function(e){for(var t in e)return!1;return!0}(t)){var r={};for(var n in t){var i=Number(n),a=m[n];a&&("string"==typeof a?r[a]=!0:a(e,t[n],i))}var s=e.state&&e.state.cache;if(s)for(var o in r){(0,v[o])(e,t,s)}}}function N(e,t){if(void 0===t&&(t=d),"number"==typeof t){var r=t,n=S[r];return n?n(e,r):e.getParameter(r)}for(var i,a=Array.isArray(t)?t:Object.keys(t),s={},o=(0,f.A)(a);!(i=o()).done;){var u=i.value,c=S[u];s[u]=c?c(e,Number(u)):e.getParameter(Number(u))}return s}function I(e,t){if(e===t)return!0;if(F(e)&&F(t)&&e.length===t.length){for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}return!1}function F(e){return Array.isArray(e)||ArrayBuffer.isView(e)}var P=function(){function e(e,t){this.program=null,this.stateStack=[],this.enable=!0,this.cache=null,this.initialized=!1,this.gl=e,this.log=(null==t?void 0:t.log)||function(){},this._updateCache=this._updateCache.bind(this),Object.seal(this)}e.get=function(e){return e.state};var t=e.prototype;return t.push=function(e){void 0===e&&(e={}),this.stateStack.push({})},t.pop=function(){var e=this.stateStack[this.stateStack.length-1];C(this.gl,e),this.stateStack.pop()},t.trackState=function(e,t){if(this.cache=null!=t&&t.copyState?N(e):Object.assign({},d),this.initialized)throw new Error("WebGLStateTracker");for(var r in this.initialized=!0,this.gl.state=this,B(e),R){x(e,r,R[r])}y(e,"getParameter"),y(e,"isEnabled")},t._updateCache=function(e){var t,r=!1,n=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(var i in e){var a=e[i],s=this.cache[i];I(a,s)||(r=!0,t=s,n&&!(i in n)&&(n[i]=s),this.cache[i]=a)}return{valueChanged:r,oldValue:t}},e}();function y(e,t){var r=e[t].bind(e);e[t]=function(t){if(void 0===t||b.has(t))return r(t);var n=P.get(e);return t in n.cache||(n.cache[t]=r(t)),n.enable?n.cache[t]:r(t)},Object.defineProperty(e[t],"name",{value:t+"-from-cache",configurable:!1})}function x(e,t,r){if(e[t]){var n=e[t].bind(e);e[t]=function(){for(var t=P.get(e),i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=r.apply(void 0,[t._updateCache].concat(a)),u=o.valueChanged,c=o.oldValue;return u&&n.apply(void 0,a),c},Object.defineProperty(e[t],"name",{value:t+"-to-cache",configurable:!1})}}function B(e){var t=e.useProgram.bind(e);e.useProgram=function(r){var n=P.get(e);n.program!==r&&(t(r),n.program=r)}}function O(e,t,r){return void 0===r[t]&&(r[t]=e.getExtension(t)||null),r[t]}function D(e,t){var r=e.getParameter(h.GL.VENDOR),n=e.getParameter(h.GL.RENDERER);O(e,"WEBGL_debug_renderer_info",t);var i=t.WEBGL_debug_renderer_info,a=e.getParameter(i?i.UNMASKED_VENDOR_WEBGL:h.GL.VENDOR)||r,s=e.getParameter(i?i.UNMASKED_RENDERER_WEBGL:h.GL.RENDERER)||n,o=e.getParameter(h.GL.VERSION),u=w(a,s),c=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(a,s),l=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(w(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(a,s);return{type:"webgl",gpu:u,gpuType:l,gpuBackend:c,vendor:a,renderer:s,version:o,shadingLanguage:"glsl",shadingLanguageVersion:300}}function w(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}var M=r(675),U=r(784);function k(e){switch(e){case"uint8":case"unorm8":return h.GL.UNSIGNED_BYTE;case"sint8":case"snorm8":return h.GL.BYTE;case"uint16":case"unorm16":return h.GL.UNSIGNED_SHORT;case"sint16":case"snorm16":return h.GL.SHORT;case"uint32":return h.GL.UNSIGNED_INT;case"sint32":return h.GL.INT;case"float16":return h.GL.HALF_FLOAT;case"float32":return h.GL.FLOAT}throw new Error(String(e))}var H="WEBGL_compressed_texture_s3tc",W="WEBGL_compressed_texture_s3tc_srgb",V="EXT_texture_compression_rgtc",K="EXT_texture_compression_bptc",X="EXT_texture_norm16",Y="EXT_render_snorm",z={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Y],"norm16-renderable-webgl":[X],"snorm16-renderable-webgl":[X,Y],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[H,W,V,K],"texture-compression-bc5-webgl":[V],"texture-compression-bc7-webgl":[K],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};var j,Q={r8unorm:{gl:h.GL.R8,rb:!0},r8snorm:{gl:h.GL.R8_SNORM},r8uint:{gl:h.GL.R8UI,rb:!0},r8sint:{gl:h.GL.R8I,rb:!0},rg8unorm:{gl:h.GL.RG8,rb:!0},rg8snorm:{gl:h.GL.RG8_SNORM},rg8uint:{gl:h.GL.RG8UI,rb:!0},rg8sint:{gl:h.GL.RG8I,rb:!0},r16uint:{gl:h.GL.R16UI,rb:!0},r16sint:{gl:h.GL.R16I,rb:!0},r16float:{gl:h.GL.R16F,rb:!0},r16unorm:{gl:h.GL.R16_EXT,rb:!0},r16snorm:{gl:h.GL.R16_SNORM_EXT},"rgba4unorm-webgl":{gl:h.GL.RGBA4,rb:!0},"rgb565unorm-webgl":{gl:h.GL.RGB565,rb:!0},"rgb5a1unorm-webgl":{gl:h.GL.RGB5_A1,rb:!0},"rgb8unorm-webgl":{gl:h.GL.RGB8},"rgb8snorm-webgl":{gl:h.GL.RGB8_SNORM},rgba8unorm:{gl:h.GL.RGBA8},"rgba8unorm-srgb":{gl:h.GL.SRGB8_ALPHA8},rgba8snorm:{gl:h.GL.RGBA8_SNORM},rgba8uint:{gl:h.GL.RGBA8UI},rgba8sint:{gl:h.GL.RGBA8I},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:h.GL.RG16UI},rg16sint:{gl:h.GL.RG16I},rg16float:{gl:h.GL.RG16F,rb:!0},rg16unorm:{gl:h.GL.RG16_EXT},rg16snorm:{gl:h.GL.RG16_SNORM_EXT},r32uint:{gl:h.GL.R32UI,rb:!0},r32sint:{gl:h.GL.R32I,rb:!0},r32float:{gl:h.GL.R32F},rgb9e5ufloat:{gl:h.GL.RGB9_E5},rg11b10ufloat:{gl:h.GL.R11F_G11F_B10F,rb:!0},rgb10a2unorm:{gl:h.GL.RGB10_A2,rb:!0},rgb10a2uint:{gl:h.GL.RGB10_A2UI,rb:!0},"rgb16unorm-webgl":{gl:h.GL.RGB16_EXT},"rgb16snorm-webgl":{gl:h.GL.RGB16_SNORM_EXT},rg32uint:{gl:h.GL.RG32UI,rb:!0},rg32sint:{gl:h.GL.RG32I,rb:!0},rg32float:{gl:h.GL.RG32F,rb:!0},rgba16uint:{gl:h.GL.RGBA16UI,rb:!0},rgba16sint:{gl:h.GL.RGBA16I,rb:!0},rgba16float:{gl:h.GL.RGBA16F},rgba16unorm:{gl:h.GL.RGBA16_EXT,rb:!0},rgba16snorm:{gl:h.GL.RGBA16_SNORM_EXT},"rgb32float-webgl":{gl:h.GL.RGB32F,x:"EXT_color_buffer_float",dataFormat:h.GL.RGB,types:[h.GL.FLOAT]},rgba32uint:{gl:h.GL.RGBA32UI,rb:!0},rgba32sint:{gl:h.GL.RGBA32I,rb:!0},rgba32float:{gl:h.GL.RGBA32F,rb:!0},stencil8:{gl:h.GL.STENCIL_INDEX8,rb:!0},depth16unorm:{gl:h.GL.DEPTH_COMPONENT16,dataFormat:h.GL.DEPTH_COMPONENT,types:[h.GL.UNSIGNED_SHORT],rb:!0},depth24plus:{gl:h.GL.DEPTH_COMPONENT24,dataFormat:h.GL.DEPTH_COMPONENT,types:[h.GL.UNSIGNED_INT]},depth32float:{gl:h.GL.DEPTH_COMPONENT32F,dataFormat:h.GL.DEPTH_COMPONENT,types:[h.GL.FLOAT],rb:!0},"depth24plus-stencil8":{gl:h.GL.DEPTH24_STENCIL8,rb:!0,depthTexture:!0,dataFormat:h.GL.DEPTH_STENCIL,types:[h.GL.UNSIGNED_INT_24_8]},"depth32float-stencil8":{gl:h.GL.DEPTH32F_STENCIL8,dataFormat:h.GL.DEPTH_STENCIL,types:[h.GL.FLOAT_32_UNSIGNED_INT_24_8_REV],rb:!0},"bc1-rgb-unorm-webgl":{gl:h.GL.COMPRESSED_RGB_S3TC_DXT1_EXT,x:H},"bc1-rgb-unorm-srgb-webgl":{gl:h.GL.COMPRESSED_SRGB_S3TC_DXT1_EXT,x:W},"bc1-rgba-unorm":{gl:h.GL.COMPRESSED_RGBA_S3TC_DXT1_EXT,x:H},"bc1-rgba-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB_S3TC_DXT1_EXT,x:W},"bc2-rgba-unorm":{gl:h.GL.COMPRESSED_RGBA_S3TC_DXT3_EXT,x:H},"bc2-rgba-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,x:W},"bc3-rgba-unorm":{gl:h.GL.COMPRESSED_RGBA_S3TC_DXT5_EXT,x:H},"bc3-rgba-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,x:W},"bc4-r-unorm":{gl:h.GL.COMPRESSED_RED_RGTC1_EXT,x:V},"bc4-r-snorm":{gl:h.GL.COMPRESSED_SIGNED_RED_RGTC1_EXT,x:V},"bc5-rg-unorm":{gl:h.GL.COMPRESSED_RED_GREEN_RGTC2_EXT,x:V},"bc5-rg-snorm":{gl:h.GL.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT,x:V},"bc6h-rgb-ufloat":{gl:h.GL.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,x:K},"bc6h-rgb-float":{gl:h.GL.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,x:K},"bc7-rgba-unorm":{gl:h.GL.COMPRESSED_RGBA_BPTC_UNORM_EXT,x:K},"bc7-rgba-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT,x:K},"etc2-rgb8unorm":{gl:h.GL.COMPRESSED_RGB8_ETC2},"etc2-rgb8unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ETC2},"etc2-rgb8a1unorm":{gl:h.GL.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2},"etc2-rgb8a1unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2},"etc2-rgba8unorm":{gl:h.GL.COMPRESSED_RGBA8_ETC2_EAC},"etc2-rgba8unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC},"eac-r11unorm":{gl:h.GL.COMPRESSED_R11_EAC},"eac-r11snorm":{gl:h.GL.COMPRESSED_SIGNED_R11_EAC},"eac-rg11unorm":{gl:h.GL.COMPRESSED_RG11_EAC},"eac-rg11snorm":{gl:h.GL.COMPRESSED_SIGNED_RG11_EAC},"astc-4x4-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_4x4_KHR},"astc-4x4-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR},"astc-5x4-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_5x4_KHR},"astc-5x4-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR},"astc-5x5-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_5x5_KHR},"astc-5x5-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR},"astc-6x5-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_6x5_KHR},"astc-6x5-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR},"astc-6x6-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_6x6_KHR},"astc-6x6-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR},"astc-8x5-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_8x5_KHR},"astc-8x5-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR},"astc-8x6-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_8x6_KHR},"astc-8x6-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR},"astc-8x8-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_8x8_KHR},"astc-8x8-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR},"astc-10x5-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_10x10_KHR},"astc-10x5-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR},"astc-10x6-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_10x6_KHR},"astc-10x6-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR},"astc-10x8-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_10x8_KHR},"astc-10x8-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR},"astc-10x10-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_10x10_KHR},"astc-10x10-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR},"astc-12x10-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_12x10_KHR},"astc-12x10-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR},"astc-12x12-unorm":{gl:h.GL.COMPRESSED_RGBA_ASTC_12x12_KHR},"astc-12x12-unorm-srgb":{gl:h.GL.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR},"pvrtc-rgb4unorm-webgl":{gl:h.GL.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc-rgba4unorm-webgl":{gl:h.GL.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"pvrtc-rbg2unorm-webgl":{gl:h.GL.COMPRESSED_RGB_PVRTC_2BPPV1_IMG},"pvrtc-rgba2unorm-webgl":{gl:h.GL.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG},"etc1-rbg-unorm-webgl":{gl:h.GL.COMPRESSED_RGB_ETC1_WEBGL},"atc-rgb-unorm-webgl":{gl:h.GL.COMPRESSED_RGB_ATC_WEBGL},"atc-rgba-unorm-webgl":{gl:h.GL.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL},"atc-rgbai-unorm-webgl":{gl:h.GL.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL}};function q(e){var t,r=Q[e],n=function(e){var t=Q[e],r=null==t?void 0:t.gl;if(void 0===r)throw new Error("Unsupported texture format "+e);return r}(e),i=U.v.getInfo(e);return i.compressed&&(r.dataFormat=n),{internalFormat:n,format:(null==r?void 0:r.dataFormat)||Z(i.channels,i.integer,i.normalized,n),type:i.dataType?k(i.dataType):(null==r||null==(t=r.types)?void 0:t[0])||h.GL.UNSIGNED_BYTE,compressed:i.compressed||!1}}function Z(e,t,r,n){if(n===h.GL.RGBA||n===h.GL.RGB)return n;switch(e){case"r":return t&&!r?h.GL.RED_INTEGER:h.GL.RED;case"rg":return t&&!r?h.GL.RG_INTEGER:h.GL.RG;case"rgb":return t&&!r?h.GL.RGB_INTEGER:h.GL.RGB;case"rgba":return t&&!r?h.GL.RGBA_INTEGER:h.GL.RGBA;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return h.GL.RGBA}}var J={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};j=Symbol.iterator;var $,ee=function(e){function t(t,r,n){var i;return(i=e.call(this,[],n)||this).testedFeatures=new Set,i.gl=t,i.extensions=r,O(t,"EXT_color_buffer_float",r),i}(0,u.A)(t,e);var r=t.prototype;return r[j]=(0,M.A)().mark((function e(){var t,r,n,i;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getFeatures(),r=(0,f.A)(t);case 2:if((n=r()).done){e.next=9;break}if(i=n.value,!this.has(i)){e.next=7;break}return e.next=7,i;case 7:e.next=2;break;case 9:return e.abrupt("return",[]);case 10:case"end":return e.stop()}}),e,this)})),r.has=function(e){var t;return(null==(t=this.disabledFeatures)||!t[e])&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in z}(e)&&function(e,t,r){return(z[t]||[]).every((function(t){return O(e,t,r)}))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))},r.initializeFeatures=function(){for(var e,t=this.getFeatures().filter((function(e){return"polygon-mode-webgl"!==e})),r=(0,f.A)(t);!(e=r()).done;){var n=e.value;this.has(n)}},r.getFeatures=function(){return[].concat(Object.keys(J),Object.keys(z))},r.getWebGLFeature=function(e){var t=J[e];return"string"==typeof t?Boolean(O(this.gl,t,this.extensions)):Boolean(t)},t}(c.I7),te=function(e){function t(t){var r;return(r=e.call(this)||this).limits={},r.gl=t,r}return(0,u.A)(t,e),t.prototype.getParameter=function(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0},(0,s.A)(t,[{key:"maxTextureDimension1D",get:function(){return 0}},{key:"maxTextureDimension2D",get:function(){return this.getParameter(h.GL.MAX_TEXTURE_SIZE)}},{key:"maxTextureDimension3D",get:function(){return this.getParameter(h.GL.MAX_3D_TEXTURE_SIZE)}},{key:"maxTextureArrayLayers",get:function(){return this.getParameter(h.GL.MAX_ARRAY_TEXTURE_LAYERS)}},{key:"maxBindGroups",get:function(){return 0}},{key:"maxDynamicUniformBuffersPerPipelineLayout",get:function(){return 0}},{key:"maxDynamicStorageBuffersPerPipelineLayout",get:function(){return 0}},{key:"maxSampledTexturesPerShaderStage",get:function(){return this.getParameter(h.GL.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}},{key:"maxSamplersPerShaderStage",get:function(){return this.getParameter(h.GL.MAX_COMBINED_TEXTURE_IMAGE_UNITS)}},{key:"maxStorageBuffersPerShaderStage",get:function(){return 0}},{key:"maxStorageTexturesPerShaderStage",get:function(){return 0}},{key:"maxUniformBuffersPerShaderStage",get:function(){return this.getParameter(h.GL.MAX_UNIFORM_BUFFER_BINDINGS)}},{key:"maxUniformBufferBindingSize",get:function(){return this.getParameter(h.GL.MAX_UNIFORM_BLOCK_SIZE)}},{key:"maxStorageBufferBindingSize",get:function(){return 0}},{key:"minUniformBufferOffsetAlignment",get:function(){return this.getParameter(h.GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT)}},{key:"minStorageBufferOffsetAlignment",get:function(){return 0}},{key:"maxVertexBuffers",get:function(){return 16}},{key:"maxVertexAttributes",get:function(){return this.getParameter(h.GL.MAX_VERTEX_ATTRIBS)}},{key:"maxVertexBufferArrayStride",get:function(){return 2048}},{key:"maxInterStageShaderVariables",get:function(){return this.getParameter(h.GL.MAX_VARYING_COMPONENTS)}},{key:"maxComputeWorkgroupStorageSize",get:function(){return 0}},{key:"maxComputeInvocationsPerWorkgroup",get:function(){return 0}},{key:"maxComputeWorkgroupSizeX",get:function(){return 0}},{key:"maxComputeWorkgroupSizeY",get:function(){return 0}},{key:"maxComputeWorkgroupSizeZ",get:function(){return 0}},{key:"maxComputeWorkgroupsPerDimension",get:function(){return 0}}]),t}(c.PI),re=r(6555),ne=r(9871),ie=function(e){function t(t,r){var n;(n=e.call(this,t,r)||this).colorAttachments=[],n.depthStencilAttachment=null;var i=null===r.handle;return n.device=t,n.gl=t.gl,n.handle=n.props.handle||i?n.props.handle:n.gl.createFramebuffer(),i||(t._setWebGLDebugMetadata(n.handle,(0,o.A)(n),{spector:n.props}),n.autoCreateAttachmentTextures(),n.updateAttachments()),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){e.prototype.destroy.call(this),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)},r.updateAttachments=function(){for(var e=this.gl.bindFramebuffer(h.GL.FRAMEBUFFER,this.handle),t=0;t<this.colorAttachments.length;++t){var r=this.colorAttachments[t];if(r){var n=h.GL.COLOR_ATTACHMENT0+t;this._attachTextureView(n,r)}}if(this.depthStencilAttachment){var i=function(e){switch(U.v.getInfo(e).attachment){case"depth":return h.GL.DEPTH_ATTACHMENT;case"stencil":return h.GL.STENCIL_ATTACHMENT;case"depth-stencil":return h.GL.DEPTH_STENCIL_ATTACHMENT;default:throw new Error("Not a depth stencil format: "+e)}}(this.depthStencilAttachment.props.format);this._attachTextureView(i,this.depthStencilAttachment)}if(this.device.props.debug){var a=this.gl.checkFramebufferStatus(h.GL.FRAMEBUFFER);if(a!==h.GL.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer "+function(e){switch(e){case h.GL.FRAMEBUFFER_COMPLETE:return"success";case h.GL.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"Mismatched attachments";case h.GL.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"No attachments";case h.GL.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"Height/width mismatch";case h.GL.FRAMEBUFFER_UNSUPPORTED:return"Unsupported or split attachments";case h.GL.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"Samples mismatch";default:return""+e}}(a))}this.gl.bindFramebuffer(h.GL.FRAMEBUFFER,e)},r._attachTextureView=function(e,t){var r=this.device.gl,n=t.texture,i=t.props.baseMipLevel,a=t.props.baseArrayLayer;switch(r.bindTexture(n.glTarget,n.handle),n.glTarget){case h.GL.TEXTURE_2D_ARRAY:case h.GL.TEXTURE_3D:r.framebufferTextureLayer(h.GL.FRAMEBUFFER,e,n.handle,i,a);break;case h.GL.TEXTURE_CUBE_MAP:var s=function(e){return e<h.GL.TEXTURE_CUBE_MAP_POSITIVE_X?e+h.GL.TEXTURE_CUBE_MAP_POSITIVE_X:e}(a);r.framebufferTexture2D(h.GL.FRAMEBUFFER,e,s,n.handle,i);break;case h.GL.TEXTURE_2D:r.framebufferTexture2D(h.GL.FRAMEBUFFER,e,h.GL.TEXTURE_2D,n.handle,i);break;default:throw new Error("Illegal texture type")}r.bindTexture(n.glTarget,null)},t}(ne.G);$=Symbol.toStringTag;var ae=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).handle=null,n._framebuffer=null,n.device=t,n._setAutoCreatedCanvasId(n.device.id+"-canvas"),n._updateDevice(),n}(0,u.A)(t,e);var r=t.prototype;return r.getCurrentFramebuffer=function(){return this._framebuffer=this._framebuffer||new ie(this.device,{handle:null}),this._framebuffer},r._updateDevice=function(){},(0,s.A)(t,[{key:$,get:function(){return"WebGLCanvasContext"}}]),t}(re.Q),se=r(1716),oe=r(4976),ue={};var ce=r(467),le=r(8564),fe=function(e){function t(t,r){var n;void 0===r&&(r={}),(n=e.call(this,t,r)||this).glIndexType=h.GL.UNSIGNED_SHORT,n.byteLength=0,n.bytesUsed=0,n.device=t,n.gl=n.device.gl;var i="object"==typeof r?r.handle:void 0;return n.handle=i||n.gl.createBuffer(),t._setWebGLDebugMetadata(n.handle,(0,o.A)(n),{spector:Object.assign({},n.props,{data:typeof n.props.data})}),n.glTarget=function(e){if(e&le.h.INDEX)return h.GL.ELEMENT_ARRAY_BUFFER;if(e&le.h.VERTEX)return h.GL.ARRAY_BUFFER;if(e&le.h.UNIFORM)return h.GL.UNIFORM_BUFFER;return h.GL.ARRAY_BUFFER}(n.props.usage),n.glUsage=function(e){if(e&le.h.INDEX)return h.GL.STATIC_DRAW;if(e&le.h.VERTEX)return h.GL.STATIC_DRAW;if(e&le.h.UNIFORM)return h.GL.DYNAMIC_DRAW;return h.GL.STATIC_DRAW}(n.props.usage),n.glIndexType="uint32"===n.props.indexType?h.GL.UNSIGNED_INT:h.GL.UNSIGNED_SHORT,r.data?n._initWithData(r.data,r.byteOffset,r.byteLength):n._initWithByteLength(r.byteLength||0),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)},r._initWithData=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.byteLength+t);var n=this.glTarget;this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this.bytesUsed=r,this.byteLength=r,this._setDebugData(e,t,r),this.trackAllocatedMemory(r)},r._initWithByteLength=function(e){var t=e;0===e&&(t=new Float32Array(0));var r=this.glTarget;return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,t,this.glUsage),this.gl.bindBuffer(r,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this},r.write=function(e,t){void 0===t&&(t=0);var r=ArrayBuffer.isView(e)?e:new Uint8Array(e),n=h.GL.COPY_WRITE_BUFFER;this.gl.bindBuffer(n,this.handle),this.gl.bufferSubData(n,t,r),this.gl.bindBuffer(n,null),this._setDebugData(e,t,e.byteLength)},r.mapAndWriteAsync=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t,r,n){var i;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=0),void 0===n&&(n=this.byteLength-r),i=new ArrayBuffer(n),e.next=5,t(i,"copied");case 5:this.write(i,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),r.readAsync=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t,r){return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=0),e.abrupt("return",this.readSyncWebGL(t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),r.mapAndReadAsync=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t,r,n){var i;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=0),e.next=3,this.readAsync(r,n);case 3:return i=e.sent,e.next=6,t(i.buffer,"copied");case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),r.readSyncWebGL=function(e,t){var r;void 0===e&&(e=0),t=null!=(r=t)?r:this.byteLength-e;var n=new Uint8Array(t);return this.gl.bindBuffer(h.GL.COPY_READ_BUFFER,this.handle),this.gl.getBufferSubData(h.GL.COPY_READ_BUFFER,e,n,0,t),this.gl.bindBuffer(h.GL.COPY_READ_BUFFER,null),this._setDebugData(n,e,t),n},t}(le.h);function he(e){var t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}var de=function(e){function t(t,r){var n;switch((n=e.call(this,t,r)||this).device=t,n.props.stage){case"vertex":n.handle=n.props.handle||n.device.gl.createShader(h.GL.VERTEX_SHADER);break;case"fragment":n.handle=n.props.handle||n.device.gl.createShader(h.GL.FRAGMENT_SHADER);break;default:throw new Error(n.props.stage)}return t._setWebGLDebugMetadata(n.handle,(0,o.A)(n),{spector:n.props}),n._compile(n.source),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)},r.getCompilationInfo=function(){var e=(0,ce.A)((0,M.A)().mark((function e(){return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._waitForCompilationComplete();case 2:return e.abrupt("return",this.getCompilationInfoSync());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getCompilationInfoSync=function(){var e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){for(var t,r=e.split(/\r?\n/),n=[],i=(0,f.A)(r);!(t=i()).done;){var a=t.value;if(!(a.length<=1)){var s=a.split(":");if(2!==s.length){var o=s[0],u=s[1],c=s[2],l=s.slice(3),h=parseInt(c,10);isNaN(h)&&(h=0);var d=parseInt(u,10);isNaN(d)&&(d=0),n.push({message:l.join(":").trim(),type:he(o),lineNum:h,linePos:d})}else{var _=s[0],L=s[1];n.push({message:L.trim(),type:he(_),lineNum:0,linePos:0})}}}return n}(e):[]},r.getTranslatedSource=function(){var e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return(null==e?void 0:e.getTranslatedShaderSource(this.handle))||null},r._compile=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t){var r;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t.startsWith("#version ")?t:"#version 300 es\n"+t,(r=this.device.gl).shaderSource(this.handle,t),r.compileShader(this.handle),this.device.props.debug){e.next=7;break}return this.compilationStatus="pending",e.abrupt("return");case 7:if(this.device.features.has("compilation-status-async-webgl")){e.next=13;break}if(this._getCompilationStatus(),this.debugShader(),"error"!==this.compilationStatus){e.next=12;break}throw new Error("GLSL compilation errors in "+this.props.stage+" shader "+this.props.id);case 12:return e.abrupt("return");case 13:return l.R.once(1,"Shader compilation is asynchronous")(),e.next=16,this._waitForCompilationComplete();case 16:l.R.info(2,"Shader "+this.id+" - async compilation complete: "+this.compilationStatus)(),this._getCompilationStatus(),this.debugShader();case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r._waitForCompilationComplete=function(){var e=(0,ce.A)((0,M.A)().mark((function e(){var t,r,n;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t){return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=10,this.device.features.has("compilation-status-async-webgl")){e.next=6;break}return e.next=5,t(r);case 5:return e.abrupt("return");case 6:n=this.device.gl;case 7:if(!n.getShaderParameter(this.handle,h.GL.COMPLETION_STATUS_KHR)){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t(r);case 12:e.next=7;break;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._getCompilationStatus=function(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,h.GL.COMPILE_STATUS)?"success":"error"},(0,s.A)(t,[{key:"asyncCompilationStatus",get:function(){var e=this;return this._waitForCompilationComplete().then((function(){return e._getCompilationStatus(),e.compilationStatus}))}}]),t}(r(349).M);function _e(e,t){var r=e,n=r.gl;if(t.cullMode)switch(t.cullMode){case"none":n.disable(h.GL.CULL_FACE);break;case"front":n.enable(h.GL.CULL_FACE),n.cullFace(h.GL.FRONT);break;case"back":n.enable(h.GL.CULL_FACE),n.cullFace(h.GL.BACK)}if(t.frontFace&&n.frontFace(Ge("frontFace",t.frontFace,{ccw:h.GL.CCW,cw:h.GL.CW})),t.unclippedDepth&&e.features.has("depth-clip-control")&&n.enable(h.GL.DEPTH_CLAMP_EXT),void 0!==t.depthBias&&(n.enable(h.GL.POLYGON_OFFSET_FILL),n.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){var i=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,a=Ge("provokingVertex",t.provokingVertex,{first:h.GL.FIRST_VERTEX_CONVENTION_WEBGL,last:h.GL.LAST_VERTEX_CONVENTION_WEBGL});null==i||i.provokingVertexWEBGL(a)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){var s=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Ge("polygonMode",t.polygonMode,{fill:h.GL.FILL_WEBGL,line:h.GL.LINE_WEBGL});null==s||s.polygonModeWEBGL(h.GL.FRONT,o),null==s||s.polygonModeWEBGL(h.GL.BACK,o)}t.polygonOffsetLine&&n.enable(h.GL.POLYGON_OFFSET_LINE_WEBGL)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&n.enable(h.GL.CLIP_DISTANCE0_WEBGL),t.clipDistance1&&n.enable(h.GL.CLIP_DISTANCE1_WEBGL),t.clipDistance2&&n.enable(h.GL.CLIP_DISTANCE2_WEBGL),t.clipDistance3&&n.enable(h.GL.CLIP_DISTANCE3_WEBGL),t.clipDistance4&&n.enable(h.GL.CLIP_DISTANCE4_WEBGL),t.clipDistance5&&n.enable(h.GL.CLIP_DISTANCE5_WEBGL),t.clipDistance6&&n.enable(h.GL.CLIP_DISTANCE6_WEBGL),t.clipDistance7&&n.enable(h.GL.CLIP_DISTANCE7_WEBGL)),void 0!==t.depthWriteEnabled&&n.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?n.enable(h.GL.DEPTH_TEST):n.disable(h.GL.DEPTH_TEST),n.depthFunc(Le("depthCompare",t.depthCompare))),t.stencilWriteMask){var u=t.stencilWriteMask;n.stencilMaskSeparate(h.GL.FRONT,u),n.stencilMaskSeparate(h.GL.BACK,u)}if(t.stencilReadMask&&l.R.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){var c=t.stencilReadMask||4294967295,f=Le("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?n.enable(h.GL.STENCIL_TEST):n.disable(h.GL.STENCIL_TEST),n.stencilFuncSeparate(h.GL.FRONT,f,0,c),n.stencilFuncSeparate(h.GL.BACK,f,0,c)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){var d=Ee("stencilPassOperation",t.stencilPassOperation),_=Ee("stencilFailOperation",t.stencilFailOperation),L=Ee("stencilDepthFailOperation",t.stencilDepthFailOperation);n.stencilOpSeparate(h.GL.FRONT,_,L,d),n.stencilOpSeparate(h.GL.BACK,_,L,d)}switch(t.blend){case!0:n.enable(h.GL.BLEND);break;case!1:n.disable(h.GL.BLEND)}if(t.blendColorOperation||t.blendAlphaOperation){var E=pe("blendColorOperation",t.blendColorOperation||"add"),p=pe("blendAlphaOperation",t.blendAlphaOperation||"add");n.blendEquationSeparate(E,p);var g=ge("blendColorSrcFactor",t.blendColorSrcFactor||"one"),G=ge("blendColorDstFactor",t.blendColorDstFactor||"zero"),m=ge("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),A=ge("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");n.blendFuncSeparate(g,G,m,A)}}function Le(e,t){return Ge(e,t,{never:h.GL.NEVER,less:h.GL.LESS,equal:h.GL.EQUAL,"less-equal":h.GL.LEQUAL,greater:h.GL.GREATER,"not-equal":h.GL.NOTEQUAL,"greater-equal":h.GL.GEQUAL,always:h.GL.ALWAYS})}function Ee(e,t){return Ge(e,t,{keep:h.GL.KEEP,zero:h.GL.ZERO,replace:h.GL.REPLACE,invert:h.GL.INVERT,"increment-clamp":h.GL.INCR,"decrement-clamp":h.GL.DECR,"increment-wrap":h.GL.INCR_WRAP,"decrement-wrap":h.GL.DECR_WRAP})}function pe(e,t){return Ge(e,t,{add:h.GL.FUNC_ADD,subtract:h.GL.FUNC_SUBTRACT,"reverse-subtract":h.GL.FUNC_REVERSE_SUBTRACT,min:h.GL.MIN,max:h.GL.MAX})}function ge(e,t,r){return void 0===r&&(r="color"),Ge(e,t,{one:h.GL.ONE,zero:h.GL.ZERO,src:h.GL.SRC_COLOR,"one-minus-src":h.GL.ONE_MINUS_SRC_COLOR,dst:h.GL.DST_COLOR,"one-minus-dst":h.GL.ONE_MINUS_DST_COLOR,"src-alpha":h.GL.SRC_ALPHA,"one-minus-src-alpha":h.GL.ONE_MINUS_SRC_ALPHA,"dst-alpha":h.GL.DST_ALPHA,"one-minus-dst-alpha":h.GL.ONE_MINUS_DST_ALPHA,"src-alpha-saturated":h.GL.SRC_ALPHA_SATURATE,constant:"color"===r?h.GL.CONSTANT_COLOR:h.GL.CONSTANT_ALPHA,"one-minus-constant":"color"===r?h.GL.ONE_MINUS_CONSTANT_COLOR:h.GL.ONE_MINUS_CONSTANT_ALPHA,src1:h.GL.SRC_COLOR,"one-minus-src1":h.GL.ONE_MINUS_SRC_COLOR,"src1-alpha":h.GL.SRC_ALPHA,"one-minus-src1-alpha":h.GL.ONE_MINUS_SRC_ALPHA})}function Ge(e,t,r){if(!(t in r))throw new Error(function(e,t){return"Illegal parameter "+t+" for "+e}(e,t));return r[t]}function me(e){var t=!0;for(var r in e){t=!1;break}return t}function Ae(e){var t={};return e.addressModeU&&(t[h.GL.TEXTURE_WRAP_S]=ve(e.addressModeU)),e.addressModeV&&(t[h.GL.TEXTURE_WRAP_T]=ve(e.addressModeV)),e.addressModeW&&(t[h.GL.TEXTURE_WRAP_R]=ve(e.addressModeW)),e.magFilter&&(t[h.GL.TEXTURE_MAG_FILTER]=Re(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[h.GL.TEXTURE_MIN_FILTER]=function(e,t){void 0===t&&(t="none");if(!t)return Re(e);switch(t){case"none":return Re(e);case"nearest":switch(e){case"nearest":return h.GL.NEAREST_MIPMAP_NEAREST;case"linear":return h.GL.LINEAR_MIPMAP_NEAREST}break;case"linear":switch(e){case"nearest":return h.GL.NEAREST_MIPMAP_LINEAR;case"linear":return h.GL.LINEAR_MIPMAP_LINEAR}}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[h.GL.TEXTURE_MIN_LOD]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[h.GL.TEXTURE_MAX_LOD]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[h.GL.TEXTURE_COMPARE_MODE]=h.GL.COMPARE_REF_TO_TEXTURE),e.compare&&(t[h.GL.TEXTURE_COMPARE_FUNC]=Le("compare",e.compare)),e.maxAnisotropy&&(t[h.GL.TEXTURE_MAX_ANISOTROPY_EXT]=e.maxAnisotropy),t}function ve(e){switch(e){case"clamp-to-edge":return h.GL.CLAMP_TO_EDGE;case"repeat":return h.GL.REPEAT;case"mirror-repeat":return h.GL.MIRRORED_REPEAT}}function Re(e){switch(e){case"nearest":return h.GL.NEAREST;case"linear":return h.GL.LINEAR}}var Te=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).device=t,n.parameters=Ae(r),n.handle=r.handle||n.device.gl.createSampler(),n._setSamplerParameters(n.parameters),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)},r.toString=function(){return"Sampler("+this.id+","+JSON.stringify(this.props)+")"},r._setSamplerParameters=function(e){for(var t=0,r=Object.entries(e);t<r.length;t++){var n=r[t],i=n[0],a=n[1],s=Number(i);switch(s){case h.GL.TEXTURE_MIN_LOD:case h.GL.TEXTURE_MAX_LOD:this.device.gl.samplerParameterf(this.handle,s,a);break;default:this.device.gl.samplerParameteri(this.handle,s,a)}}},t}(r(9532).L),Se=r(5839);function be(e,t,r){if(function(e){for(var t in e)return!1;return!0}(t))return r(e);var n,i=t.nocatch,a=void 0===i||i,s=P.get(e);if(s.push(),C(e,t),a)n=r(e),s.pop();else try{n=r(e)}finally{s.pop()}return n}var Ce=function(e){function t(t,r){var n;return(n=e.call(this,t,Object.assign({},Se.g.defaultProps,r))||this).device=t,n.gl=n.device.gl,n.handle=null,n.texture=r.texture,n}return(0,u.A)(t,e),t}(r(1213).X),Ne=function(e){function t(t,r){var n;(n=e.call(this,t,r)||this).sampler=void 0,n._textureUnit=0,n.device=t,n.gl=n.device.gl;var i=q(n.props.format);n.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return h.GL.TEXTURE_2D;case"3d":return h.GL.TEXTURE_3D;case"cube":return h.GL.TEXTURE_CUBE_MAP;case"2d-array":return h.GL.TEXTURE_2D_ARRAY}throw new Error(e)}(n.props.dimension),n.glInternalFormat=i.internalFormat,n.glFormat=i.format,n.glType=i.type,n.compressed=i.compressed,n.handle=n.props.handle||n.gl.createTexture(),n.device._setWebGLDebugMetadata(n.handle,(0,o.A)(n),{spector:n.props}),n.gl.bindTexture(n.glTarget,n.handle);var a=(0,o.A)(n),s=a.dimension,u=a.width,c=a.height,l=a.depth,f=a.mipLevels,d=a.glTarget,_=a.glInternalFormat;switch(s){case"2d":case"cube":n.gl.texStorage2D(d,f,_,u,c);break;case"2d-array":case"3d":n.gl.texStorage3D(d,f,_,u,c,l);break;default:throw new Error(s)}return n.gl.bindTexture(n.glTarget,null),n._initializeData(r.data),n.setSampler(n.props.sampler),n.view=new Ce(n.device,Object.assign({},n.props,{texture:(0,o.A)(n)})),Object.seal((0,o.A)(n)),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)},r.createView=function(e){return new Ce(this.device,Object.assign({},e,{texture:this}))},r.setSampler=function(t){void 0===t&&(t={}),e.prototype.setSampler.call(this,t);var r=Ae(this.sampler.props);this._setSamplerParameters(r)},r.copyImageData=function(e){var t,r=this,n=this._normalizeCopyImageDataOptions(e),i=n.data,a=this.width,s=this.height,o=this.depth,u=n.mipLevel,c=void 0===u?0:u,l=n.byteOffset,f=void 0===l?0:l,d=n.x,_=void 0===d?0:d,L=n.y,E=void 0===L?0:L,p=n.z,g=void 0===p?0:p,G=this.glFormat,m=this.glType,A=this.compressed,v=Ie(this.glTarget,this.dimension,o),R=this.compressed?{}:((t={})[h.GL.UNPACK_ROW_LENGTH]=n.bytesPerRow,t[h.GL.UNPACK_IMAGE_HEIGHT]=n.rowsPerImage,t);this.gl.bindTexture(v,this.handle),be(this.gl,R,(function(){switch(r.dimension){case"2d":case"cube":A?r.gl.compressedTexSubImage2D(v,c,_,E,a,s,G,i,f):r.gl.texSubImage2D(v,c,_,E,a,s,G,m,i,f);break;case"2d-array":case"3d":A?r.gl.compressedTexSubImage3D(v,c,_,E,g,a,s,o,G,i,f):r.gl.texSubImage3D(v,c,_,E,g,a,s,o,G,m,i,f)}})),this.gl.bindTexture(v,null)},r.copyExternalImage=function(e){var t,r=this,n=this._normalizeCopyExternalImageOptions(e);if(n.sourceX||n.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");var i=this.glFormat,a=this.glType,s=n.image,o=n.depth,u=n.mipLevel,c=n.x,l=n.y,f=n.z,d=n.width,_=n.height,L=Ie(this.glTarget,this.dimension,o),E=n.flipY?((t={})[h.GL.UNPACK_FLIP_Y_WEBGL]=!0,t):{};return this.gl.bindTexture(this.glTarget,this.handle),be(this.gl,E,(function(){switch(r.dimension){case"2d":case"cube":r.gl.texSubImage2D(L,u,c,l,d,_,i,a,s);break;case"2d-array":case"3d":r.gl.texSubImage3D(L,u,c,l,f,d,_,o,i,a,s)}})),this.gl.bindTexture(this.glTarget,null),{width:n.width,height:n.height}},r.generateMipmapsWebGL=function(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(l.R.warn(this+" is not renderable or filterable, may not be able to generate mipmaps")(),null!=e&&e.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){l.R.warn("Error generating mipmap for "+this+": "+t.message)()}finally{this.gl.bindTexture(this.glTarget,null)}},r._setSamplerParameters=function(e){l.R.log(2,this.id+" sampler parameters",this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(var t=0,r=Object.entries(e);t<r.length;t++){var n=r[t],i=n[0],a=n[1],s=Number(i),o=a;switch(s){case h.GL.TEXTURE_MIN_LOD:case h.GL.TEXTURE_MAX_LOD:this.gl.texParameterf(this.glTarget,s,o);break;case h.GL.TEXTURE_MAG_FILTER:case h.GL.TEXTURE_MIN_FILTER:case h.GL.TEXTURE_WRAP_S:case h.GL.TEXTURE_WRAP_T:case h.GL.TEXTURE_WRAP_R:this.gl.texParameteri(this.glTarget,s,o);break;case h.GL.TEXTURE_MAX_ANISOTROPY_EXT:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,s,o);break;case h.GL.TEXTURE_COMPARE_MODE:case h.GL.TEXTURE_COMPARE_FUNC:this.gl.texParameteri(this.glTarget,s,o)}}this.gl.bindTexture(this.glTarget,null)},r._getActiveUnit=function(){return this.gl.getParameter(h.GL.ACTIVE_TEXTURE)-h.GL.TEXTURE0},r._bind=function(e){var t=this.gl;return void 0!==e&&(this._textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.glTarget,this.handle),e},r._unbind=function(e){var t=this.gl;return void 0!==e&&(this._textureUnit=e,t.activeTexture(t.TEXTURE0+e)),t.bindTexture(this.glTarget,null),e},t}(Se.g);function Ie(e,t,r){return"cube"===t?h.GL.TEXTURE_CUBE_MAP_POSITIVE_X+r:e}var Fe,Pe,ye,xe=r(9853),Be=r(7172);function Oe(e){return we[e]}var De,we=((Fe={})[h.GL.FLOAT]="f32",Fe[h.GL.FLOAT_VEC2]="vec2<f32>",Fe[h.GL.FLOAT_VEC3]="vec3<f32>",Fe[h.GL.FLOAT_VEC4]="vec4<f32>",Fe[h.GL.INT]="i32",Fe[h.GL.INT_VEC2]="vec2<i32>",Fe[h.GL.INT_VEC3]="vec3<i32>",Fe[h.GL.INT_VEC4]="vec4<i32>",Fe[h.GL.UNSIGNED_INT]="u32",Fe[h.GL.UNSIGNED_INT_VEC2]="vec2<u32>",Fe[h.GL.UNSIGNED_INT_VEC3]="vec3<u32>",Fe[h.GL.UNSIGNED_INT_VEC4]="vec4<u32>",Fe[h.GL.BOOL]="f32",Fe[h.GL.BOOL_VEC2]="vec2<f32>",Fe[h.GL.BOOL_VEC3]="vec3<f32>",Fe[h.GL.BOOL_VEC4]="vec4<f32>",Fe[h.GL.FLOAT_MAT2]="mat2x2<f32>",Fe[h.GL.FLOAT_MAT2x3]="mat2x3<f32>",Fe[h.GL.FLOAT_MAT2x4]="mat2x4<f32>",Fe[h.GL.FLOAT_MAT3x2]="mat3x2<f32>",Fe[h.GL.FLOAT_MAT3]="mat3x3<f32>",Fe[h.GL.FLOAT_MAT3x4]="mat3x4<f32>",Fe[h.GL.FLOAT_MAT4x2]="mat4x2<f32>",Fe[h.GL.FLOAT_MAT4x3]="mat4x3<f32>",Fe[h.GL.FLOAT_MAT4]="mat4x4<f32>",Fe),Me=((Pe={})[h.GL.SAMPLER_2D]={viewDimension:"2d",sampleType:"float"},Pe[h.GL.SAMPLER_CUBE]={viewDimension:"cube",sampleType:"float"},Pe[h.GL.SAMPLER_3D]={viewDimension:"3d",sampleType:"float"},Pe[h.GL.SAMPLER_2D_SHADOW]={viewDimension:"3d",sampleType:"depth"},Pe[h.GL.SAMPLER_2D_ARRAY]={viewDimension:"2d-array",sampleType:"float"},Pe[h.GL.SAMPLER_2D_ARRAY_SHADOW]={viewDimension:"2d-array",sampleType:"depth"},Pe[h.GL.SAMPLER_CUBE_SHADOW]={viewDimension:"cube",sampleType:"float"},Pe[h.GL.INT_SAMPLER_2D]={viewDimension:"2d",sampleType:"sint"},Pe[h.GL.INT_SAMPLER_3D]={viewDimension:"3d",sampleType:"sint"},Pe[h.GL.INT_SAMPLER_CUBE]={viewDimension:"cube",sampleType:"sint"},Pe[h.GL.INT_SAMPLER_2D_ARRAY]={viewDimension:"2d-array",sampleType:"uint"},Pe[h.GL.UNSIGNED_INT_SAMPLER_2D]={viewDimension:"2d",sampleType:"uint"},Pe[h.GL.UNSIGNED_INT_SAMPLER_3D]={viewDimension:"3d",sampleType:"uint"},Pe[h.GL.UNSIGNED_INT_SAMPLER_CUBE]={viewDimension:"cube",sampleType:"uint"},Pe[h.GL.UNSIGNED_INT_SAMPLER_2D_ARRAY]={viewDimension:"2d-array",sampleType:"uint"},Pe),Ue={uint8:h.GL.UNSIGNED_BYTE,sint8:h.GL.BYTE,unorm8:h.GL.UNSIGNED_BYTE,snorm8:h.GL.BYTE,uint16:h.GL.UNSIGNED_SHORT,sint16:h.GL.SHORT,unorm16:h.GL.UNSIGNED_SHORT,snorm16:h.GL.SHORT,uint32:h.GL.UNSIGNED_INT,sint32:h.GL.INT,float16:h.GL.HALF_FLOAT,float32:h.GL.FLOAT};(ye={})[h.GL.BYTE]=["sint8","snorm16"],ye[h.GL.UNSIGNED_BYTE]=["uint8","unorm8"],ye[h.GL.SHORT]=["sint16","unorm16"],ye[h.GL.UNSIGNED_SHORT]=["uint16","unorm16"],ye[h.GL.INT]=["sint32","sint32"],ye[h.GL.UNSIGNED_INT]=["uint32","uint32"],ye[h.GL.FLOAT]=["float32","float32"],ye[h.GL.HALF_FLOAT]=["float16","float16"];function ke(e,t){var r={attributes:[],bindings:[]};r.attributes=function(e,t){for(var r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=e.getActiveAttrib(t,i);if(!a)throw new Error("activeInfo");var s=a.name,o=a.type,u=e.getAttribLocation(t,s);if(u>=0){var c=Oe(o),l=/instance/i.test(s)?"instance":"vertex";r.push({name:s,location:u,stepMode:l,type:c})}}return r.sort((function(e,t){return e.location-t.location})),r}(e,t);for(var n=function(e,t){for(var r=function(r,n){return e.getActiveUniformBlockParameter(t,r,n)},n=[],i=e.getProgramParameter(t,h.GL.ACTIVE_UNIFORM_BLOCKS),a=0;a<i;a++){for(var s={name:e.getActiveUniformBlockName(t,a)||"",location:r(a,h.GL.UNIFORM_BLOCK_BINDING),byteLength:r(a,h.GL.UNIFORM_BLOCK_DATA_SIZE),vertex:r(a,h.GL.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),fragment:r(a,h.GL.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),uniformCount:r(a,h.GL.UNIFORM_BLOCK_ACTIVE_UNIFORMS),uniforms:[]},o=r(a,h.GL.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)||[],u=e.getActiveUniforms(t,o,h.GL.UNIFORM_TYPE),c=e.getActiveUniforms(t,o,h.GL.UNIFORM_SIZE),l=e.getActiveUniforms(t,o,h.GL.UNIFORM_OFFSET),f=e.getActiveUniforms(t,o,h.GL.UNIFORM_ARRAY_STRIDE),d=0;d<s.uniformCount;++d){var _=e.getActiveUniform(t,o[d]);if(!_)throw new Error("activeInfo");var L=Oe(u[d]);s.uniforms.push({name:_.name,format:L,type:u[d],arrayLength:c[d],byteOffset:l[d],byteStride:f[d]})}n.push(s)}return n.sort((function(e,t){return e.location-t.location})),n}(e,t),i=0,a=n;i<a.length;i++){var s=a[i],o=s.uniforms.map((function(e){return{name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength}}));r.bindings.push({type:"uniform",name:s.name,group:0,location:s.location,visibility:(s.vertex?1:0)&(s.fragment?2:0),minBindingSize:s.byteLength,uniforms:o})}for(var u,c,l=function(e,t){for(var r=[],n=e.getProgramParameter(t,h.GL.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=e.getActiveUniform(t,i);if(!a)throw new Error("activeInfo");var s=a.name,o=a.size,u=a.type,c=He(s),l=c.name,f=c.isArray,d=e.getUniformLocation(t,l),_={location:d,name:l,size:o,type:u,isArray:f};if(r.push(_),_.size>1)for(var L=0;L<_.size;L++){var E=l+"["+L+"]";d=e.getUniformLocation(t,E);var p=Object.assign({},_,{name:E,location:d});r.push(p)}}return r}(e,t),f=0,d=0,_=l;d<_.length;d++){var L=_[d];if(c=L.type,Boolean(Me[c])){var E=(u=L.type,Me[u]),p=E.viewDimension,g=E.sampleType;r.bindings.push({type:"texture",name:L.name,group:0,location:f,viewDimension:p,sampleType:g}),L.textureUnit=f,f+=1}}l.length&&(r.uniforms=l);var G=function(e,t){for(var r=[],n=e.getProgramParameter(t,h.GL.TRANSFORM_FEEDBACK_VARYINGS),i=0;i<n;i++){var a=e.getTransformFeedbackVarying(t,i);if(!a)throw new Error("activeInfo");var s=a.name,o=a.type,u=a.size,c=Oe(o),l=(0,Be.k0)(c),f=l.type,d=l.components;r.push({location:i,name:s,type:f,size:u*d})}return r.sort((function(e,t){return e.location-t.location})),r}(e,t);return null!=G&&G.length&&(r.varyings=G),r}function He(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};var t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name "+e);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function We(e,t,r,n){var i=e,a=n;!0===a&&(a=1),!1===a&&(a=0);var s="number"==typeof a?[a]:a;switch(r){case h.GL.SAMPLER_2D:case h.GL.SAMPLER_CUBE:case h.GL.SAMPLER_3D:case h.GL.SAMPLER_2D_SHADOW:case h.GL.SAMPLER_2D_ARRAY:case h.GL.SAMPLER_2D_ARRAY_SHADOW:case h.GL.SAMPLER_CUBE_SHADOW:case h.GL.INT_SAMPLER_2D:case h.GL.INT_SAMPLER_3D:case h.GL.INT_SAMPLER_CUBE:case h.GL.INT_SAMPLER_2D_ARRAY:case h.GL.UNSIGNED_INT_SAMPLER_2D:case h.GL.UNSIGNED_INT_SAMPLER_3D:case h.GL.UNSIGNED_INT_SAMPLER_CUBE:case h.GL.UNSIGNED_INT_SAMPLER_2D_ARRAY:if("number"!=typeof n)throw new Error("samplers must be set to integers");return e.uniform1i(t,n);case h.GL.FLOAT:return e.uniform1fv(t,s);case h.GL.FLOAT_VEC2:return e.uniform2fv(t,s);case h.GL.FLOAT_VEC3:return e.uniform3fv(t,s);case h.GL.FLOAT_VEC4:return e.uniform4fv(t,s);case h.GL.INT:return e.uniform1iv(t,s);case h.GL.INT_VEC2:return e.uniform2iv(t,s);case h.GL.INT_VEC3:return e.uniform3iv(t,s);case h.GL.INT_VEC4:return e.uniform4iv(t,s);case h.GL.BOOL:return e.uniform1iv(t,s);case h.GL.BOOL_VEC2:return e.uniform2iv(t,s);case h.GL.BOOL_VEC3:return e.uniform3iv(t,s);case h.GL.BOOL_VEC4:return e.uniform4iv(t,s);case h.GL.UNSIGNED_INT:return i.uniform1uiv(t,s,1);case h.GL.UNSIGNED_INT_VEC2:return i.uniform2uiv(t,s,2);case h.GL.UNSIGNED_INT_VEC3:return i.uniform3uiv(t,s,3);case h.GL.UNSIGNED_INT_VEC4:return i.uniform4uiv(t,s,4);case h.GL.FLOAT_MAT2:return e.uniformMatrix2fv(t,!1,s);case h.GL.FLOAT_MAT3:return e.uniformMatrix3fv(t,!1,s);case h.GL.FLOAT_MAT4:return e.uniformMatrix4fv(t,!1,s);case h.GL.FLOAT_MAT2x3:return i.uniformMatrix2x3fv(t,!1,s);case h.GL.FLOAT_MAT2x4:return i.uniformMatrix2x4fv(t,!1,s);case h.GL.FLOAT_MAT3x2:return i.uniformMatrix3x2fv(t,!1,s);case h.GL.FLOAT_MAT3x4:return i.uniformMatrix3x4fv(t,!1,s);case h.GL.FLOAT_MAT4x2:return i.uniformMatrix4x2fv(t,!1,s);case h.GL.FLOAT_MAT4x3:return i.uniformMatrix4x3fv(t,!1,s)}throw new Error("Illegal uniform")}De=Symbol.toStringTag;var Ve=function(e){function t(t,r){var n;(n=e.call(this,t,r)||this).uniforms={},n.bindings={},n.varyings=null,n._uniformCount=0,n._uniformSetters={},n.device=t,n.handle=n.props.handle||n.device.gl.createProgram(),n.device._setWebGLDebugMetadata(n.handle,(0,o.A)(n),{spector:{id:n.props.id}}),n.vs=r.vs,n.fs=r.fs;var i=r.varyings,a=r.bufferMode,s=void 0===a?h.GL.SEPARATE_ATTRIBS:a;return i&&i.length>0&&(n.varyings=i,n.device.gl.transformFeedbackVaryings(n.handle,i,s)),n._linkShaders(),l.R.time(3,"RenderPipeline "+n.id+" - shaderLayout introspection")(),n.introspectedLayout=ke(n.device.gl,n.handle),l.R.timeEnd(3,"RenderPipeline "+n.id+" - shaderLayout introspection")(),n.shaderLayout=r.shaderLayout?function(e,t){for(var r,n=Object.assign({},e,{attributes:e.attributes.map((function(e){return Object.assign({},e)}))}),i=function(){var e=r.value,t=n.attributes.find((function(t){return t.name===e.name}));t?(t.type=e.type||t.type,t.stepMode=e.stepMode||t.stepMode):l.R.warn("shader layout attribute "+e.name+" not present in shader")},a=(0,f.A)((null==t?void 0:t.attributes)||[]);!(r=a()).done;)i();return n}(n.introspectedLayout,r.shaderLayout):n.introspectedLayout,n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)},r.setBindings=function(e,t){for(var r=this,n=function(){var e=a[i],n=e[0],s=e[1],o=r.shaderLayout.bindings.find((function(e){return e.name===n}))||r.shaderLayout.bindings.find((function(e){return e.name===n+"Uniforms"}));if(!o){var u=r.shaderLayout.bindings.map((function(e){return'"'+e.name+'"'})).join(", ");return null!=t&&t.disableWarnings||l.R.warn('No binding "'+n+'" in render pipeline "'+r.id+'", expected one of '+u,s)(),1}switch(s||l.R.warn('Unsetting binding "'+n+'" in render pipeline "'+r.id+'"')(),o.type){case"uniform":if(!(s instanceof fe||s.buffer instanceof fe))throw new Error("buffer value");break;case"texture":if(!(s instanceof Ce||s instanceof Ne||s instanceof ie))throw new Error(r+" Bad texture binding for "+n);break;case"sampler":l.R.warn("Ignoring sampler "+n)();break;default:throw new Error(o.type)}r.bindings[n]=s},i=0,a=Object.entries(e);i<a.length;i++)n()},r.draw=function(e){var t,r=this,n=e.renderPass,i=e.parameters,a=void 0===i?this.props.parameters:i,s=e.topology,o=void 0===s?this.props.topology:s,u=e.vertexArray,c=e.vertexCount,f=e.instanceCount,d=e.isInstanced,_=void 0!==d&&d,L=e.firstVertex,E=void 0===L?0:L,p=e.transformFeedback,g=function(e){switch(e){case"point-list":return h.GL.POINTS;case"line-list":return h.GL.LINES;case"line-strip":return h.GL.LINE_STRIP;case"triangle-list":return h.GL.TRIANGLES;case"triangle-strip":return h.GL.TRIANGLE_STRIP;default:throw new Error(e)}}(o),G=Boolean(u.indexBuffer),m=null==(t=u.indexBuffer)?void 0:t.glIndexType;if("success"!==this.linkStatus)return l.R.info(2,"RenderPipeline:"+this.id+".draw() aborted - waiting for shader linking")(),!1;if(!this._areTexturesRenderable())return l.R.info(2,"RenderPipeline:"+this.id+".draw() aborted - textures not yet loaded")(),!1;this.device.gl.useProgram(this.handle),u.bindBeforeRender(n),p&&p.begin(this.props.topology),this._applyBindings(),this._applyUniforms();var A=n;return function(e,t,r,n){if(me(t))return n(e);var i=e;i.pushState();try{return _e(e,t),C(i.gl,r),n(e)}finally{i.popState()}}(this.device,a,A.glParameters,(function(){G&&_?r.device.gl.drawElementsInstanced(g,c||0,m,E,f||0):G?r.device.gl.drawElements(g,c||0,m,E):_?r.device.gl.drawArraysInstanced(g,E,c||0,f||0):r.device.gl.drawArrays(g,E,c||0),p&&p.end()})),u.unbindAfterRender(n),!0},r._linkShaders=function(){var e=(0,ce.A)((0,M.A)().mark((function e(){var t,r,n;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.device.gl).attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),l.R.time(4,"linkProgram for "+this.id)(),t.linkProgram(this.handle),l.R.timeEnd(4,"linkProgram for "+this.id)(),l.R.level,this.device.features.has("compilation-status-async-webgl")){e.next=11;break}return r=this._getLinkStatus(),this._reportLinkStatus(r),e.abrupt("return");case 11:return l.R.once(1,"RenderPipeline linking is asynchronous")(),e.next=14,this._waitForLinkComplete();case 14:l.R.info(2,"RenderPipeline "+this.id+" - async linking complete: "+this.linkStatus)(),n=this._getLinkStatus(),this._reportLinkStatus(n);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._reportLinkStatus=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t){var r,n,i;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="success"===e.t0?3:4;break;case 3:return e.abrupt("return");case 4:n="link-error"===t?"Link error":"Validation error",e.t1=this.vs.compilationStatus,e.next="error"===e.t1?8:"pending"===e.t1?10:"success"===e.t1?14:15;break;case 8:throw this.vs.debugShader(),new Error(this+" "+n+" during compilation of "+this.vs);case 10:return e.next=12,this.vs.asyncCompilationStatus;case 12:return this.vs.debugShader(),e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:e.t2=null==(r=this.fs)?void 0:r.compilationStatus,e.next="error"===e.t2?18:"pending"===e.t2?20:"success"===e.t2?24:25;break;case 18:throw this.fs.debugShader(),new Error(this+" "+n+" during compilation of "+this.fs);case 20:return e.next=22,this.fs.asyncCompilationStatus;case 22:return this.fs.debugShader(),e.abrupt("break",25);case 24:return e.abrupt("break",25);case 25:i=this.device.gl.getProgramInfoLog(this.handle),this.device.reportError(new Error(n+" during "+t+": "+i),this)(),this.device.debug();case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r._getLinkStatus=function(){var e=this.device.gl;return e.getProgramParameter(this.handle,h.GL.LINK_STATUS)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,h.GL.VALIDATE_STATUS)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")},r._waitForLinkComplete=function(){var e=(0,ce.A)((0,M.A)().mark((function e(){var t,r,n;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(){var e=(0,ce.A)((0,M.A)().mark((function e(t){return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=10,this.device.features.has("compilation-status-async-webgl")){e.next=6;break}return e.next=5,t(r);case 5:return e.abrupt("return");case 6:n=this.device.gl;case 7:if(!n.getProgramParameter(this.handle,h.GL.COMPLETION_STATUS_KHR)){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,t(r);case 12:e.next=7;break;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._areTexturesRenderable=function(){for(var e,t=!0,r=(0,f.A)(this.shaderLayout.bindings);!(e=r()).done;){var n=e.value;this.bindings[n.name]||this.bindings[n.name.replace(/Uniforms$/,"")]||(l.R.warn("Binding "+n.name+" not found in "+this.id)(),t=!1)}return t},r._applyBindings=function(){if("success"===this.linkStatus){var e=this.device.gl;e.useProgram(this.handle);for(var t,r=0,n=0,i=(0,f.A)(this.shaderLayout.bindings);!(t=i()).done;){var a=t.value,s=this.bindings[a.name]||this.bindings[a.name.replace(/Uniforms$/,"")];if(!s)throw new Error("No value for binding "+a.name+" in "+this.id);switch(a.type){case"uniform":var o=a.name,u=e.getUniformBlockIndex(this.handle,o);if(u===h.GL.INVALID_INDEX)throw new Error("Invalid uniform block name "+o);e.uniformBlockBinding(this.handle,n,u),s instanceof fe?e.bindBufferBase(h.GL.UNIFORM_BUFFER,n,s.handle):e.bindBufferRange(h.GL.UNIFORM_BUFFER,n,s.buffer.handle,s.offset||0,s.size||s.buffer.byteLength-s.offset),n+=1;break;case"texture":if(!(s instanceof Ce||s instanceof Ne||s instanceof ie))throw new Error("texture");var c=void 0;if(s instanceof Ce)c=s.texture;else if(s instanceof Ne)c=s;else{if(!(s instanceof ie&&s.colorAttachments[0]instanceof Ce))throw new Error("No texture");l.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=s.colorAttachments[0].texture}e.activeTexture(h.GL.TEXTURE0+r),e.bindTexture(c.glTarget,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error("binding type '"+a.type+"' not supported in WebGL")}}}},r._applyUniforms=function(){for(var e,t=(0,f.A)(this.shaderLayout.uniforms||[]);!(e=t()).done;){var r,n=e.value,i=n.name,a=n.location,s=n.type,o=n.textureUnit,u=null!=(r=this.uniforms[i])?r:o;void 0!==u&&We(this.device.gl,a,s,u)}},(0,s.A)(t,[{key:De,get:function(){return"WEBGLRenderPipeline"}}]),t}(xe.r);var Ke=r(7608),Xe=function(e){function t(t){var r;return(r=e.call(this,t,{})||this).handle=null,r.commands=[],r.device=t,r}return(0,u.A)(t,e),t.prototype._executeCommands=function(e){void 0===e&&(e=this.commands);for(var t,r=(0,f.A)(e);!(t=r()).done;){var n=t.value;switch(n.name){case"copy-buffer-to-buffer":Ye(this.device,n.options);break;case"copy-buffer-to-texture":ze(this.device,n.options);break;case"copy-texture-to-buffer":je(this.device,n.options);break;case"copy-texture-to-texture":Qe(this.device,n.options);break;default:throw new Error(n.name)}}},t}(r(2920).M);function Ye(e,t){var r,n,i=t.sourceBuffer,a=t.destinationBuffer;e.gl.bindBuffer(h.GL.COPY_READ_BUFFER,i.handle),e.gl.bindBuffer(h.GL.COPY_WRITE_BUFFER,a.handle),e.gl.copyBufferSubData(h.GL.COPY_READ_BUFFER,h.GL.COPY_WRITE_BUFFER,null!=(r=t.sourceOffset)?r:0,null!=(n=t.destinationOffset)?n:0,t.size),e.gl.bindBuffer(h.GL.COPY_READ_BUFFER,null),e.gl.bindBuffer(h.GL.COPY_WRITE_BUFFER,null)}function ze(e,t){throw new Error("Not implemented")}function je(e,t){var r=t.sourceTexture,n=t.mipLevel,i=void 0===n?0:n,a=t.aspect,s=void 0===a?"all":a,o=t.width,u=void 0===o?t.sourceTexture.width:o,c=t.height,l=void 0===c?t.sourceTexture.height:c,f=t.depthOrArrayLayers,d=void 0===f?0:f,_=t.origin,L=void 0===_?[0,0]:_,E=t.destinationBuffer,p=t.byteOffset,g=void 0===p?0:p,G=t.bytesPerRow,m=t.rowsPerImage;if("all"!==s)throw new Error("aspect not supported in WebGL");if(0!==i||0!==d||G||m)throw new Error("not implemented");var A,v=qe(r),R=v.framebuffer,T=v.destroyFramebuffer;try{var S=E,b=u||R.width,C=l||R.height,N=q(R.colorAttachments[0].texture.props.format),I=N.format,F=N.type;e.gl.bindBuffer(h.GL.PIXEL_PACK_BUFFER,S.handle),A=e.gl.bindFramebuffer(h.GL.FRAMEBUFFER,R.handle),e.gl.readPixels(L[0],L[1],b,C,I,F,g)}finally{e.gl.bindBuffer(h.GL.PIXEL_PACK_BUFFER,null),void 0!==A&&e.gl.bindFramebuffer(h.GL.FRAMEBUFFER,A),T&&R.destroy()}}function Qe(e,t){var r,n,i=t.sourceTexture,a=t.destinationMipLevel,s=void 0===a?0:a,o=t.origin,u=void 0===o?[0,0]:o,c=t.destinationOrigin,l=void 0===c?[0,0]:c,f=t.destinationTexture,d=t.width,_=void 0===d?t.destinationTexture.width:d,L=t.height,E=void 0===L?t.destinationTexture.height:L,p=qe(i),g=p.framebuffer,G=p.destroyFramebuffer,m=u[0],A=u[1],v=l[0],R=l[1],T=l[2],S=e.gl.bindFramebuffer(h.GL.FRAMEBUFFER,g.handle);if(!(f instanceof Ne))throw new Error("invalid destination");switch(r=f,_=Number.isFinite(_)?_:r.width,E=Number.isFinite(E)?E:r.height,r._bind(0),n=r.glTarget){case h.GL.TEXTURE_2D:case h.GL.TEXTURE_CUBE_MAP:e.gl.copyTexSubImage2D(n,s,v,R,m,A,_,E);break;case h.GL.TEXTURE_2D_ARRAY:case h.GL.TEXTURE_3D:e.gl.copyTexSubImage3D(n,s,v,R,T,m,A,_,E)}r&&r._unbind(),e.gl.bindFramebuffer(h.GL.FRAMEBUFFER,S),G&&g.destroy()}function qe(e){if(e instanceof Se.g){var t=e.width,r=e.height,n=e.id;return{framebuffer:e.device.createFramebuffer({id:"framebuffer-for-"+n,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}var Ze,Je=r(6730),$e=[1,2,4,8],et=function(e){function t(t,r){var n,i,a;if((i=e.call(this,t,r)||this).handle=null,i.glParameters={},i.device=t,null==r||null==(n=r.parameters)||!n.viewport)if(null!=r&&r.framebuffer){var s=r.framebuffer;a=[0,0,s.width,s.height]}else{var o=t.getDefaultCanvasContext().getDrawingBufferSize();a=[0,0,o[0],o[1]]}i.device.pushState(),i.setParameters(Object.assign({viewport:a},i.props.parameters));var u=i.props.framebuffer;if(i.props.framebuffer&&null!=u&&u.handle){var c=i.props.framebuffer.colorAttachments.map((function(e,t){return h.GL.COLOR_ATTACHMENT0+t}));i.device.gl.drawBuffers(c)}else i.device.gl.drawBuffers([h.GL.BACK]);return i.clear(),i}(0,u.A)(t,e);var r=t.prototype;return r.end=function(){this.device.popState()},r.pushDebugGroup=function(e){},r.popDebugGroup=function(){},r.insertDebugMarker=function(e){},r.setParameters=function(e){void 0===e&&(e={});var t=Object.assign({},this.glParameters);t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[h.GL.RASTERIZER_DISCARD]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[h.GL.STENCIL_REF]=e.stencilReference),"colorMask"in e&&(t.colorMask=$e.map((function(t){return Boolean(t&e.colorMask)}))),this.glParameters=t,C(this.device.gl,t)},r.beginOcclusionQuery=function(e){var t=this.props.occlusionQuerySet;null==t||t.beginOcclusionQuery()},r.endOcclusionQuery=function(){var e=this.props.occlusionQuerySet;null==e||e.endOcclusionQuery()},r.clear=function(){var e=this,t=Object.assign({},this.glParameters),r=0;this.props.clearColors&&this.props.clearColors.forEach((function(t,r){t&&e.clearColorBuffer(r,t)})),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(r|=h.GL.COLOR_BUFFER_BIT,t.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(r|=h.GL.DEPTH_BUFFER_BIT,t.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(r|=h.GL.STENCIL_BUFFER_BIT,t.clearStencil=this.props.clearStencil),0!==r&&be(this.device.gl,t,(function(){e.device.gl.clear(r)}))},r.clearColorBuffer=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=[0,0,0,0]),be(this.device.gl,{framebuffer:this.props.framebuffer},(function(){switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:r.device.gl.clearBufferiv(h.GL.COLOR,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:r.device.gl.clearBufferuiv(h.GL.COLOR,e,t);break;case Float32Array:r.device.gl.clearBufferfv(h.GL.COLOR,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}}))},t}(Je.A),tt=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).handle=null,n.device=t,n.commandBuffer=new Xe(t),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){},r.finish=function(){return this.commandBuffer},r.beginRenderPass=function(e){return new et(this.device,e)},r.beginComputePass=function(e){throw new Error("ComputePass not supported in WebGL")},r.copyBufferToBuffer=function(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})},r.copyBufferToTexture=function(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})},r.copyTextureToBuffer=function(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})},r.copyTextureToTexture=function(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})},r.pushDebugGroup=function(e){},r.popDebugGroup=function(){},r.insertDebugMarker=function(e){},r.resolveQuerySet=function(e,t,r){},t}(Ke.i),rt=r(8397),nt=r(7896),it=r(7651);Ze=Symbol.toStringTag;var at=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).buffer=null,n.bufferValue=null,n.device=t,n.handle=n.device.gl.createVertexArray(),n}(0,u.A)(t,e),t.isConstantAttributeZeroSupported=function(e){return"Chrome"===(0,it.X)()};var r=t.prototype;return r.destroy=function(){var t;(e.prototype.destroy.call(this),this.buffer)&&(null==(t=this.buffer)||t.destroy());this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)},r.setIndexBuffer=function(e){var t=e;if(t&&t.glTarget!==h.GL.ELEMENT_ARRAY_BUFFER)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(h.GL.ELEMENT_ARRAY_BUFFER,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)},r.setBuffer=function(e,t){var r=t;if(r.glTarget===h.GL.ELEMENT_ARRAY_BUFFER)throw new Error("Use .setIndexBuffer()");var n=this._getAccessor(e),i=n.size,a=n.type,s=n.stride,o=n.offset,u=n.normalized,c=n.integer,l=n.divisor;this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(h.GL.ARRAY_BUFFER,r.handle),c?this.device.gl.vertexAttribIPointer(e,i,a,s,o):this.device.gl.vertexAttribPointer(e,i,a,u,s,o),this.device.gl.bindBuffer(h.GL.ARRAY_BUFFER,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,l||0),this.attributes[e]=r,this.device.gl.bindVertexArray(null)},r.setConstantWebGL=function(e,t){this._enable(e,!1),this.attributes[e]=t},r.bindBeforeRender=function(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()},r.unbindAfterRender=function(){this.device.gl.bindVertexArray(null)},r._applyConstantAttributes=function(){for(var e=0;e<this.maxVertexAttributes;++e){var t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}},r._getAccessor=function(e){var t=this.attributeInfos[e];if(!t)throw new Error("Unknown attribute location "+e);var r=k(t.bufferDataType);return{size:t.bufferComponents,type:r,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}},r._enable=function(e,r){void 0===r&&(r=!0);var n=t.isConstantAttributeZeroSupported(this.device);(r||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))},r.getConstantBuffer=function(e,t){var r=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),n=r.byteLength*e,i=r.length*e;if(this.buffer&&n!==this.buffer.byteLength)throw new Error("Buffer size is immutable, byte length "+n+" !== "+this.buffer.byteLength+".");var a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:n}),a||(a=!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(r,this.bufferValue)),a){var s=(0,rt.X)(t.constructor,i);!function(e){for(var t=e.target,r=e.source,n=e.start,i=void 0===n?0:n,a=e.count,s=void 0===a?1:a,o=r.length,u=s*o,c=0,l=i;c<o;c++)t[l++]=r[c];for(;c<u;)c<u-c?(t.copyWithin(i+c,i,i+c),c*=2):(t.copyWithin(i+c,i,i+u-c),c=u);e.target}({target:s,source:r,start:0,count:i}),this.buffer.write(s),this.bufferValue=t}return this.buffer},(0,s.A)(t,[{key:Ze,get:function(){return"VertexArray"}}]),t}(nt.o);var st,ot=r(8314);st=Symbol.toStringTag;var ut=function(e){function t(r,n){return e.call(this,r,n,t.defaultProps)||this}return(0,u.A)(t,e),(0,s.A)(t,[{key:st,get:function(){return"TransformFeedback"}}]),t}(ot.F);ut.defaultProps=Object.assign({},ot.F.defaultProps,{layout:void 0,buffers:{}});var ct=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).buffers={},n.unusedBuffers={},n.bindOnUse=!0,n._bound=!1,n.device=t,n.gl=t.gl,n.handle=n.props.handle||n.gl.createTransformFeedback(),n.layout=n.props.layout,r.buffers&&n.setBuffers(r.buffers),Object.seal((0,o.A)(n)),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.gl.deleteTransformFeedback(this.handle),e.prototype.destroy.call(this)},r.begin=function(e){void 0===e&&(e="point-list"),this.gl.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return h.GL.POINTS;case"line-list":case"line-strip":return h.GL.LINES;case"triangle-list":case"triangle-strip":return h.GL.TRIANGLES;default:throw new Error(e)}}(e))},r.end=function(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,null)},r.setBuffers=function(e){var t=this;this.buffers={},this.unusedBuffers={},this.bind((function(){for(var r in e)t.setBuffer(r,e[r])}))},r.setBuffer=function(e,t){var r=this._getVaryingIndex(e),n=this._getBufferRange(t),i=n.buffer,a=n.byteLength,s=n.byteOffset;if(r<0)return this.unusedBuffers[e]=i,void l.R.warn(this.id+" unusedBuffers varying buffer "+e)();this.buffers[r]={buffer:i,byteLength:a,byteOffset:s},this.bindOnUse||this._bindBuffer(r,i,s,a)},r.getBuffer=function(e){if(lt(e))return this.buffers[e]||null;var t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null},r.bind=function(e){return void 0===e&&(e=this.handle),"function"!=typeof e?(this.gl.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,e),this):(this._bound?t=e():(this.gl.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(h.GL.TRANSFORM_FEEDBACK,null)),t);var t},r.unbind=function(){this.bind(null)},r._getBufferRange=function(e){if(e instanceof fe)return{buffer:e,byteOffset:0,byteLength:e.byteLength};var t=e.buffer,r=e.byteOffset,n=void 0===r?0:r,i=e.byteLength;return{buffer:t,byteOffset:n,byteLength:void 0===i?e.buffer.byteLength:i}},r._getVaryingIndex=function(e){if(lt(e))return Number(e);for(var t,r=(0,f.A)(this.layout.varyings||[]);!(t=r()).done;){var n=t.value;if(e===n.name)return n.location}return-1},r._bindBuffers=function(){for(var e in this.buffers){var t=this._getBufferRange(this.buffers[e]),r=t.buffer,n=t.byteLength,i=t.byteOffset;this._bindBuffer(Number(e),r,i,n)}},r._unbindBuffers=function(){for(var e in this.buffers)this.gl.bindBufferBase(h.GL.TRANSFORM_FEEDBACK_BUFFER,Number(e),null)},r._bindBuffer=function(e,t,r,n){void 0===r&&(r=0);var i=t&&t.handle;i&&void 0!==n?this.gl.bindBufferRange(h.GL.TRANSFORM_FEEDBACK_BUFFER,e,i,r,n):this.gl.bindBufferBase(h.GL.TRANSFORM_FEEDBACK_BUFFER,e,i)},t}(ut);function lt(e){return"number"==typeof e?Number.isInteger(e):/^\d+$/.test(e)}var ft,ht=r(6273);ft=Symbol.toStringTag;var dt,_t=function(e){function t(t,r){var n;if((n=e.call(this,t,r)||this).target=null,n._queryPending=!1,n._pollingPromise=null,n.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");var i=n.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");return n.handle=i,Object.seal((0,o.A)(n)),n}(0,u.A)(t,e);var r=t.prototype;return r.destroy=function(){this.device.gl.deleteQuery(this.handle)},r.beginTimestampQuery=function(){return this._begin(h.GL.TIME_ELAPSED_EXT)},r.endTimestampQuery=function(){this._end()},r.beginOcclusionQuery=function(e){return this._begin(null!=e&&e.conservative?h.GL.ANY_SAMPLES_PASSED_CONSERVATIVE:h.GL.ANY_SAMPLES_PASSED)},r.endOcclusionQuery=function(){this._end()},r.beginTransformFeedbackQuery=function(){return this._begin(h.GL.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN)},r.endTransformFeedbackQuery=function(){this._end()},r.resolveQuery=function(){var e=(0,ce.A)((0,M.A)().mark((function e(){var t;return(0,M.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pollQuery();case 2:return t=e.sent,e.abrupt("return",[t]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r._begin=function(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))},r._end=function(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)},r.isResultAvailable=function(){if(!this._queryPending)return!1;var e=this.device.gl.getQueryParameter(this.handle,h.GL.QUERY_RESULT_AVAILABLE);return e&&(this._queryPending=!1),e},r.isTimerDisjoint=function(){return this.device.gl.getParameter(h.GL.GPU_DISJOINT_EXT)},r.getResult=function(){return this.device.gl.getQueryParameter(this.handle,h.GL.QUERY_RESULT)},r.getTimerMilliseconds=function(){return this.getResult()/1e6},r.pollQuery=function(e){var t=this;if(void 0===e&&(e=Number.POSITIVE_INFINITY),this._pollingPromise)return this._pollingPromise;var r=0;return this._pollingPromise=new Promise((function(n,i){requestAnimationFrame((function a(){t.isResultAvailable()?(n(t.getResult()),t._pollingPromise=null):r++>e?(i("Timed out"),t._pollingPromise=null):requestAnimationFrame(a)}))})),this._pollingPromise},(0,s.A)(t,[{key:ft,get:function(){return"Query"}}]),t}(ht.d),Lt=r(5133);function Et(e){switch(e){case h.GL.ALPHA:case h.GL.R32F:case h.GL.RED:case h.GL.RED_INTEGER:return 1;case h.GL.RG32I:case h.GL.RG32UI:case h.GL.RG32F:case h.GL.RG_INTEGER:case h.GL.RG:return 2;case h.GL.RGB:case h.GL.RGB_INTEGER:case h.GL.RGB32F:return 3;case h.GL.RGBA:case h.GL.RGBA_INTEGER:case h.GL.RGBA32F:return 4;default:return 0}}var pt,gt=((dt={})[h.GL.INT]="sint32",dt[h.GL.UNSIGNED_INT]="uint32",dt[h.GL.SHORT]="sint16",dt[h.GL.UNSIGNED_SHORT]="uint16",dt[h.GL.BYTE]="sint8",dt[h.GL.UNSIGNED_BYTE]="uint8",dt[h.GL.FLOAT]="float32",dt[h.GL.HALF_FLOAT]="float16",dt[h.GL.UNSIGNED_SHORT_5_6_5]="uint16",dt[h.GL.UNSIGNED_SHORT_4_4_4_4]="uint16",dt[h.GL.UNSIGNED_SHORT_5_5_5_1]="uint16",dt[h.GL.UNSIGNED_INT_2_10_10_10_REV]="uint32",dt[h.GL.UNSIGNED_INT_10F_11F_11F_REV]="uint32",dt[h.GL.UNSIGNED_INT_5_9_9_9_REV]="uint32",dt[h.GL.UNSIGNED_INT_24_8]="uint32",dt[h.GL.FLOAT_32_UNSIGNED_INT_24_8_REV]="uint32",dt);function Gt(e,t){var r,n=t||{},i=n.sourceX,a=void 0===i?0:i,s=n.sourceY,o=void 0===s?0:s,u=n.sourceAttachment,c=void 0===u?0:u,l=t||{},f=l.target,d=void 0===f?null:f,_=l.sourceWidth,L=l.sourceHeight,E=(l.sourceDepth,l.sourceFormat),p=l.sourceType,g=At(e),G=g.framebuffer,m=g.deleteFramebuffer,A=G.gl,v=G.handle;_||(_=G.width),L||(L=G.height);var R=null==(r=G.colorAttachments[c])?void 0:r.texture;if(!R)throw new Error("Invalid framebuffer attachment "+c);null==R||R.depth,E||(E=(null==R?void 0:R.glFormat)||h.GL.RGBA),p||(p=(null==R?void 0:R.glType)||h.GL.UNSIGNED_BYTE),d=function(e,t,r,n,i,a){if(e)return e;t||(t=h.GL.UNSIGNED_BYTE);var s=(c=t,gt[c]),o=(0,Lt.Ak)(s),u=Et(r);var c;return new o(n*i*u)}(d,p,E,_,L);var T=(0,Lt.h1)(d);p=p||Ue[T];var S=A.bindFramebuffer(h.GL.FRAMEBUFFER,v);return A.readBuffer(A.COLOR_ATTACHMENT0+c),A.readPixels(a,o,_,L,E,p,d),A.readBuffer(A.COLOR_ATTACHMENT0),A.bindFramebuffer(h.GL.FRAMEBUFFER,S||null),m&&G.destroy(),d}function mt(e,t){var r=t||{},n=r.target,i=r.sourceX,a=void 0===i?0:i,s=r.sourceY,o=void 0===s?0:s,u=r.sourceFormat,c=void 0===u?h.GL.RGBA:u,l=r.targetByteOffset,f=void 0===l?0:l,d=t||{},_=d.sourceWidth,L=d.sourceHeight,E=d.sourceType,p=At(e),g=p.framebuffer,G=p.deleteFramebuffer;_=_||g.width,L=L||g.height;var m=g;E=E||h.GL.UNSIGNED_BYTE;var A=n;if(!A){var v=f+_*L*Et(c)*function(e){switch(e){case h.GL.UNSIGNED_BYTE:return 1;case h.GL.UNSIGNED_SHORT_5_6_5:case h.GL.UNSIGNED_SHORT_4_4_4_4:case h.GL.UNSIGNED_SHORT_5_5_5_1:return 2;case h.GL.FLOAT:return 4;default:return 0}}(E);A=m.device.createBuffer({byteLength:v})}var R=e.device.createCommandEncoder();return R.copyTextureToBuffer({sourceTexture:e,width:_,height:L,origin:[a,o],destinationBuffer:A,byteOffset:f}),R.destroy(),G&&g.destroy(),A}function At(e){return e instanceof ne.G?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:vt(e),deleteFramebuffer:!0}}function vt(e,t){var r=e.device,n=e.width,i=e.height,a=e.id;return r.createFramebuffer(Object.assign({},t,{id:"framebuffer-for-"+a,width:n,height:i,colorAttachments:[e]}))}pt=Symbol.toStringTag;var Rt=function(e){(0,u.A)(r,e);var t=r.prototype;function r(t){var r,n,i;(n=e.call(this,Object.assign({},t,{id:t.id||(i="webgl-device",void 0===i&&(i="id"),ue[i]=ue[i]||1,i+"-"+ue[i]++)}))||this).type="webgl",n.preferredColorFormat="rgba8unorm",n.preferredDepthFormat="depth24plus",n._extensions={},n._polyfilled=!1;var a=c.pF._getCanvasContextProps(t);if(!a)throw new Error("WebGLDevice requires props.createCanvasContext to be set");var s=null==(r=a.canvas)||null==(r=r.gl)?void 0:r.device;if(s)throw new Error("WebGL context already attached to device "+s.id);n.canvasContext=new ae((0,o.A)(n),a),n.lost=new Promise((function(e){n._resolveContextLost=e}));var u=Object.assign({},t.webgl);"premultiplied"===a.alphaMode&&(u.premultipliedAlpha=!0),void 0!==t.powerPreference&&(u.powerPreference=t.powerPreference);var f=n.props._handle||function(e,t,r){var n,i,a="",s=Object.assign({preserveDrawingBuffer:!0},r),o=null;if(o||(o=e.getContext("webgl2",s)),s.failIfMajorPerformanceCaveat&&(a||(a="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),o||r.failIfMajorPerformanceCaveat||(s.failIfMajorPerformanceCaveat=!1,(i=o=e.getContext("webgl2",s)).luma||(i.luma={}),o.luma.softwareRenderer=!0),o||(o=e.getContext("webgl",{}))&&(o=null,a||(a="Your browser only supports WebGL1")),!o)throw a||(a="Your browser does not support WebGL"),new Error("Failed to create WebGL context: "+a);var u=t.onContextLost,c=t.onContextRestored;return e.addEventListener("webglcontextlost",(function(e){return u(e)}),!1),e.addEventListener("webglcontextrestored",(function(e){return c(e)}),!1),(n=o).luma||(n.luma={}),o}(n.canvasContext.canvas,{onContextLost:function(e){return null==n._resolveContextLost?void 0:n._resolveContextLost({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})},onContextRestored:function(e){return console.log("WebGL context restored")}},u);if(!f)throw new Error("WebGL context creation failed");if(s=f.device){if(t._reuseDevices)return l.R.log(1,"Not creating a new Device, instead returning a reference to Device "+s.id+" already attached to WebGL context",s)(),s._reused=!0,s||(0,o.A)(n);throw new Error("WebGL context already attached to device "+s.id)}n.handle=f,n.gl=f,n.spectorJS=(0,se.k2)(Object.assign({},n.props,{gl:n.handle})),n.gl.device=(0,o.A)(n),n.gl._version=2,n.info=D(n.gl,n._extensions),n.limits=new te(n.gl),n.features=new ee(n.gl,n._extensions,n.props._disabledFeatures),n.props._initializeFeatures&&n.features.initializeFeatures();var h=new P(n.gl,{log:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l.R.log.apply(l.R,[1].concat(t))()}});h.trackState(n.gl,{copyState:!1});var d=t.debugWebGL||t.debug,_=t.debugWebGL;return d&&(n.gl=(0,oe.l)(n.gl,{debugWebGL:d,traceWebGL:_}),l.R.warn("WebGL debug mode activated. Performance reduced.")(),t.debugWebGL&&(l.R.level=Math.max(l.R.level,1))),n.commandEncoder=new tt((0,o.A)(n),{id:(0,o.A)(n)+"-command-encoder"}),n}return t.toString=function(){return this[Symbol.toStringTag]+"("+this.id+")"},t.isVertexFormatSupported=function(e){return"unorm8x4-bgra"!==e},t.destroy=function(){this.props._reuseDevices||this._reused||delete this.gl.device},t.getTextureByteAlignment=function(){return 4},t.createCanvasContext=function(e){throw new Error("WebGL only supports a single canvas")},t.createBuffer=function(e){var t=this._normalizeBufferProps(e);return new fe(this,t)},t.createTexture=function(e){return new Ne(this,e)},t.createExternalTexture=function(e){throw new Error("createExternalTexture() not implemented")},t.createSampler=function(e){return new Te(this,e)},t.createShader=function(e){return new de(this,e)},t.createFramebuffer=function(e){return new ie(this,e)},t.createVertexArray=function(e){return new at(this,e)},t.createTransformFeedback=function(e){return new ct(this,e)},t.createQuerySet=function(e){return new _t(this,e)},t.createRenderPipeline=function(e){return new Ve(this,e)},t.createComputePipeline=function(e){throw new Error("ComputePipeline not supported in WebGL")},t.createCommandEncoder=function(e){return void 0===e&&(e={}),new tt(this,e)},t.submit=function(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:this.id+"-default-encoder"})),e._executeCommands()},t.readPixelsToArrayWebGL=function(e,t){return Gt(e,t)},t.readPixelsToBufferWebGL=function(e,t){return mt(e,t)},t.setParametersWebGL=function(e){C(this.gl,e)},t.getParametersWebGL=function(e){return N(this.gl,e)},t.withParametersWebGL=function(e,t){return be(this.gl,e,t)},t.resetWebGL=function(){l.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),C(this.gl,d)},t._getDeviceSpecificTextureFormatCapabilities=function(e){return t=this.gl,r=e,n=this._extensions,i=r.create,void 0===(null==(a=Q[r.format])?void 0:a.gl)&&(i=!1),null!=a&&a.x&&(i=i&&Boolean(O(t,a.x,n))),{format:r.format,create:i&&r.create,render:i&&r.render,filter:i&&r.filter,blend:i&&r.blend,store:i&&r.store};var t,r,n,i,a},t.loseDevice=function(){var e,t=!1,r=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return r&&(t=!0,r.loseContext()),null==(e=this._resolveContextLost)||e.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t},t.pushState=function(){P.get(this.gl).push()},t.popState=function(){P.get(this.gl).pop()},t.getGLKey=function(e,t){var r=Number(e);for(var n in this.gl)if(this.gl[n]===r)return"GL."+n;return null!=t&&t.emptyIfUnknown?"":String(e)},t.getGLKeys=function(e){var t=this,r={emptyIfUnknown:!0};return Object.entries(e).reduce((function(e,n){var i=n[0],a=n[1];return e[i+":"+t.getGLKey(i,r)]=a+":"+t.getGLKey(a,r),e}),{})},t.setConstantAttributeWebGL=function(e,t){var r=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(r).fill(null);var n=this._constants[e];switch(n&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(n,t)&&l.R.info(1,"setConstantAttributeWebGL("+e+") could have been skipped, value unchanged")(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r)}}(this,e,t);break;case Int32Array:!function(e,t,r){e.gl.vertexAttribI4iv(t,r)}(this,e,t);break;case Uint32Array:!function(e,t,r){e.gl.vertexAttribI4uiv(t,r)}(this,e,t);break;default:throw new Error("constant")}},t.getExtension=function(e){return O(this.gl,e,this._extensions),this._extensions},t._setWebGLDebugMetadata=function(e,t,r){e.luma=t;var n={props:r.spector,id:r.spector.id};e.__SPECTOR_Metadata=n},(0,s.A)(r,[{key:pt,get:function(){return"WebGLDevice"}},{key:"isLost",get:function(){return this.gl.isContextLost()}}]),r}(c.pF)},7651:(e,t,r)=>{r.d(t,{X:()=>s});var n=r(6769),i=r(5399),a=r(5526);function s(e){if(!e&&!(0,n.B)())return"Node";if((0,i.b)(e))return"Electron";return(e||a.gM.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}},9417:(e,t,r)=>{function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{A:()=>n})}}]);