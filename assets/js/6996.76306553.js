"use strict";(self.webpackChunkwebsite_docusaurus=self.webpackChunkwebsite_docusaurus||[]).push([[6996],{516:(e,t,i)=>{i.d(t,{M:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"CommandBuffer"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps)},1101:(e,t,i)=>{i.d(t,{d:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"QuerySet"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{type:void 0,count:void 0})},1243:(e,t,i)=>{i.d(t,{G:()=>u});var r=i(8696),n=i(7387),a=i(7862),o=i(7083),s=i(3522),u=function(e){function t(i,r){var n;return void 0===r&&(r={}),(n=e.call(this,i,r,t.defaultProps)||this).width=n.props.width,n.height=n.props.height,n}(0,n.A)(t,e);var i=t.prototype;return i.clone=function(e){var t=this.colorAttachments.map(function(t){return t.texture.clone(e)}),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer(Object.assign({},this.props,e,{colorAttachments:t,depthStencilAttachment:i}))},i.resize=function(e){var t=!e;if(e){var i=Array.isArray(e)?e:[e.width,e.height],r=i[0],n=i[1];t=t||n!==this.height||r!==this.width,this.width=r,this.height=n}t&&(s.R.log(2,"Resizing framebuffer "+this.id+" to "+this.width+"x"+this.height)(),this.resizeAttachments(this.width,this.height))},i.autoCreateAttachmentTextures=function(){var e=this;if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(function(t,i){if("string"==typeof t){var r=e.createColorTexture(t,i);return e.attachResource(r),r.view}return t instanceof o.g?t.view:t});var t=this.props.depthStencilAttachment;if(t)if("string"==typeof t){var i=this.createDepthStencilTexture(t);this.attachResource(i),this.depthStencilAttachment=i.view}else t instanceof o.g?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t},i.createColorTexture=function(e,t){return this.device.createTexture({id:this.id+"-color-attachment-"+t,usage:o.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})},i.createDepthStencilTexture=function(e){return this.device.createTexture({id:this.id+"-depth-stencil-attachment",usage:o.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})},i.resizeAttachments=function(e,t){for(var i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){var r=this.colorAttachments[i].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){var n=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()},(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"Framebuffer"}}])}(a.F);u.defaultProps=Object.assign({},a.F.defaultProps,{width:1,height:1,colorAttachments:[],depthStencilAttachment:null})},1464:(e,t,i)=>{function r(e){return s[e]}function n(e){var t=o[e],i=t[0],r=t[1],n="i32"===i||"u32"===i,s="u32"!==i;return{primitiveType:i,components:r,byteLength:a[i]*r,integer:n,signed:s}}i.d(t,{k0:()=>r,wH:()=>n});var a={f32:4,f16:2,i32:4,u32:4},o={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},s={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}},u={vec2i:"vec2<i32>",vec3i:"vec3<i32>",vec4i:"vec4<i32>",vec2u:"vec2<u32>",vec3u:"vec3<u32>",vec4u:"vec4<u32>",vec2f:"vec2<f32>",vec3f:"vec3<f32>",vec4f:"vec4<f32>",vec2h:"vec2<f16>",vec3h:"vec3<f16>",vec4h:"vec4<f16>"};Object.assign({},u,{mat2x2f:"mat2x2<f32>",mat2x3f:"mat2x3<f32>",mat2x4f:"mat2x4<f32>",mat3x2f:"mat3x2<f32>",mat3x3f:"mat3x3<f32>",mat3x4f:"mat3x4<f32>",mat4x2f:"mat4x2<f32>",mat4x3f:"mat4x3<f32>",mat4x4f:"mat4x4<f32>",mat2x2i:"mat2x2<i32>",mat2x3i:"mat2x3<i32>",mat2x4i:"mat2x4<i32>",mat3x2i:"mat3x2<i32>",mat3x3i:"mat3x3<i32>",mat3x4i:"mat3x4<i32>",mat4x2i:"mat4x2<i32>",mat4x3i:"mat4x3<i32>",mat4x4i:"mat4x4<i32>",mat2x2u:"mat2x2<u32>",mat2x3u:"mat2x3<u32>",mat2x4u:"mat2x4<u32>",mat3x2u:"mat3x2<u32>",mat3x3u:"mat3x3<u32>",mat3x4u:"mat3x4<u32>",mat4x2u:"mat4x2<u32>",mat4x3u:"mat4x3<u32>",mat4x4u:"mat4x4<u32>",mat2x2h:"mat2x2<f16>",mat2x3h:"mat2x3<f16>",mat2x4h:"mat2x4<f16>",mat3x2h:"mat3x2<f16>",mat3x3h:"mat3x3<f16>",mat3x4h:"mat3x4<f16>",mat4x2h:"mat4x2<f16>",mat4x3h:"mat4x3<f16>",mat4x4h:"mat4x4<f16>"})},2018:(e,t,i)=>{i.d(t,{M:()=>u,P:()=>s});var r=i(3845),n=i(3522),a=i(1464),o=i(1990);function s(e,t){for(var i,n={},a=(0,r.A)(e.attributes);!(i=a()).done;){var o=i.value,s=d(e,t,o.name);s&&(n[o.name]=s)}return n}function u(e,t,i){void 0===i&&(i=16);for(var r=s(e,t),n=new Array(i).fill(null),a=0,o=Object.values(r);a<o.length;a++){var u=o[a];n[u.location]=u}return n}function d(e,t,i){var s=function(e,t){var i=e.attributes.find(function(e){return e.name===t});i||n.R.warn('shader layout attribute "'+t+'" not present in shader');return i||null}(e,i),u=function(e,t){c(e);var i=function(e,t){for(var i,n=(0,r.A)(e);!(i=n()).done;){var a=i.value;if(a.format&&a.name===t)return{attributeName:a.name,bufferName:t,stepMode:a.stepMode,vertexFormat:a.format,byteOffset:0,byteStride:a.byteStride||0}}return null}(e,t);if(i)return i;if(i=function(e,t){for(var i,n=(0,r.A)(e);!(i=n()).done;){var a,s=i.value,u=s.byteStride;if("number"!=typeof s.byteStride)for(var d,c=(0,r.A)(s.attributes||[]);!(d=c()).done;){var h=d.value;u+=(0,o.yx)(h.format).byteLength}var l=null==(a=s.attributes)?void 0:a.find(function(e){return e.attribute===t});if(l)return{attributeName:l.attribute,bufferName:s.name,stepMode:s.stepMode,vertexFormat:l.format,byteOffset:l.byteOffset,byteStride:u}}return null}(e,t),i)return i;return n.R.warn('layout for attribute "'+t+'" not present in buffer layout'),null}(t,i);if(!s)return null;var d=(0,a.wH)(s.type),h=(0,o.Mz)(d),l=(null==u?void 0:u.vertexFormat)||h,p=(0,o.yx)(l);return{attributeName:(null==u?void 0:u.attributeName)||s.name,bufferName:(null==u?void 0:u.bufferName)||s.name,location:s.location,shaderType:s.type,primitiveType:d.primitiveType,shaderComponents:d.components,vertexFormat:l,bufferDataType:p.type,bufferComponents:p.components,normalized:p.normalized,integer:d.integer,stepMode:(null==u?void 0:u.stepMode)||s.stepMode||"vertex",byteOffset:(null==u?void 0:u.byteOffset)||0,byteStride:(null==u?void 0:u.byteStride)||0}}function c(e){for(var t,i=(0,r.A)(e);!(t=i()).done;){var a=t.value;(a.attributes&&a.format||!a.attributes&&!a.format)&&n.R.warn("BufferLayout "+name+" must have either 'attributes' or 'format' field")}}},2645:(e,t,i)=>{i.d(t,{O:()=>a});var r=i(7387),n=i(7862),a=function(e){function t(i,r){var n;return void 0===r&&(r={}),(n=e.call(this,i,r,t.defaultProps)||this)[Symbol.toStringTag]="WEBGLFence",n}return(0,r.A)(t,e),t}(n.F);a.defaultProps=Object.assign({},n.F.defaultProps)},3145:(e,t,i)=>{i.d(t,{r:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){var n;return(n=e.call(this,i,r,t.defaultProps)||this).linkStatus="pending",n.hash="",n.shaderLayout=n.props.shaderLayout,n.bufferLayout=n.props.bufferLayout||[],n}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"RenderPipeline"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}})},3956:(e,t,i)=>{i.d(t,{Q:()=>a});var r=i(6769),n=i(1166);var a=function(){function e(t){var i,a,s,u,d=this;if(this.isInitialized=!1,this.isVisible=!0,this._initializedResolvers={promise:new Promise(function(e,t){s=e,u=t}),resolve:s,reject:u},this._position=[0,0],this.destroyed=!1,this._needsDrawingBufferResize=!0,this.props=Object.assign({},e.defaultProps,t),t=this.props,this.initialized=this._initializedResolvers.promise,(0,r.B)()?t.canvas?"string"==typeof t.canvas?this.canvas=o(t.canvas):this.canvas=t.canvas:this.canvas=function(e){var t=e.width,i=e.height,r=document.createElement("canvas");r.id=(0,n.L)("lumagl-auto-created-canvas"),r.width=t||1,r.height=i||1,r.style.width=Number.isFinite(t)?t+"px":"100%",r.style.height=Number.isFinite(i)?i+"px":"100%",null!=e&&e.visible||(r.style.visibility="hidden");var a=function(e){if("string"==typeof e){var t=document.getElementById(e);if(!t)throw new Error(e+" is not an HTML element");return t}if(e)return e;return document.body}((null==e?void 0:e.container)||null);return a.insertBefore(r,a.firstChild),r}(t):this.canvas={width:t.width||1,height:t.height||1},e.isHTMLCanvas(this.canvas)?(this.id=t.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):e.isOffscreenCanvas(this.canvas)?(this.id=t.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=t.id||"node-canvas-context",this.type="node"),this.cssWidth=(null==(i=this.htmlCanvas)?void 0:i.clientWidth)||this.canvas.width,this.cssHeight=(null==(a=this.htmlCanvas)?void 0:a.clientHeight)||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],e.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(function(e){return d._handleIntersection(e)}),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(function(e){return d._handleResize(e)});try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch(c){this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(function(){return d._observeDevicePixelRatio()},0),this.props.trackPosition&&this._trackPosition()}}e.isHTMLCanvas=function(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement},e.isOffscreenCanvas=function(e){return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas};var t=e.prototype;return t.toString=function(){return this[Symbol.toStringTag]+"("+this.id+")"},t.destroy=function(){this.destroyed=!0},t.setProps=function(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this},t.getCurrentFramebuffer=function(e){return this._resizeDrawingBufferIfNeeded(),this._getCurrentFramebuffer(e)},t.getCSSSize=function(){return[this.cssWidth,this.cssHeight]},t.getPosition=function(){return this._position},t.getDevicePixelSize=function(){return[this.devicePixelWidth,this.devicePixelHeight]},t.getDrawingBufferSize=function(){return[this.drawingBufferWidth,this.drawingBufferHeight]},t.getMaxDrawingBufferSize=function(){var e=this.device.limits.maxTextureDimension2D;return[e,e]},t.setDrawingBufferSize=function(e,t){this.drawingBufferWidth=Math.floor(e),this.drawingBufferHeight=Math.floor(t),this._needsDrawingBufferResize=!0},t.getDevicePixelRatio=function(){return"undefined"!=typeof window&&window.devicePixelRatio||1},t.cssToDevicePixels=function(e,t){void 0===t&&(t=!0);var i=this.cssToDeviceRatio(),r=this.getDrawingBufferSize();return function(e,t,i,r,n){var a,o=e,d=s(o[0],t,i),c=u(o[1],t,r,n),h=s(o[0]+1,t,i),l=h===i-1?h:h-1;h=u(o[1]+1,t,r,n),n?(a=c,c=h=0===h?h:h+1):a=h===r-1?h:h-1;return{x:d,y:c,width:Math.max(l-d+1,1),height:Math.max(a-c+1,1)}}(e,i,r[0],r[1],t)},t.getPixelSize=function(){return this.getDevicePixelSize()},t.getAspect=function(){var e=this.getDevicePixelSize();return e[0]/e[1]},t.cssToDeviceRatio=function(){try{var e=this.getDrawingBufferSize()[0],t=this.getCSSSize()[0];return t?e/t:1}catch(i){return 1}},t.resize=function(e){this.setDrawingBufferSize(e.width,e.height)},t._setAutoCreatedCanvasId=function(e){var t;"lumagl-auto-created-canvas"===(null==(t=this.htmlCanvas)?void 0:t.id)&&(this.htmlCanvas.id=e)},t._handleIntersection=function(e){var t=this,i=e.find(function(e){return e.target===t.canvas});if(i){var r=i.isIntersecting;this.isVisible!==r&&(this.isVisible=r,this.device.props.onVisibilityChange(this))}},t._handleResize=function(e){var t,i,r=this,n=e.find(function(e){return e.target===r.canvas});if(n){this.cssWidth=n.contentBoxSize[0].inlineSize,this.cssHeight=n.contentBoxSize[0].blockSize;var a=this.getDevicePixelSize(),o=(null==(t=n.devicePixelContentBoxSize)?void 0:t[0].inlineSize)||n.contentBoxSize[0].inlineSize*devicePixelRatio,s=(null==(i=n.devicePixelContentBoxSize)?void 0:i[0].blockSize)||n.contentBoxSize[0].blockSize*devicePixelRatio,u=this.getMaxDrawingBufferSize(),d=u[0],c=u[1];this.devicePixelWidth=Math.max(1,Math.min(o,d)),this.devicePixelHeight=Math.max(1,Math.min(s,c)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:a})}},t._updateDrawingBufferSize=function(){if(this.props.autoResize)if("number"==typeof this.props.useDevicePixels){var e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()},t._resizeDrawingBufferIfNeeded=function(){this._needsDrawingBufferResize&&(this._needsDrawingBufferResize=!1,(this.drawingBufferWidth!==this.canvas.width||this.drawingBufferHeight!==this.canvas.height)&&(this.canvas.width=this.drawingBufferWidth,this.canvas.height=this.drawingBufferHeight,this._configureDevice()))},t._observeDevicePixelRatio=function(){var e=this,t=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:t}),matchMedia("(resolution: "+this.devicePixelRatio+"dppx)").addEventListener("change",function(){return e._observeDevicePixelRatio()},{once:!0})},t._trackPosition=function(e){var t=this;void 0===e&&(e=100);var i=setInterval(function(){t.destroyed?clearInterval(i):t.updatePosition()},e)},t.updatePosition=function(){var e,t=null==(e=this.htmlCanvas)?void 0:e.getBoundingClientRect();if(t){var i=[t.left,t.top];if(null!=this._position||(this._position=i),i[0]!==this._position[0]||i[1]!==this._position[1]){var r,n,a=this._position;this._position=i,null==(r=(n=this.device.props).onPositionChange)||r.call(n,this,{oldPosition:a})}}},e}();function o(e){var t=document.getElementById(e);if(!a.isHTMLCanvas(t))throw new Error("Object is not a canvas element");return t}function s(e,t,i){return Math.min(Math.round(e*t),i-1)}function u(e,t,i,r){return r?Math.max(0,i-1-Math.round(e*t)):Math.min(Math.round(e*t),i-1)}a.defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1}},4353:(e,t,i)=>{i.d(t,{X:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"TextureView"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0})},5524:(e,t,i)=>{i.d(t,{i:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"CommandEncoder"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{measureExecutionTime:void 0})},5768:(e,t,i)=>{i.d(t,{L:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){return r=t.normalizeProps(i,r),e.call(this,i,r,t.defaultProps)||this}return(0,n.A)(t,e),t.normalizeProps=function(e,t){return t},(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"Sampler"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1})},6996:(e,t,i)=>{i.r(t),i.d(t,{WebGPUDevice:()=>de});var r=i(2444),n=i(467),a=i(8696),o=i(7387),s=i(8174),u=i(5056),d=i(3522),c=function(e){function t(t,i){var r,n;(n=e.call(this,t,i)||this).device=t,n.byteLength=i.byteLength||(null==(r=i.data)?void 0:r.byteLength)||0;var a=Boolean(n.props.onMapped||i.data),o=4*Math.ceil(n.byteLength/4);if(n.device.pushErrorScope("out-of-memory"),n.device.pushErrorScope("validation"),n.handle=n.props.handle||n.device.handle.createBuffer({label:n.props.id,usage:n.props.usage||GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:a,size:o}),n.device.popErrorScope(function(e){n.device.reportError(new Error(n+" creation failed "+e.message),n)(),n.device.debug()}),n.device.popErrorScope(function(e){n.device.reportError(new Error(n+" out of memory: "+e.message),n)(),n.device.debug()}),n.device.pushErrorScope("validation"),i.data||i.onMapped)try{var s=n.handle.getMappedRange();if(i.data){var u=i.data;new u.constructor(s).set(u)}else null==i.onMapped||i.onMapped(s,"mapped")}finally{n.handle.unmap()}return n.device.popErrorScope(function(e){n.device.reportError(new Error(n+" creation failed "+e.message),n)(),n.device.debug()}),n}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){var e;null==(e=this.handle)||e.destroy(),this.handle=null},i.write=function(e,t){var i=this;void 0===t&&(t=0);var r=ArrayBuffer.isView(e)?e.buffer:e,n=ArrayBuffer.isView(e)?e.byteOffset:0;this.device.pushErrorScope("validation"),this.device.handle.queue.writeBuffer(this.handle,t,r,n,e.byteLength),this.device.popErrorScope(function(e){i.device.reportError(new Error(i+".write() "+e.message),i)(),i.device.debug()})},i.mapAndWriteAsync=function(){var e=(0,n.A)((0,r.A)().m(function e(t,i,n){var a,o,s,d,c=this;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return void 0===i&&(i=0),void 0===n&&(n=this.byteLength-i),a=0!==(this.usage&u.h.MAP_WRITE),o=a?null:this._getMappableBuffer(u.h.MAP_WRITE|u.h.COPY_SRC,0,this.byteLength),s=o||this,this.device.pushErrorScope("validation"),e.p=1,e.n=2,this.device.handle.queue.onSubmittedWorkDone();case 2:return e.n=3,s.handle.mapAsync(GPUMapMode.WRITE,i,n);case 3:return d=s.handle.getMappedRange(i,n),e.n=4,t(d,"mapped");case 4:s.handle.unmap(),o&&this._copyBuffer(o,i,n);case 5:return e.p=5,this.device.popErrorScope(function(e){c.device.reportError(new Error(c+".mapAndWriteAsync() "+e.message),c)(),c.device.debug()}),null==o||o.destroy(),e.f(5);case 6:return e.a(2)}},e,this,[[1,,5,6]])}));return function(t,i,r){return e.apply(this,arguments)}}(),i.readAsync=function(){var e=(0,n.A)((0,r.A)().m(function e(t,i){return(0,r.A)().w(function(e){for(;;)if(0===e.n)return void 0===t&&(t=0),void 0===i&&(i=this.byteLength-t),e.a(2,this.mapAndReadAsync(function(e){return new Uint8Array(e.slice(0))},t,i))},e,this)}));return function(t,i){return e.apply(this,arguments)}}(),i.mapAndReadAsync=function(){var e=(0,n.A)((0,r.A)().m(function e(t,i,n){var a,o,s,d,c,h=this;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(void 0===i&&(i=0),void 0===n&&(n=this.byteLength-i),i%8==0&&n%4==0){e.n=1;break}throw new Error("byteOffset must be multiple of 8 and byteLength multiple of 4");case 1:if(!(i+n>this.handle.size)){e.n=2;break}throw new Error("Mapping range exceeds buffer size");case 2:return a=0!==(this.usage&u.h.MAP_READ),o=a?null:this._getMappableBuffer(u.h.MAP_READ|u.h.COPY_DST,0,this.byteLength),s=o||this,this.device.pushErrorScope("validation"),e.p=3,e.n=4,this.device.handle.queue.onSubmittedWorkDone();case 4:return o&&o._copyBuffer(this),e.n=5,s.handle.mapAsync(GPUMapMode.READ,i,n);case 5:return d=s.handle.getMappedRange(i,n),e.n=6,t(d,"mapped");case 6:return c=e.v,s.handle.unmap(),e.a(2,c);case 7:return e.p=7,this.device.popErrorScope(function(e){h.device.reportError(new Error(h+".mapAndReadAsync() "+e.message),h)(),h.device.debug()}),null==o||o.destroy(),e.f(7);case 8:return e.a(2)}},e,this,[[3,,7,8]])}));return function(t,i,r){return e.apply(this,arguments)}}(),i.readSyncWebGL=function(e,t){throw new Error("Not implemented")},i._getMappableBuffer=function(e,i,r){return d.R.warn(this+" is not readable, creating a temporary Buffer"),new t(this.device,{usage:e,byteLength:r})},i._copyBuffer=function(e,t,i){var r=this;void 0===t&&(t=0),void 0===i&&(i=this.byteLength),this.device.pushErrorScope("validation");var n=this.device.handle.createCommandEncoder();n.copyBufferToBuffer(e.handle,t,this.handle,t,i),this.device.handle.queue.submit([n.finish()]),this.device.popErrorScope(function(e){r.device.reportError(new Error(r+"._getReadableBuffer() "+e.message),r)(),r.device.debug()})},t}(u.h),h=i(7083),l=i(116);function p(e){if(e.includes("webgl"))throw new Error("webgl-only format");return e}var f=i(5768),m=function(e){function t(t,i){var r;(r=e.call(this,t,i)||this).device=t;var n=Object.assign({},r.props,{mipmapFilter:void 0});return"comparison-sampler"!==i.type&&delete n.compare,i.mipmapFilter&&"none"!==i.mipmapFilter&&(n.mipmapFilter=i.mipmapFilter),r.handle=i.handle||r.device.handle.createSampler(n),r.handle.label=r.props.id,r}return(0,o.A)(t,e),t.prototype.destroy=function(){this.handle=null},t}(f.L),v=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).device=t,r.texture=i.texture,r.device.pushErrorScope("validation"),r.handle=r.texture.handle.createView({format:r.props.format||r.texture.format,dimension:r.props.dimension||r.texture.dimension,aspect:r.props.aspect,baseMipLevel:r.props.baseMipLevel,mipLevelCount:r.props.mipLevelCount,baseArrayLayer:r.props.baseArrayLayer,arrayLayerCount:r.props.arrayLayerCount}),r.device.popErrorScope(function(e){r.device.reportError(new Error("TextureView constructor: "+e.message),r)(),r.device.debug()}),r.handle.label=r.props.id,r}return(0,o.A)(t,e),t.prototype.destroy=function(){this.handle=null},t}(i(4353).X),g=function(e){function t(t,i){var r,n;((r=e.call(this,t,i,{byteAlignment:256})||this).device=t,r.device.pushErrorScope("out-of-memory"),r.device.pushErrorScope("validation"),r.handle=r.props.handle||r.device.handle.createTexture({label:r.id,size:{width:r.width,height:r.height,depthOrArrayLayers:r.depth},usage:r.props.usage||h.g.TEXTURE|h.g.COPY_DST,dimension:r.baseDimension,format:p(r.format),mipLevelCount:r.mipLevels,sampleCount:r.props.samples}),r.device.popErrorScope(function(e){r.device.reportError(new Error(r+" constructor: "+e.message),r)(),r.device.debug()}),r.device.popErrorScope(function(e){r.device.reportError(new Error(r+" out of memory: "+e.message),r)(),r.device.debug()}),r.props.handle)&&((n=r.handle).label||(n.label=r.id),r.width=r.handle.width,r.height=r.handle.height);return r.sampler=i.sampler instanceof m?i.sampler:new m(r.device,i.sampler||{}),r.view=new v(r.device,Object.assign({},r.props,{texture:r,mipLevelCount:r.mipLevels,arrayLayerCount:"3d"!==r.dimension?r.depth:1})),r._initializeData(i.data),r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){var e;null==(e=this.handle)||e.destroy(),this.handle=null},i.createView=function(e){return new v(this.device,Object.assign({},e,{texture:this}))},i.copyExternalImage=function(e){var t=this,i=this._normalizeCopyExternalImageOptions(e);return this.device.pushErrorScope("validation"),this.device.handle.queue.copyExternalImageToTexture({source:i.image,origin:[i.sourceX,i.sourceY],flipY:!1},{texture:this.handle,origin:[i.x,i.y,i.z],mipLevel:i.mipLevel,aspect:i.aspect,colorSpace:i.colorSpace,premultipliedAlpha:i.premultipliedAlpha},[i.width,i.height,i.depth]),this.device.popErrorScope(function(e){t.device.reportError(new Error("copyExternalImage: "+e.message),t)(),t.device.debug()}),{width:i.width,height:i.height}},i.copyImageData=function(e){var t=this,i=this.width,r=this.height,n=this.depth,a=this._normalizeCopyImageDataOptions(e);this.device.pushErrorScope("validation"),this.device.handle.queue.writeTexture({texture:this.handle,mipLevel:a.mipLevel,aspect:a.aspect,origin:[a.x,a.y,a.z]},a.data,{offset:a.byteOffset,bytesPerRow:a.bytesPerRow,rowsPerImage:a.rowsPerImage},[i,r,n]),this.device.popErrorScope(function(e){t.device.reportError(new Error("copyImageData: "+e.message),t)(),t.device.debug()})},i.generateMipmapsWebGL=function(){d.R.warn(this+": generateMipmaps not supported in WebGPU")()},i.getImageDataLayout=function(e){return{byteLength:0,bytesPerRow:0,rowsPerImage:0}},i.readBuffer=function(e,t){var i=this;void 0===e&&(e={});var r=e,n=r.x,a=void 0===n?0:n,o=r.y,s=void 0===o?0:o,d=r.z,c=void 0===d?0:d,h=r.width,l=void 0===h?this.width:h,p=r.height,f=void 0===p?this.height:p,m=r.depthOrArrayLayers,v=void 0===m?this.depth:m,g=r.mipLevel,y=void 0===g?0:g,b=r.aspect,x=void 0===b?"all":b,w=this.computeMemoryLayout(e),S=w.bytesPerRow,A=w.rowsPerImage,P=w.byteLength,E=t||this.device.createBuffer({byteLength:P,usage:u.h.COPY_DST|u.h.MAP_READ}),C=E.handle,L=this.device.handle;this.device.pushErrorScope("validation");var T=L.createCommandEncoder();T.copyTextureToBuffer({texture:this.handle,origin:{x:a,y:s,z:c},mipLevel:y,aspect:x},{buffer:C,offset:0,bytesPerRow:S,rowsPerImage:A},{width:l,height:f,depthOrArrayLayers:v});var B=T.finish();return this.device.handle.queue.submit([B]),this.device.popErrorScope(function(e){i.device.reportError(new Error(i+" readBuffer: "+e.message),i)(),i.device.debug()}),E},i.readDataAsync=function(){var e=(0,n.A)((0,r.A)().m(function e(t){var i,n;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return void 0===t&&(t={}),i=this.readBuffer(t),e.n=1,i.readAsync();case 1:return n=e.v,i.destroy(),e.a(2,n.buffer)}},e,this)}));return function(t){return e.apply(this,arguments)}}(),i.writeBuffer=function(e,t){var i=this;void 0===t&&(t={});var r=t,n=r.x,a=void 0===n?0:n,o=r.y,s=void 0===o?0:o,u=r.z,d=void 0===u?0:u,c=r.width,h=void 0===c?this.width:c,l=r.height,p=void 0===l?this.height:l,f=r.depthOrArrayLayers,m=void 0===f?this.depth:f,v=r.mipLevel,g=void 0===v?0:v,y=r.aspect,b=void 0===y?"all":y,x=this.computeMemoryLayout(t),w=x.bytesPerRow,S=x.rowsPerImage,A=this.device.handle;this.device.pushErrorScope("validation");var P=A.createCommandEncoder();P.copyBufferToTexture({buffer:e.handle,offset:0,bytesPerRow:w,rowsPerImage:S},{texture:this.handle,origin:{x:a,y:s,z:d},mipLevel:g,aspect:b},{width:h,height:p,depthOrArrayLayers:m});var E=P.finish();this.device.handle.queue.submit([E]),this.device.popErrorScope(function(e){i.device.reportError(new Error(i+" writeBuffer: "+e.message),i)(),i.device.debug()})},i.writeData=function(e,t){var i=this;void 0===t&&(t={});var r=this.device,n=t,a=n.x,o=void 0===a?0:a,s=n.y,u=void 0===s?0:s,d=n.z,c=void 0===d?0:d,h=n.width,p=void 0===h?this.width:h,f=n.height,m=void 0===f?this.height:f,v=n.depthOrArrayLayers,g=void 0===v?this.depth:v,y=n.mipLevel,b=void 0===y?0:y,x=n.aspect,w=void 0===x?"all":x,S=l.vz.computeMemoryLayout({format:this.format,width:this.width,height:this.height,depth:this.depth,byteAlignment:this.byteAlignment}),A=S.bytesPerRow,P=S.rowsPerImage;this.device.pushErrorScope("validation"),r.handle.queue.writeTexture({texture:this.handle,mipLevel:b,aspect:w,origin:{x:o,y:u,z:c}},e,{offset:0,bytesPerRow:A,rowsPerImage:P},{width:p,height:m,depthOrArrayLayers:g}),this.device.popErrorScope(function(e){i.device.reportError(new Error(i+" writeData: "+e.message),i)(),i.device.debug()})},t}(h.g),y=i(7862),b=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,o.A)(t,e),(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"ExternalTexture"}}])}(y.F);b.defaultProps=Object.assign({},y.F.defaultProps,{source:void 0,colorSpace:"srgb"});var x=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).device=t,r.handle=r.props.handle||r.device.handle.importExternalTexture({source:i.source,colorSpace:i.colorSpace}),r.sampler=null,r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){this.handle=null},i.setSampler=function(e){return this.sampler=e instanceof m?e:new m(this.device,e),this},t}(b),w=function(e){function t(t,i){var r;(r=e.call(this,t,i)||this).device=t;var n=i.source.includes("#version");if("glsl"===r.props.language||n)throw new Error("GLSL shaders are not supported in WebGPU");return r.device.pushErrorScope("validation"),r.handle=r.props.handle||r.device.handle.createShaderModule({code:i.source}),r.device.popErrorScope(function(e){r.device.reportError(new Error(r+' creation failed:\n"'+e.message+'"'),r,r.props.source)(),r.device.debug()}),r.handle.label=r.props.id,r._checkCompilationError(),r}(0,o.A)(t,e);var i=t.prototype;return i._checkCompilationError=function(){var e=(0,n.A)((0,r.A)().m(function e(){var t,i;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.getCompilationInfo();case 1:t=e.v,i=Boolean(t.find(function(e){return"error"===e.type})),this.compilationStatus=i?"error":"success",this.debugShader(),"error"===this.compilationStatus&&(this.device.reportError(new Error("Shader compilation error"),this,t)(),this.device.debug());case 2:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}(),i.destroy=function(){this.handle=null},i.getCompilationInfo=function(){var e=(0,n.A)((0,r.A)().m(function e(){var t;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.handle.getCompilationInfo();case 1:return t=e.v,e.a(2,t.messages)}},e,this)}));return function(){return e.apply(this,arguments)}}(),(0,a.A)(t,[{key:"asyncCompilationStatus",get:function(){var e=this;return this.getCompilationInfo().then(function(){return e.compilationStatus})}}])}(i(7468).M),S=i(3845),A=i(3145);function P(e){return e.depthStencil=e.depthStencil||{format:"depth24plus",stencilFront:{},stencilBack:{},depthWriteEnabled:!1,depthCompare:"less-equal"},e.depthStencil}function E(e){return P(e).stencilFront}function C(e){return P(e).stencilBack}var L={cullMode:function(e,t,i){i.primitive=i.primitive||{},i.primitive.cullMode=t},frontFace:function(e,t,i){i.primitive=i.primitive||{},i.primitive.frontFace=t},depthWriteEnabled:function(e,t,i){t&&(P(i).depthWriteEnabled=t)},depthCompare:function(e,t,i){P(i).depthCompare=t},depthFormat:function(e,t,i){P(i).format=t},depthBias:function(e,t,i){P(i).depthBias=t},depthBiasSlopeScale:function(e,t,i){P(i).depthBiasSlopeScale=t},depthBiasClamp:function(e,t,i){P(i).depthBiasClamp=t},stencilReadMask:function(e,t,i){P(i).stencilReadMask=t},stencilWriteMask:function(e,t,i){P(i).stencilWriteMask=t},stencilCompare:function(e,t,i){var r=E(i),n=C(i);r.compare=t,n.compare=t},stencilPassOperation:function(e,t,i){var r=E(i),n=C(i);r.passOp=t,n.passOp=t},stencilFailOperation:function(e,t,i){var r=E(i),n=C(i);r.failOp=t,n.failOp=t},stencilDepthFailOperation:function(e,t,i){var r=E(i),n=C(i);r.depthFailOp=t,n.depthFailOp=t},sampleCount:function(e,t,i){i.multisample=i.multisample||{},i.multisample.count=t},sampleMask:function(e,t,i){i.multisample=i.multisample||{},i.multisample.mask=t},sampleAlphaToCoverageEnabled:function(e,t,i){i.multisample=i.multisample||{},i.multisample.alphaToCoverageEnabled=t},colorMask:function(e,t,i){D(i,0).writeMask=t},blend:function(e,t,i){t&&O(i,0)},blendColorOperation:function(e,t,i){var r=O(i,0);r.color=r.color||{},r.color.operation=t},blendColorSrcFactor:function(e,t,i){var r=O(i,0);r.color=r.color||{},r.color.srcFactor=t},blendColorDstFactor:function(e,t,i){O(i,0).color.dstFactor=t},blendAlphaOperation:function(e,t,i){var r=O(i,0);r.alpha=r.alpha||{},r.alpha.operation=t},blendAlphaSrcFactor:function(e,t,i){var r=O(i,0);r.alpha=r.alpha||{},r.alpha.srcFactor=t},blendAlphaDstFactor:function(e,t,i){var r=O(i,0);r.alpha=r.alpha||{},r.alpha.dstFactor=t},unclippedDepth:T,provokingVertex:T,polygonMode:T,polygonOffsetLine:T,clipDistance0:T,clipDistance1:T,clipDistance2:T,clipDistance3:T,clipDistance4:T,clipDistance5:T,clipDistance6:T,clipDistance7:T};function T(e,t,i){d.R.warn(e+" parameter not supported in WebGPU")()}var B={primitive:{cullMode:"back",topology:"triangle-list"},vertex:{module:void 0,entryPoint:"main"},fragment:{module:void 0,entryPoint:"main",targets:[]},layout:"auto"};function R(e,t){void 0===t&&(t={}),Object.assign(e,Object.assign({},B,e)),function(e,t){for(var i=0,r=Object.entries(t);i<r.length;i++){var n=r[i],a=n[0],o=n[1],s=L[a];s?s(a,o,e):d.R.error("Illegal parameter "+a+" in WebGPU")()}}(e,t)}function D(e,t){var i,r,n,a,o;(e.fragment.targets=(null==(i=e.fragment)?void 0:i.targets)||[],Array.isArray(null==(r=e.fragment)?void 0:r.targets)||d.R.warn("parameters: no targets array")(),0===(null==(n=e.fragment)||null==(n=n.targets)?void 0:n.length))&&(null==(o=e.fragment.targets)||o.push({}));return null==(a=e.fragment)||null==(a=a.targets)?void 0:a[0]}function O(e,t){var i=D(e);return i.blend=i.blend||{color:{},alpha:{}},i.blend}function _(e,t,i,r){var n=function(e,t){for(var i=[],r=0,n=Object.entries(e);r<n.length;r++){var a=n[r],o=a[0],s=a[1],u=M(t,o);if(u){var d=z(s,u.location);d&&i.push(d)}if(s instanceof h.g&&(u=M(t,o+"Sampler",{ignoreWarnings:!0}))){var c=z(s,u.location,{sampler:!0});c&&i.push(c)}}return i}(r,i);e.pushErrorScope("validation");var a=e.createBindGroup({layout:t,entries:n});return e.popErrorScope().then(function(e){e&&d.R.error("bindGroup creation: "+e.message,a)()}),a}function M(e,t,i){var r=e.bindings.find(function(e){return e.name===t||e.name.toLocaleLowerCase()+"uniforms"===t.toLocaleLowerCase()});return r||null!=i&&i.ignoreWarnings||d.R.warn("Binding "+t+" not set: Not found in shader layout.")(),r||null}function z(e,t,i){return e instanceof u.h?{binding:t,resource:{buffer:e.handle}}:e instanceof f.L?{binding:t,resource:e.handle}:e instanceof h.g?null!=i&&i.sampler?{binding:t,resource:e.sampler.handle}:{binding:t,resource:e.view.handle}:(d.R.warn("invalid binding "+name,e),null)}var F=i(1990);function I(e){if(e.endsWith("-webgl"))throw new Error("WebGPU does not support vertex format "+e);return e}function G(e,t){for(var i,r=[],n=new Set,a=(0,S.A)(t);!(i=a()).done;){var o=i.value,s=[],u="vertex",d=0,c=o.format;if(o.attributes)for(var h,l=(0,S.A)(o.attributes);!(h=l()).done;){var p=h.value,f=k(e,p.attribute,n),m=null==f?void 0:f.location;c=p.format||o.format,u=(null==f?void 0:f.stepMode)||(null!=f&&f.name.startsWith("instance")?"instance":"vertex"),s.push({format:I(c),offset:p.byteOffset,shaderLocation:m}),d+=(0,F.yx)(c).byteLength}else{var v=k(e,o.name,n);if(!v)continue;d=(0,F.yx)(c).byteLength,u=v.stepMode||(v.name.startsWith("instance")?"instance":"vertex"),s.push({format:I(c),offset:0,shaderLocation:v.location})}r.push({arrayStride:o.byteStride||d,stepMode:u,attributes:s})}for(var g,y=(0,S.A)(e.attributes);!(g=y()).done;){var b=g.value;n.has(b.name)||r.push({arrayStride:(0,F.yx)("float32x3").byteLength,stepMode:b.stepMode||(b.name.startsWith("instance")?"instance":"vertex"),attributes:[{format:I("float32x3"),offset:0,shaderLocation:b.location}]})}return r.sort(function(e,t){return Math.min.apply(Math,Array.from(e.attributes,function(e){return e.shaderLocation}))-Math.min.apply(Math,Array.from(t.attributes,function(e){return e.shaderLocation}))}),r}function k(e,t,i){var r=e.attributes.find(function(e){return e.name===t});if(!r)return d.R.warn("Supplied attribute not present in shader layout: "+t)(),null;if(i){if(i.has(t))throw new Error("Found multiple entries for attribute: "+t);i.add(t)}return r}var W=function(e){function t(t,i){var r;if((r=e.call(this,t,i)||this).fs=null,r._bindGroupLayout=null,r._bindGroup=null,r.device=t,r.handle=r.props.handle,!r.handle){var n=r._getRenderPipelineDescriptor();d.R.groupCollapsed(1,"new WebGPURenderPipeline("+r.id+")")(),d.R.probe(1,JSON.stringify(n,null,2))(),d.R.groupEnd(1)(),r.device.pushErrorScope("validation"),r.handle=r.device.handle.createRenderPipeline(n),r.device.popErrorScope(function(e){r.device.reportError(new Error(r+' creation failed:\n"'+e.message+'"'),r)(),r.device.debug()})}return r.handle.label=r.props.id,r.vs=i.vs,r.fs=i.fs,r._bindings=Object.assign({},r.props.bindings),r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){this.handle=null},i.setBindings=function(e){for(var t=0,i=Object.entries(e);t<i.length;t++){var r=i[t],n=r[0],a=r[1];this._bindings[n]!==a&&(this._bindGroup=null)}Object.assign(this._bindings,e)},i.draw=function(e){var t=this,i=e.renderPass;this.device.pushErrorScope("validation"),i.handle.setPipeline(this.handle),this.device.popErrorScope(function(e){t.device.reportError(new Error(t+' setPipeline failed:\n"'+e.message+'"'),t)(),t.device.debug()});var r=this._getBindGroup();return r&&i.handle.setBindGroup(0,r),e.vertexArray.bindBeforeRender(e.renderPass),e.indexCount?i.handle.drawIndexed(e.indexCount,e.instanceCount,e.firstIndex,e.baseVertex,e.firstInstance):i.handle.draw(e.vertexCount||0,e.instanceCount||1,e.firstInstance),e.vertexArray.unbindAfterRender(e.renderPass),!0},i._getBindGroup=function(){return 0===this.shaderLayout.bindings.length?null:(this._bindGroupLayout=this._bindGroupLayout||this.handle.getBindGroupLayout(0),this._bindGroup=this._bindGroup||_(this.device.handle,this._bindGroupLayout,this.shaderLayout,this._bindings),this._bindGroup)},i._getRenderPipelineDescriptor=function(){var e={module:this.props.vs.handle,entryPoint:this.props.vertexEntryPoint||"main",buffers:G(this.shaderLayout,this.props.bufferLayout)},t=[];if(this.props.colorAttachmentFormats)for(var i,r=(0,S.A)(this.props.colorAttachmentFormats);!(i=r()).done;){var n=i.value;t.push(n?{format:p(n)}:null)}else t.push({format:p(this.device.preferredColorFormat)});var a={module:this.props.fs.handle,entryPoint:this.props.fragmentEntryPoint||"main",targets:t},o=this.device.createPipelineLayout({shaderLayout:this.shaderLayout}),s={vertex:e,fragment:a,primitive:{topology:this.props.topology},layout:o.handle},u=this.props.depthStencilAttachmentFormat||this.device.preferredDepthFormat;return this.props.parameters.depthWriteEnabled&&(s.depthStencil={format:p(u)}),R(s,this.props.parameters),s},(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"WebGPURenderPipeline"}}])}(A.r),j=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).handle=null,r.colorAttachments=[],r.depthStencilAttachment=null,r.device=t,r.autoCreateAttachmentTextures(),r}return(0,o.A)(t,e),t.prototype.updateAttachments=function(){},t}(i(1243).G),U=function(e){function t(t,i){var r;(r=e.call(this,t,i)||this)._bindGroupLayout=null,r._bindGroup=null,r._bindings={},r.device=t;var n=r.props.shader;return r.handle=r.props.handle||r.device.handle.createComputePipeline({label:r.props.id,compute:{module:n.handle,entryPoint:r.props.entryPoint,constants:r.props.constants},layout:"auto"}),r}(0,o.A)(t,e);var i=t.prototype;return i.setBindings=function(e){Object.assign(this._bindings,e)},i._getBindGroup=function(){return this._bindGroupLayout=this._bindGroupLayout||this.handle.getBindGroupLayout(0),this._bindGroup=this._bindGroup||_(this.device.handle,this._bindGroupLayout,this.shaderLayout,this._bindings),this._bindGroup},t}(i(9316).C),N=i(8639),V=i(7651),H=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).handle=null,r.device=t,r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){},i.setIndexBuffer=function(e){this.indexBuffer=e},i.setBuffer=function(e,t){this.attributes[e]=t},i.bindBeforeRender=function(e,t,i){var r=e,n=this.indexBuffer;null!=n&&n.handle&&(d.R.info(3,"setting index buffer",null==n?void 0:n.handle,null==n?void 0:n.indexType)(),r.handle.setIndexBuffer(null==n?void 0:n.handle,null==n?void 0:n.indexType));for(var a=0;a<this.maxVertexAttributes;a++){var o=this.attributes[a];null!=o&&o.handle&&(d.R.info(3,"setting vertex buffer "+a,null==o?void 0:o.handle)(),r.handle.setVertexBuffer(a,null==o?void 0:o.handle))}},i.unbindAfterRender=function(e){},t.isConstantAttributeZeroSupported=function(e){return"Chrome"===(0,V.X)()},(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"WebGPUVertexArray"}}])}(N.o),q=function(e){function t(t,i,r){var n;(n=e.call(this,r)||this).depthStencilAttachment=null;var a=n.canvas.getContext("webgpu");if(!a)throw new Error(n+": Failed to create WebGPU canvas context");return n.device=t,n.handle=a,n._setAutoCreatedCanvasId(n.device.id+"-canvas"),n._configureDevice(),n}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){this.handle.unconfigure(),e.prototype.destroy.call(this)},i._configureDevice=function(){this.depthStencilAttachment&&(this.depthStencilAttachment.destroy(),this.depthStencilAttachment=null),this.handle.configure({device:this.device.handle,format:this.device.preferredColorFormat,colorSpace:this.props.colorSpace,alphaMode:this.props.alphaMode})},i._getCurrentFramebuffer=function(e){var t;void 0===e&&(e={depthStencilFormat:"depth24plus"});var i,r=this._getCurrentTexture();if(r.width!==this.drawingBufferWidth||r.height!==this.drawingBufferHeight){var n=this.getDrawingBufferSize(),a=n[0],o=n[1];this.drawingBufferWidth=r.width,this.drawingBufferHeight=r.height,d.R.log(1,this+": Resized to compensate for initial canvas size mismatch "+a+"x"+o+" => "+this.drawingBufferWidth+"x"+this.drawingBufferHeight+"px")()}null!=(t=e)&&t.depthStencilFormat&&this._createDepthStencilAttachment(null==(i=e)?void 0:i.depthStencilFormat);return new j(this.device,{colorAttachments:[r],depthStencilAttachment:this.depthStencilAttachment})},i._getCurrentTexture=function(){var e=this.handle.getCurrentTexture();return this.device.createTexture({id:this.id+"#color-texture",handle:e,format:this.device.preferredColorFormat,width:e.width,height:e.height})},i._createDepthStencilAttachment=function(e){return this.depthStencilAttachment||(this.depthStencilAttachment=this.device.createTexture({id:this.id+"#depth-stencil-texture",usage:h.g.RENDER_ATTACHMENT,format:e,width:this.drawingBufferWidth,height:this.drawingBufferHeight})),this.depthStencilAttachment},(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"WebGPUCanvasContext"}}])}(i(3956).Q),Q=i(5524),Y=function(e){function t(t,i){var r;return(r=e.call(this,t.device,{})||this).device=t.device,r.handle=r.props.handle||t.handle.finish({label:(null==i?void 0:i.id)||"unnamed-command-buffer"}),r}return(0,o.A)(t,e),t}(i(516).M),X=i(7462),J=function(e){function t(t,i){var r;void 0===i&&(i={}),(r=e.call(this,t,i)||this).pipeline=null,r.device=t;var n=i.framebuffer||t.getCanvasContext().getCurrentFramebuffer(),a=r.getRenderPassDescriptor(n),o=i.timestampQuerySet;if(o&&(a.occlusionQuerySet=o.handle),t.features.has("timestamp-query")){var s=i.timestampQuerySet;a.timestampWrites=s?{querySet:s.handle,beginningOfPassWriteIndex:i.beginTimestampIndex,endOfPassWriteIndex:i.endTimestampIndex}:void 0}if(!t.commandEncoder)throw new Error("commandEncoder not available");return r.device.pushErrorScope("validation"),r.handle=r.props.handle||t.commandEncoder.handle.beginRenderPass(a),r.device.popErrorScope(function(e){r.device.reportError(new Error(r+' creation failed:\n"'+e.message+'"'),r)(),r.device.debug()}),r.handle.label=r.props.id,d.R.groupCollapsed(3,"new WebGPURenderPass("+r.id+")")(),d.R.probe(3,JSON.stringify(a,null,2))(),d.R.groupEnd(3)(),r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){},i.end=function(){this.handle.end()},i.setPipeline=function(e){var t=this;this.pipeline=e,this.device.pushErrorScope("validation"),this.handle.setPipeline(this.pipeline.handle),this.device.popErrorScope(function(e){t.device.reportError(new Error(t+' setPipeline failed:\n"'+e.message+'"'),t)(),t.device.debug()})},i.setBindings=function(e){var t,i;null==(t=this.pipeline)||t.setBindings(e);var r=null==(i=this.pipeline)?void 0:i._getBindGroup();r&&this.handle.setBindGroup(0,r)},i.setIndexBuffer=function(e,t,i,r){void 0===i&&(i=0),this.handle.setIndexBuffer(e.handle,t,i,r)},i.setVertexBuffer=function(e,t,i){void 0===i&&(i=0),this.handle.setVertexBuffer(e,t.handle,i)},i.draw=function(e){e.indexCount?this.handle.drawIndexed(e.indexCount,e.instanceCount,e.firstIndex,e.baseVertex,e.firstInstance):this.handle.draw(e.vertexCount||0,e.instanceCount||1,e.firstIndex,e.firstInstance)},i.drawIndirect=function(){},i.setParameters=function(e){var t,i,r=e.blendConstant,n=e.stencilReference,a=e.scissorRect,o=e.viewport;(r&&this.handle.setBlendConstant(r),n&&this.handle.setStencilReference(n),a&&this.handle.setScissorRect(a[0],a[1],a[2],a[3]),o)&&this.handle.setViewport(o[0],o[1],o[2],o[3],null!=(t=o[4])?t:0,null!=(i=o[5])?i:1)},i.pushDebugGroup=function(e){this.handle.pushDebugGroup(e)},i.popDebugGroup=function(){this.handle.popDebugGroup()},i.insertDebugMarker=function(e){this.handle.insertDebugMarker(e)},i.beginOcclusionQuery=function(e){this.handle.beginOcclusionQuery(e)},i.endOcclusionQuery=function(){this.handle.endOcclusionQuery()},i.getRenderPassDescriptor=function(e){var t=this,i={colorAttachments:[]};if(i.colorAttachments=e.colorAttachments.map(function(e,i){var r,n;return{loadOp:!1!==t.props.clearColor?"clear":"load",clearValue:(n=(null==(r=t.props.clearColors)?void 0:r[i])||t.props.clearColor||X.A.defaultClearColor,{r:n[0],g:n[1],b:n[2],a:n[3]}),storeOp:t.props.discard?"discard":"store",view:e.handle}}),e.depthStencilAttachment){i.depthStencilAttachment={view:e.depthStencilAttachment.handle};var r=i.depthStencilAttachment;this.props.depthReadOnly&&(r.depthReadOnly=!0),!1!==this.props.clearDepth&&(r.depthClearValue=this.props.clearDepth);r.depthLoadOp=!1!==this.props.clearDepth?"clear":"load",r.depthStoreOp="store";!1}return i},t}(X.A);var Z=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,o.A)(t,e),(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"ComputePass"}}])}(y.F);Z.defaultProps=Object.assign({},y.F.defaultProps,{timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});var $=function(e){function t(t,i){var r,n;if((r=e.call(this,t,i)||this)._webgpuPipeline=null,r.device=t,t.features.has("timestamp-query")){var a=i.timestampQuerySet;a&&(n={querySet:a.handle,beginningOfPassWriteIndex:i.beginTimestampIndex,endOfPassWriteIndex:i.endTimestampIndex})}return r.handle=r.props.handle||t.commandEncoder.handle.beginComputePass({label:r.props.id,timestampWrites:n}),r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){},i.end=function(){this.handle.end()},i.setPipeline=function(e){var t=e;this.handle.setPipeline(t.handle),this._webgpuPipeline=t,this.setBindings([])},i.setBindings=function(e){var t=this._webgpuPipeline._getBindGroup();this.handle.setBindGroup(0,t)},i.dispatch=function(e,t,i){this.handle.dispatchWorkgroups(e,t,i)},i.dispatchIndirect=function(e,t){void 0===t&&(t=0);var i=e;this.handle.dispatchWorkgroupsIndirect(i.handle,t)},i.pushDebugGroup=function(e){this.handle.pushDebugGroup(e)},i.popDebugGroup=function(){this.handle.popDebugGroup()},i.insertDebugMarker=function(e){this.handle.insertDebugMarker(e)},t}(Z),K=function(e){function t(t,i){var r;return void 0===i&&(i={}),(r=e.call(this,t,i)||this).device=t,r.handle=i.handle||r.device.handle.createCommandEncoder({label:r.props.id}),r.handle.label=r.props.id,r}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){},i.finish=function(e){var t=this;this.device.pushErrorScope("validation");var i=new Y(this,{id:(null==e?void 0:e.id)||"unnamed-command-buffer"});return this.device.popErrorScope(function(e){var i=t+" command encoding: "+e.message+". Maybe add depthWriteEnabled to your Model?";t.device.reportError(new Error(i),t)(),t.device.debug()}),i},i.beginRenderPass=function(e){return new J(this.device,e)},i.beginComputePass=function(e){return new $(this.device,e)},i.copyBufferToBuffer=function(e){var t,i,r,n=e.sourceBuffer,a=e.destinationBuffer;this.handle.copyBufferToBuffer(n.handle,null!=(t=e.sourceOffset)?t:0,a.handle,null!=(i=e.destinationOffset)?i:0,null!=(r=e.size)?r:0)},i.copyBufferToTexture=function(e){var t,i,r,n,a,o,s=e.sourceBuffer,u=e.destinationTexture;this.handle.copyBufferToTexture({buffer:s.handle,offset:null!=(t=e.offset)?t:0,bytesPerRow:e.bytesPerRow,rowsPerImage:e.rowsPerImage},{texture:u.handle,mipLevel:null!=(i=e.mipLevel)?i:0,origin:null!=(r=e.origin)?r:{}},{width:null==(n=e.extent)?void 0:n[0],height:null==(a=e.extent)?void 0:a[1],depthOrArrayLayers:null==(o=e.extent)?void 0:o[2]})},i.copyTextureToBuffer=function(e){},i.copyTextureToTexture=function(e){},i.pushDebugGroup=function(e){this.handle.pushDebugGroup(e)},i.popDebugGroup=function(){this.handle.popDebugGroup()},i.insertDebugMarker=function(e){this.handle.insertDebugMarker(e)},i.resolveQuerySet=function(e,t,i){var r=e,n=t;this.handle.resolveQuerySet(r.handle,(null==i?void 0:i.firstQuery)||0,(null==i?void 0:i.queryCount)||e.props.count-((null==i?void 0:i.firstQuery)||0),n.handle,(null==i?void 0:i.destinationOffset)||0)},t}(Q.i),ee=function(e){function t(t,i){var r;return(r=e.call(this,t,i)||this).device=t,r.handle=r.props.handle||r.device.handle.createQuerySet({type:r.props.type,count:r.props.count}),r.handle.label=r.props.id,r}return(0,o.A)(t,e),t.prototype.destroy=function(){var e;null==(e=this.handle)||e.destroy(),this.handle=null},t}(i(1101).d),te=function(e){function t(i,r){return e.call(this,i,r,t.defaultProps)||this}return(0,o.A)(t,e),(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"PipelineLayout"}}])}(y.F);te.defaultProps=Object.assign({},y.F.defaultProps,{shaderLayout:{attributes:[],bindings:[]}});var ie=function(e){function t(t,i){var r,n;(n=e.call(this,t,i)||this).device=t;var a=n.mapShaderLayoutToBindGroupEntries();return n.handle=n.device.handle.createPipelineLayout({label:null!=(r=null==i?void 0:i.id)?r:"unnamed-pipeline-layout",bindGroupLayouts:[n.device.handle.createBindGroupLayout({label:"bind-group-layout",entries:a})]}),n}(0,o.A)(t,e);var i=t.prototype;return i.destroy=function(){this.handle=null},i.mapShaderLayoutToBindGroupEntries=function(){for(var e=[],t=0;t<this.props.shaderLayout.bindings.length;t++){var i=this.props.shaderLayout.bindings[t],r={};switch(i.type){case"uniform":r.buffer={type:"uniform",hasDynamicOffset:i.hasDynamicOffset,minBindingSize:i.minBindingSize};break;case"read-only-storage":r.buffer={type:"read-only-storage",hasDynamicOffset:i.hasDynamicOffset,minBindingSize:i.minBindingSize};break;case"sampler":r.sampler={type:i.samplerType};break;case"storage":re(i)?r.storageTexture={format:i.format,access:i.access,viewDimension:i.viewDimension}:r.buffer={type:"storage",hasDynamicOffset:i.hasDynamicOffset,minBindingSize:i.minBindingSize};break;case"texture":r.texture={multisampled:i.multisampled,sampleType:i.sampleType,viewDimension:i.viewDimension};break;default:d.R.warn("unhandled binding type when creating pipeline descriptor")()}var n=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE;e.push(Object.assign({binding:i.location,visibility:i.visibility||n},r))}return e},t}(te),re=function(e){return void 0!==e.format},ne=function(e){function t(t,i){var r;return void 0===i&&(i={}),(r=e.call(this,t,{})||this).handle=null,r._signaled=!1,r.device=t,r.signaled=t.handle.queue.onSubmittedWorkDone().then(function(){r._signaled=!0}),r}(0,o.A)(t,e);var i=t.prototype;return i.isSignaled=function(){return this._signaled},i.destroy=function(){},t}(i(2645).O),ae=i(2973);function oe(e){var t,i={attributes:[],bindings:[]};try{t=function(e){try{return new ae.$X(e)}catch(i){if(i instanceof Error)throw i;var t="WGSL parse error";throw"object"==typeof i&&null!=i&&i.message&&(t+=": "+i.message+" "),"object"==typeof i&&null!=i&&i.token&&(t+=i.token.line||""),new Error(t,{cause:i})}}(e)}catch(E){return d.R.error(E.message)(),i}for(var r,n=(0,S.A)(t.uniforms);!(r=n()).done;){for(var a,o=r.value,s=[],u=(0,S.A)((null==(c=o.type)?void 0:c.members)||[]);!(a=u()).done;){var c,h=a.value;s.push({name:h.name,type:se(h.type)})}i.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:s})}for(var l,p=(0,S.A)(t.textures);!(l=p()).done;){var f=l.value,m=Object.assign({type:"texture",name:f.name,group:f.group,location:f.binding},ue(f));i.bindings.push(m)}for(var v,g=(0,S.A)(t.samplers);!(v=g()).done;){var y=v.value;i.bindings.push({type:"sampler",name:y.name,group:y.group,location:y.binding})}for(var b=t.entry.vertex[0],x=(null==b?void 0:b.inputs.length)||0,w=0;w<x;w++){var A=b.inputs[w];if("location"===A.locationType){var P=se(A.type);i.attributes.push({name:A.name,location:Number(A.location),type:P})}}return i}function se(e){return null!=e&&e.format?e.name+"<"+e.format.name+">":e.name}function ue(e,t){var i;if(e.resourceType!==ae.vt.Texture)throw new Error("Not a texture binding");var r=e.type.name,n=null==(i=e.type.format)?void 0:i.name,a=r.includes("cube_array")?"cube-array":r.includes("cube")?"cube":r.includes("2d_array")?"2d-array":r.includes("3d")?"3d":r.includes("1d")?"1d":"2d",o="texture_multisampled_2d"===r;return{viewDimension:a,sampleType:r.startsWith("texture_depth")?"depth":"i32"===n?"sint":"u32"===n?"uint":"float",multisampled:o}}var de=function(e){function t(t,i,a,o){var u;(u=e.call(this,Object.assign({},t,{id:t.id||"webgpu-device"}))||this).type="webgpu",u.preferredColorFormat=navigator.gpu.getPreferredCanvasFormat(),u.preferredDepthFormat="depth24plus",u.canvasContext=null,u._isLost=!1,u.handle=i,u.adapter=a,u.adapterInfo=o,u.info=u._getInfo(),u.features=u._getFeatures(),u.limits=u.handle.limits,i.addEventListener("uncapturederror",function(e){e.preventDefault();var t=e instanceof GPUUncapturedErrorEvent?e.error.message:"Unknown WebGPU error";u.reportError(new Error(t),u)(),u.debug()}),u.lost=new Promise(function(){var e=(0,n.A)((0,r.A)().m(function e(t){var i;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u.handle.lost;case 1:i=e.v,u._isLost=!0,t({reason:"destroyed",message:i.message});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());var d=s.pF._getCanvasContextProps(t);return d&&(u.canvasContext=new q(u,u.adapter,d)),u.commandEncoder=u.createCommandEncoder({}),u}(0,o.A)(t,e);var i=t.prototype;return i.toString=function(){return"WebGPUDevice("+this.id+")"},i.destroy=function(){this.handle.destroy()},i.getShaderLayout=function(e){return oe(e)},i.isVertexFormatSupported=function(e){return!this.getVertexFormatInfo(e).webglOnly},i.createBuffer=function(e){var t=this._normalizeBufferProps(e);return new c(this,t)},i.createTexture=function(e){return new g(this,e)},i.createExternalTexture=function(e){return new x(this,e)},i.createShader=function(e){return new w(this,e)},i.createSampler=function(e){return new m(this,e)},i.createRenderPipeline=function(e){return new W(this,e)},i.createFramebuffer=function(e){return new j(this,e)},i.createComputePipeline=function(e){return new U(this,e)},i.createVertexArray=function(e){return new H(this,e)},i.createCommandEncoder=function(e){return new K(this,e)},i.createTransformFeedback=function(e){throw new Error("Transform feedback not supported in WebGPU")},i.createQuerySet=function(e){return new ee(this,e)},i.createFence=function(){return new ne(this)},i.createCanvasContext=function(e){return new q(this,this.adapter,e)},i.createPipelineLayout=function(e){return new ie(this,e)},i.submit=function(e){var t=this;e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:this.id+"-default-encoder"})),this.pushErrorScope("validation"),this.handle.queue.submit([e.handle]),this.popErrorScope(function(e){t.reportError(new Error(t+" command submission: "+e.message),t)(),t.debug()})},i.pushErrorScope=function(e){this.handle.pushErrorScope(e)},i.popErrorScope=function(e){this.handle.popErrorScope().then(function(t){t&&e(t)})},i._getInfo=function(){var e=(this.adapterInfo.driver||"").split(" Version "),t=e[0],i=e[1],r=this.adapterInfo.vendor||this.adapter.__brand||"unknown",n=t||"",a=i||"",o="apple"===r?"apple":"unknown",s=this.adapterInfo.architecture||"unknown",u=this.adapterInfo.backend||"unknown";return{type:"webgpu",vendor:r,renderer:n,version:a,gpu:o,gpuType:(this.adapterInfo.type||"").split(" ")[0].toLowerCase()||"unknown",gpuBackend:u,gpuArchitecture:s,shadingLanguage:"wgsl",shadingLanguageVersion:100}},i._getFeatures=function(){var e=new Set(this.handle.features);e.has("depth-clamping")&&(e.delete("depth-clamping"),e.add("depth-clip-control")),e.has("texture-compression-bc")&&e.add("texture-compression-bc5-webgl"),this.handle.features.has("chromium-experimental-norm16-texture-formats")&&e.add("norm16-renderable-webgl"),this.handle.features.has("chromium-experimental-snorm16-texture-formats")&&e.add("snorm16-renderable-webgl");for(var t=0,i=["timer-query-webgl","compilation-status-async-webgl","float32-renderable-webgl","float16-renderable-webgl","norm16-renderable-webgl","texture-filterable-anisotropic-webgl","shader-noperspective-interpolation-webgl"];t<i.length;t++){var r=i[t];e.add(r)}return new s.I7(Array.from(e),this.props._disabledFeatures)},i._getDeviceSpecificTextureFormatCapabilities=function(e){var t=e.format;return t.includes("webgl")?{format:t,create:!1,render:!1,filter:!1,blend:!1,store:!1}:e},(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"WebGPUDevice"}},{key:"isLost",get:function(){return this._isLost}}])}(s.pF)},7083:(e,t,i)=>{i.d(t,{g:()=>h});var r,n=i(8696),a=i(7387),o=i(7862),s=i(5768),u=i(3522),d=i(116),c={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"},h=function(e){function t(i,r,n){var a;if(r=t.normalizeProps(i,r),(a=e.call(this,i,r,t.defaultProps)||this).ready=Promise.resolve(a),a.isReady=!0,a.dimension=a.props.dimension,a.baseDimension=c[a.dimension],a.format=a.props.format,a.width=a.props.width,a.height=a.props.height,a.depth=a.props.depth,a.mipLevels=a.props.mipLevels,"cube"===a.dimension&&(a.depth=6),void 0===a.props.width||void 0===a.props.height)if(i.isExternalImage(r.data)){var o=i.getExternalImageSize(r.data);a.width=(null==o?void 0:o.width)||1,a.height=(null==o?void 0:o.height)||1}else a.width=1,a.height=1,void 0!==a.props.width&&void 0!==a.props.height||u.R.warn(a+" created with undefined width or height. This is deprecated. Use DynamicTexture instead.")();return a.byteAlignment=(null==n?void 0:n.byteAlignment)||1,a.updateTimestamp=i.incrementTimestamp(),a}(0,a.A)(t,e);var i=t.prototype;return i.toString=function(){return"Texture("+this.id+","+this.format+","+this.width+"x"+this.height+")"},i.clone=function(e){return this.device.createTexture(Object.assign({},this.props,e))},i.setSampler=function(e){this.sampler=e instanceof s.L?e:this.device.createSampler(e)},i.computeMemoryLayout=function(e){void 0===e&&(e={});var t=this._normalizeTextureReadOptions(e),i=t.width,r=void 0===i?this.width:i,n=t.height,a=void 0===n?this.height:n,o=t.depthOrArrayLayers,s=void 0===o?this.depth:o,u=this.format,c=this.byteAlignment;return d.vz.computeMemoryLayout({format:u,width:r,height:a,depth:s,byteAlignment:c})},i.readBuffer=function(e,t){throw new Error("readBuffer not implemented")},i.readDataAsync=function(e){throw new Error("readBuffer not implemented")},i.writeBuffer=function(e,t){throw new Error("readBuffer not implemented")},i.writeData=function(e,t){throw new Error("readBuffer not implemented")},i.readDataSyncWebGL=function(e){throw new Error("readDataSyncWebGL not available")},i.generateMipmapsWebGL=function(){throw new Error("generateMipmapsWebGL not available")},t.normalizeProps=function(e,t){var i=Object.assign({},t),r=i.width,n=i.height;return"number"==typeof r&&(i.width=Math.max(1,Math.ceil(r))),"number"==typeof n&&(i.height=Math.max(1,Math.ceil(n))),i},i._initializeData=function(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})},i._normalizeCopyImageDataOptions=function(e){var i=this.width,r=this.height,n=this.depth,a=Object.assign({},t.defaultCopyDataOptions,{width:i,height:r,depth:n},e),o=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!o.bytesPerPixel)throw new Error("bytesPerRow must be provided for texture format "+this.format);return a.bytesPerRow=e.bytesPerRow||i*(o.bytesPerPixel||4),a.rowsPerImage=e.rowsPerImage||r,a},i._normalizeCopyExternalImageOptions=function(e){var i=this.device.getExternalImageSize(e.image),r=Object.assign({},t.defaultCopyExternalImageOptions,i,e);return r.width=Math.min(r.width,this.width-r.x),r.height=Math.min(r.height,this.height-r.y),r},i._normalizeTextureReadOptions=function(e){var i=this.width,r=this.height,n=Object.assign({},t.defaultTextureReadOptions,{width:i,height:r},e);return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n},i._normalizeTextureWriteOptions=function(e){var i=this.width,r=this.height,n=Object.assign({},t.defaultTextureReadOptions,{width:i,height:r},e);return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n},(0,n.A)(t,[{key:Symbol.toStringTag,get:function(){return"Texture"}}])}(o.F);r=h,h.SAMPLE=4,h.STORAGE=8,h.RENDER=16,h.COPY_SRC=1,h.COPY_DST=2,h.TEXTURE=4,h.RENDER_ATTACHMENT=16,h.defaultProps=Object.assign({},o.F.defaultProps,{data:null,dimension:"2d",format:"rgba8unorm",usage:r.SAMPLE|r.RENDER|r.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0}),h.defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"},h.defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1},h.defaultTextureReadOptions={x:0,y:0,z:0,width:void 0,height:void 0,depthOrArrayLayers:1,mipLevel:0,aspect:"all"}},7462:(e,t,i)=>{i.d(t,{A:()=>s});var r,n=i(8696),a=i(7387),o=i(7862),s=function(e){function t(i,r){return r=t.normalizeProps(i,r),e.call(this,i,r,t.defaultProps)||this}return(0,a.A)(t,e),t.normalizeProps=function(e,t){return t},(0,n.A)(t,[{key:Symbol.toStringTag,get:function(){return"RenderPass"}}])}(o.F);r=s,s.defaultClearColor=[0,0,0,1],s.defaultClearDepth=1,s.defaultClearStencil=0,s.defaultProps=Object.assign({},o.F.defaultProps,{framebuffer:null,parameters:void 0,clearColor:r.defaultClearColor,clearColors:void 0,clearDepth:r.defaultClearDepth,clearStencil:r.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0})},7468:(e,t,i)=>{i.d(t,{M:()=>l});var r=i(2444),n=i(467),a=i(8696),o=i(7387),s=i(7862),u=i(1166),d=i(3845);function c(e,t,i,r){if(null!=r&&r.inlineSource){var n=function(e,t,i){for(var r="",n=t-2;n<=t;n++){var a=e[n-1];void 0!==a&&(r+=h(a,t,i))}return r}(t,i);return"\n"+n+(e.linePos>0?" ".repeat(e.linePos+5)+"^^^\n":"")+e.type.toUpperCase()+": "+e.message+"\n\n"}var a="error"===e.type?"red":"#8B4000";return null!=r&&r.html?"<div class='luma-compiler-log-error' style=\"color:"+a+';"><b> '+e.type.toUpperCase()+": "+e.message+"</b></div>":e.type.toUpperCase()+": "+e.message}function h(e,t,i){var r=null!=i&&i.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return function(e,t){for(var i="",r=e.length;r<t;++r)i+=" ";return i+e}(String(t),4)+": "+r+(null!=i&&i.html?"<br/>":"\n")}var l=function(e){function t(i,r){var n;return r=Object.assign({},r,{debugShaders:r.debugShaders||i.props.debugShaders||"errors"}),(n=e.call(this,i,Object.assign({id:p(r)},r),t.defaultProps)||this).compilationStatus="pending",n.stage=n.props.stage,n.source=n.props.source,n}(0,o.A)(t,e);var i=t.prototype;return i.getCompilationInfoSync=function(){return null},i.getTranslatedSource=function(){return null},i.debugShader=function(){var e=(0,n.A)((0,r.A)().m(function e(){var t,i,n;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:t=this.props.debugShaders,n=t,e.n="never"===n?1:"errors"===n?2:"warnings"===n||"always"===n?4:5;break;case 1:return e.a(2);case 2:if("success"!==this.compilationStatus){e.n=3;break}return e.a(2);case 3:case 4:return e.a(3,5);case 5:return e.n=6,this.getCompilationInfo();case 6:if(i=e.v,"warnings"!==t||0!==(null==i?void 0:i.length)){e.n=7;break}return e.a(2);case 7:this._displayShaderLog(i,this.id);case 8:return e.a(2)}},e,this)}));return function(){return e.apply(this,arguments)}}(),i._displayShaderLog=function(e,t){var i,r,n=this;if("undefined"!=typeof document&&null!=(i=document)&&i.createElement){var a=t,o=this.stage+' shader "'+a+'"',s=function(e,t,i){var r="",n=t.split(/\r?\n/),a=e.slice().sort(function(e,t){return e.lineNum-t.lineNum});switch((null==i?void 0:i.showSourceCode)||"no"){case"all":for(var o=0,s=1;s<=n.length;s++)for(r+=h(n[s-1],s,i);a.length>o&&a[o].lineNum===s;){var u=a[o++];r+=c(u,n,u.lineNum,Object.assign({},i,{inlineSource:!1}))}for(;a.length>o;)r+=c(a[o++],[],0,Object.assign({},i,{inlineSource:!1}));return r;case"issues":case"no":for(var l,p=(0,d.A)(e);!(l=p()).done;){var f=l.value;r+=c(f,n,f.lineNum,{inlineSource:"no"!==(null==i?void 0:i.showSourceCode)})}return r}}(e,this.source,{showSourceCode:"all",html:!0}),u=this.getTranslatedSource();u&&(s+='<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>'+u+"</pre></code>");var l=document.createElement("Button");l.innerHTML="\n<h1>Compilation error in "+o+'</h1><br /><br />\n<code style="user-select:text;"><pre>\n'+s+"\n</pre></code>",l.style.top="10px",l.style.left="10px",l.style.position="absolute",l.style.zIndex="9999",l.style.width="100%",l.style.textAlign="left",document.body.appendChild(l),null==(r=document.getElementsByClassName("luma-compiler-log-error")[0])||r.scrollIntoView(),l.onclick=function(){var e="data:text/plain,"+encodeURIComponent(n.source);navigator.clipboard.writeText(e)}}},(0,a.A)(t,[{key:Symbol.toStringTag,get:function(){return"Shader"}}])}(s.F);function p(e){return function(e,t){void 0===t&&(t="unnamed");var i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return i?i[1]:t}(e.source)||e.id||(0,u.L)("unnamed "+e.stage+"-shader")}l.defaultProps=Object.assign({},s.F.defaultProps,{language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0})},8639:(e,t,i)=>{i.d(t,{o:()=>s});var r=i(8696),n=i(7387),a=i(2018),o=i(7862),s=function(e){function t(i,r){var n;return(n=e.call(this,i,r,t.defaultProps)||this).indexBuffer=null,n.maxVertexAttributes=i.limits.maxVertexAttributes,n.attributes=new Array(n.maxVertexAttributes).fill(null),n.attributeInfos=(0,a.M)(r.shaderLayout,r.bufferLayout,n.maxVertexAttributes),n}return(0,n.A)(t,e),t.prototype.setConstantWebGL=function(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()},(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"VertexArray"}}])}(o.F);s.defaultProps=Object.assign({},o.F.defaultProps,{shaderLayout:void 0,bufferLayout:[]})},9316:(e,t,i)=>{i.d(t,{C:()=>o});var r=i(8696),n=i(7387),a=i(7862),o=function(e){function t(i,r){var n;return(n=e.call(this,i,r,t.defaultProps)||this).hash="",n.shaderLayout=r.shaderLayout,n}return(0,n.A)(t,e),(0,r.A)(t,[{key:Symbol.toStringTag,get:function(){return"ComputePipeline"}}])}(a.F);o.defaultProps=Object.assign({},a.F.defaultProps,{shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0})}}]);