{"version":3,"sources":["webpack:///../examples/core/texture-3d/perlin.js","webpack:///../examples/core/texture-3d/app.js","webpack:///./templates/core/example-texture-3d.jsx"],"names":["lerp","a","t","b","range","result","i","shuffle","array","randomIndex","currentIndex","swapValue","Math","random","fade","x","grad","h","hash","u","v","AppAnimationLoop","props","Object","useDevicePixels","getInfo","onInitialize","gl","this","isDemoSupported","isWebGL2","noise","params","Array","irp","p","fx","fy","fz","X","Y","Z","y","z","w","A","AA","AB","B","BA","BB","perlin","interpolation","permutation","setParameters","clearColor","blend","blendFunc","positionData","Float32Array","DIMENSIONS","positionIndex","j","k","positionBuffer","textureData","Uint8Array","TEXTURE_DIMENSIONS","textureIndex","mvpMat","viewMat","eye","texture","width","height","depth","data","format","dataFormat","R8","cloud","vs","fs","drawMode","vertexCount","attributes","position","uniforms","uTexture","uView","onRender","animationProps","tick","aspect","fov","radians","near","far","uTime","uMVP","onFinalize","isSupported","getAltText","AnimationLoop","window","animationLoop","Example","render","exampleConfig","pageContext","React","Component"],"mappings":"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","file":"component---templates-core-example-texture-3-d-jsx-ecf12f312ead47adb943.js","sourcesContent":["// Ported from https://github.com/BartVanBeurden/node-noise3d\n// Used under WTFPL\n/* eslint-disable */\n\nexport function nearestNeighbour(a, b, t) {\n  return t < 0.5 ? a : b;\n}\n\nexport function lerp(a, b, t) {\n  return a + t * (b - a);\n}\n\nexport function cosine(a, b, t) {\n  t = (1 - Math.cos(t * Math.PI)) * 0.5;\n  return a + t * (b - a);\n}\n\nexport function range(a, b) {\n  var result = [];\n  for (var i = a; i <= b; i++) {\n    result.push(i);\n  }\n  return result;\n}\n\nexport function shuffle(array, random) {\n  // Fisher-Yates\n  var currentIndex = array.length;\n  var swapValue = 0;\n  var randomIndex;\n\n  while (currentIndex) {\n    randomIndex = Math.floor(random() * currentIndex);\n    currentIndex -= 1;\n\n    swapValue = array[currentIndex];\n    array[currentIndex] = array[randomIndex];\n    array[randomIndex] = swapValue;\n  }\n\n  return array;\n}\n\nvar fade = function(x) {\n  return x * x * x * (x * (x * 6 - 15) + 10);\n};\n\nvar grad = function(hash, x, y, z) {\n  var h = hash & 15;\n  var u = h < 8 ? x : y;\n  var v = h < 4 ? y : h == 12 || h == 14 ? x : z;\n  return (h & 1 ? -u : u) + (h & 2 ? -v : v);\n};\n\nexport function perlin(params) {\n  if (typeof params != 'object') throw new TypeError('params is not an object');\n  if (typeof params.interpolation != 'function')\n    throw new TypeError('params.interpolation is not a function');\n  if (!Array.isArray(params.permutation)) throw new TypeError('params.permutation is not an array');\n  if (params.permutation.length != 256) throw new Error('params.permutation must have 256 items');\n\n  var irp = params.interpolation;\n  var p = params.permutation.slice(0);\n\n  for (var i = 0; i < 256; i++) p[256 + i] = p[i];\n\n  return function(x, y, z) {\n    var fx = Math.floor(x);\n    var fy = Math.floor(y);\n    var fz = Math.floor(z);\n\n    var X = fx & 255;\n    var Y = fy & 255;\n    var Z = fz & 255;\n\n    x -= fx;\n    y -= fy;\n    z -= fz;\n\n    var u = fade(x);\n    var v = fade(y);\n    var w = fade(z);\n\n    var A = p[X] + Y;\n    var AA = p[A] + Z;\n    var AB = p[A + 1] + Z;\n    var B = p[X + 1] + Y;\n    var BA = p[B] + Z;\n    var BB = p[B + 1] + Z;\n\n    return irp(\n      irp(\n        irp(grad(p[AA], x, y, z), grad(p[BA], x - 1, y, z), u),\n        irp(grad(p[AB], x, y - 1, z), grad(p[BB], x - 1, y - 1, z), u),\n        v\n      ),\n      irp(\n        irp(grad(p[AA + 1], x, y, z - 1), grad(p[BA + 1], x - 1, y, z - 1), u),\n        irp(grad(p[AB + 1], x, y - 1, z - 1), grad(p[BB + 1], x - 1, y - 1, z - 1), u),\n        v\n      ),\n      w\n    );\n  };\n}\n","import {AnimationLoop, setParameters, Model, Texture3D, Buffer, isWebGL2} from '@luma.gl/core';\nimport {Matrix4, radians} from 'math.gl';\nimport {perlin, lerp, shuffle, range} from './perlin';\n\n/*\n  Ported from PicoGL.js example: https://tsherif.github.io/picogl.js/examples/3Dtexture.html\n*/\n\nconst INFO_HTML = `\n<p>\nVolumetric 3D noise visualized using a <b>3D texture</b>.\n<p>\nUses the luma.gl <code>Texture3D</code> class.\n`;\n\nconst vs = `\\\n#version 300 es\nin vec3 position;\n\nuniform mat4 uMVP;\n\nout vec3 vUV;\nvoid main() {\n  vUV = position.xyz + 0.5;\n  gl_Position = uMVP * vec4(position, 1.0);\n  gl_PointSize = 2.0;\n}`;\n\nconst fs = `\\\n#version 300 es\nprecision highp float;\nprecision lowp sampler3D;\nin vec3 vUV;\nuniform sampler3D uTexture;\nuniform float uTime;\nout vec4 fragColor;\nvoid main() {\n  float alpha = texture(uTexture, vUV + vec3(0.0, 0.0, uTime)).r * 0.1;\n  fragColor = vec4(fract(vUV) * alpha, alpha);\n}`;\n\nconst NEAR = 0.1;\nconst FAR = 10.0;\nconst ALT_TEXT = \"THIS DEMO REQUIRES WEBLG2, BUT YOUR BROWSER DOESN'T SUPPORT IT\";\n\nexport default class AppAnimationLoop extends AnimationLoop {\n  static getInfo() {\n    return INFO_HTML;\n  }\n\n  constructor(props = {}) {\n    super(Object.assign(props, {useDevicePixels: true}));\n    // Default value is true, so GL context is always created to verify wheter it is WebGL2 or not.\n    this.isDemoSupported = true;\n  }\n\n  onInitialize({gl}) {\n    this.isDemoSupported = isWebGL2(gl);\n    if (!this.isDemoSupported) {\n      return {};\n    }\n    const noise = perlin({\n      interpolation: lerp,\n      permutation: shuffle(range(0, 255), Math.random)\n    });\n\n    setParameters(gl, {\n      clearColor: [0, 0, 0, 1],\n      blend: true,\n      blendFunc: [gl.ONE, gl.ONE_MINUS_SRC_ALPHA]\n    });\n\n    // CREATE POINT CLOUD\n    const DIMENSIONS = 128;\n    const INCREMENT = 1 / DIMENSIONS;\n\n    const positionData = new Float32Array(DIMENSIONS * DIMENSIONS * DIMENSIONS * 3);\n    let positionIndex = 0;\n    let x = -0.5;\n    for (let i = 0; i < DIMENSIONS; ++i) {\n      let y = -0.5;\n      for (let j = 0; j < DIMENSIONS; ++j) {\n        let z = -0.5;\n        for (let k = 0; k < DIMENSIONS; ++k) {\n          positionData[positionIndex++] = x;\n          positionData[positionIndex++] = y;\n          positionData[positionIndex++] = z;\n          z += INCREMENT;\n        }\n        y += INCREMENT;\n      }\n      x += INCREMENT;\n    }\n\n    const positionBuffer = new Buffer(gl, positionData);\n\n    // CREATE 3D TEXTURE\n    const TEXTURE_DIMENSIONS = 16;\n    const NOISE_DIMENSIONS = TEXTURE_DIMENSIONS * 0.07;\n    const textureData = new Uint8Array(\n      TEXTURE_DIMENSIONS * TEXTURE_DIMENSIONS * TEXTURE_DIMENSIONS\n    );\n    let textureIndex = 0;\n    for (let i = 0; i < TEXTURE_DIMENSIONS; ++i) {\n      for (let j = 0; j < TEXTURE_DIMENSIONS; ++j) {\n        for (let k = 0; k < TEXTURE_DIMENSIONS; ++k) {\n          textureData[textureIndex++] =\n            (0.5 + 0.5 * noise(i / NOISE_DIMENSIONS, j / NOISE_DIMENSIONS, k / NOISE_DIMENSIONS)) *\n            255;\n        }\n      }\n    }\n\n    const mvpMat = new Matrix4();\n    const viewMat = new Matrix4().lookAt({eye: [1, 1, 1]});\n\n    const texture = new Texture3D(gl, {\n      width: TEXTURE_DIMENSIONS,\n      height: TEXTURE_DIMENSIONS,\n      depth: TEXTURE_DIMENSIONS,\n      data: textureData,\n      format: gl.RED,\n      dataFormat: gl.R8\n    });\n\n    const cloud = new Model(gl, {\n      vs,\n      fs,\n      drawMode: gl.POINTS,\n      vertexCount: positionData.length / 3,\n      attributes: {\n        position: positionBuffer\n      },\n      uniforms: {\n        uTexture: texture,\n        uView: viewMat\n      }\n    });\n\n    return {cloud, mvpMat, viewMat};\n  }\n\n  onRender(animationProps) {\n    const {gl, cloud, mvpMat, viewMat, tick, aspect} = animationProps;\n    if (!this.isDemoSupported) {\n      return;\n    }\n\n    mvpMat.perspective({fov: radians(75), aspect, near: NEAR, far: FAR}).multiplyRight(viewMat);\n\n    // Draw the cubes\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    cloud.draw({\n      uniforms: {\n        uTime: tick / 100,\n        uMVP: mvpMat\n      }\n    });\n  }\n\n  onFinalize({gl, cloud}) {\n    if (cloud) {\n      cloud.delete();\n    }\n  }\n\n  isSupported() {\n    return this.isDemoSupported;\n  }\n\n  getAltText() {\n    return ALT_TEXT;\n  }\n}\n\n/* global window */\nif (typeof window !== 'undefined' && !window.website) {\n  const animationLoop = new AppAnimationLoop();\n  animationLoop.start();\n}\n","import React from 'react';\nimport AnimationLoopExamplePage from '../../src/components/animation-loop-example-page';\nimport AnimationLoop from '../../../examples/core/texture-3d/app';\n\nexport default class Example extends React.Component {\n  render() {\n    return (\n      <AnimationLoopExamplePage AnimationLoop={AnimationLoop} exampleConfig={this.props.pageContext.exampleConfig} />\n    );\n  }\n}\n"],"sourceRoot":""}